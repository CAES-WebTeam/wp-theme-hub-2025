document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".caes-motion-scroll").forEach((e=>{const t=e.querySelector(".motion-scroll-content"),o=e.querySelectorAll(".motion-scroll-slide"),n=parseInt(e.getAttribute("data-slide-count")||o.length,10),i=e.classList.contains("image-mode-contain");if(0===n||!t)return;if(i){function r(){const t=e.querySelector(".motion-scroll-images");if(!t)return;const n=t.offsetHeight;o.forEach((e=>{const t=e.querySelector(".motion-scroll-figure"),o=e.querySelector("img"),i=e.querySelector(".motion-scroll-caption");if(!t||!o)return;const r=i?i.offsetHeight+16:0,s=n-64-r-20;o.style.maxHeight=`${s}px`}))}let a;r(),window.addEventListener("resize",(()=>{clearTimeout(a),a=setTimeout(r,100)})),o.forEach((e=>{const t=e.querySelector("img");t&&(t.complete?r():t.addEventListener("load",r))}))}let s=0;function c(){const e=t.getBoundingClientRect(),i=e.top,r=e.height,c=window.innerHeight,l=Math.max(0,Math.min(1,-i/(r-c))),a=Math.min(n-1,Math.floor(l*n));a!==s&&(o[s]?.classList.remove("is-active"),o[a]?.classList.add("is-active"),s=a)}let l=!1;c(),window.addEventListener("scroll",(function(){l||(window.requestAnimationFrame((()=>{c(),l=!1})),l=!0)}),{passive:!0}),"IntersectionObserver"in window&&new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&c()}))}),{threshold:0,rootMargin:"100px"}).observe(e)}))}));