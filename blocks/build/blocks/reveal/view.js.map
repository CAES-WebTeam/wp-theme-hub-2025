{"version":3,"file":"blocks/reveal/view.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAE,YAAY;EACb,YAAY;;EAEZ;EACA,MAAMA,oBAAoB,GAAGC,MAAM,CAACC,UAAU,CAAE,kCAAmC,CAAC,CAACC,OAAO;;EAE5F;AACD;AACA;AACA;AACA;EACC,SAASC,eAAeA,CAAEC,KAAK,EAAG;IACjC,MAAMC,UAAU,GAAGD,KAAK,CAACE,aAAa,CAAE,oBAAqB,CAAC;IAC9D,MAAMC,OAAO,GAAGH,KAAK,CAACE,aAAa,CAAE,iBAAkB,CAAC;IACxD,MAAME,MAAM,GAAGJ,KAAK,CAACK,gBAAgB,CAAE,eAAgB,CAAC;IAExD,IAAK,CAAEJ,UAAU,IAAI,CAAEE,OAAO,IAAIC,MAAM,CAACE,MAAM,KAAK,CAAC,EAAG;MACvD;IACD;IAEA,MAAMC,UAAU,GAAGH,MAAM,CAACE,MAAM;IAChC,IAAIE,iBAAiB,GAAG,CAAC;IACzB,IAAIC,OAAO,GAAG,KAAK;;IAEnB;AACF;AACA;AACA;AACA;AACA;IACE,SAASC,eAAeA,CAAEC,KAAK,EAAEC,QAAQ,EAAG;MAC3C,MAAMC,cAAc,GAAGF,KAAK,CAACG,OAAO,CAACD,cAAc,IAAI,MAAM;MAC7D,MAAME,eAAe,GAAGC,QAAQ,CAAEL,KAAK,CAACG,OAAO,CAACC,eAAe,EAAE,EAAG,CAAC,IAAI,GAAG;;MAE5E;MACA,MAAME,QAAQ,GAAGtB,oBAAoB,GAAG,CAAC,GAAGoB,eAAe;MAC3DJ,KAAK,CAACO,KAAK,CAACC,kBAAkB,GAAG,GAAIF,QAAQ,IAAK;MAElD,IAAKL,QAAQ,EAAG;QACfD,KAAK,CAACS,SAAS,CAACC,GAAG,CAAE,WAAY,CAAC;QAClCV,KAAK,CAACO,KAAK,CAACI,OAAO,GAAG,GAAG;QACzBX,KAAK,CAACO,KAAK,CAACK,SAAS,GAAG,iBAAiB;MAC1C,CAAC,MAAM;QACNZ,KAAK,CAACS,SAAS,CAACI,MAAM,CAAE,WAAY,CAAC;QACrCb,KAAK,CAACO,KAAK,CAACI,OAAO,GAAG,GAAG;MAC1B;IACD;;IAEA;AACF;AACA;IACE,SAASG,iBAAiBA,CAAA,EAAG;MAC5B,MAAMC,SAAS,GAAG1B,KAAK,CAAC2B,qBAAqB,CAAC,CAAC;MAC/C,MAAMC,cAAc,GAAGhC,MAAM,CAACiC,WAAW;MACzC,MAAMC,QAAQ,GAAGJ,SAAS,CAACK,GAAG;MAC9B,MAAMC,WAAW,GAAGN,SAAS,CAACO,MAAM;MACpC,MAAMC,WAAW,GAAGlC,KAAK,CAACmC,YAAY;;MAEtC;MACA;MACA;MACA;;MAEA,MAAMC,aAAa,GAAGN,QAAQ,IAAI,CAAC,IAAIE,WAAW,GAAGJ,cAAc;MACnE,MAAMS,SAAS,GAAGP,QAAQ,IAAI,CAAC,IAAIE,WAAW,IAAIJ,cAAc;;MAEhE;MACA,IAAKQ,aAAa,EAAG;QACpB;QACApC,KAAK,CAACoB,SAAS,CAACC,GAAG,CAAE,YAAa,CAAC;QACnCrB,KAAK,CAACoB,SAAS,CAACI,MAAM,CAAE,aAAc,CAAC;QACvCvB,UAAU,CAACmB,SAAS,CAACC,GAAG,CAAE,UAAW,CAAC;MACvC,CAAC,MAAM,IAAKgB,SAAS,EAAG;QACvB;QACArC,KAAK,CAACoB,SAAS,CAACC,GAAG,CAAE,YAAa,CAAC;QACnCrB,KAAK,CAACoB,SAAS,CAACC,GAAG,CAAE,aAAc,CAAC;QACpCpB,UAAU,CAACmB,SAAS,CAACI,MAAM,CAAE,UAAW,CAAC;MAC1C,CAAC,MAAM;QACN;QACAxB,KAAK,CAACoB,SAAS,CAACI,MAAM,CAAE,YAAa,CAAC;QACtCxB,KAAK,CAACoB,SAAS,CAACI,MAAM,CAAE,aAAc,CAAC;QACvCvB,UAAU,CAACmB,SAAS,CAACI,MAAM,CAAE,UAAW,CAAC;MAC1C;;MAEA;MACA,IAAKY,aAAa,EAAG;QACpB;QACA;QACA,MAAME,kBAAkB,GAAGJ,WAAW,GAAGN,cAAc;QAEvD,IAAKU,kBAAkB,GAAG,CAAC,EAAG;UAC7B;UACA,MAAMC,gBAAgB,GAAGC,IAAI,CAACC,GAAG,CAAEX,QAAS,CAAC;UAC7C,MAAMY,cAAc,GAAGF,IAAI,CAACG,GAAG,CAAE,CAAC,EAAEH,IAAI,CAACI,GAAG,CAAE,CAAC,EAAEL,gBAAgB,GAAGD,kBAAmB,CAAE,CAAC;;UAE1F;UACA,MAAMO,aAAa,GAAGL,IAAI,CAACI,GAAG,CAC7BrC,UAAU,GAAG,CAAC,EACdiC,IAAI,CAACM,KAAK,CAAEJ,cAAc,GAAGnC,UAAW,CACzC,CAAC;;UAED;UACA,IAAKsC,aAAa,KAAKrC,iBAAiB,EAAG;YAC1CJ,MAAM,CAAC2C,OAAO,CAAE,CAAEpC,KAAK,EAAEqC,KAAK,KAAM;cACnCtC,eAAe,CAAEC,KAAK,EAAEqC,KAAK,KAAKH,aAAc,CAAC;YAClD,CAAE,CAAC;YACHrC,iBAAiB,GAAGqC,aAAa;UAClC;QACD;MACD;MAEApC,OAAO,GAAG,KAAK;IAChB;;IAEA;AACF;AACA;IACE,SAASwC,QAAQA,CAAA,EAAG;MACnB,IAAK,CAAExC,OAAO,EAAG;QAChBb,MAAM,CAACsD,qBAAqB,CAAEzB,iBAAkB,CAAC;QACjDhB,OAAO,GAAG,IAAI;MACf;IACD;;IAEA;IACAb,MAAM,CAACuD,gBAAgB,CAAE,QAAQ,EAAEF,QAAQ,EAAE;MAAEG,OAAO,EAAE;IAAK,CAAE,CAAC;;IAEhE;IACAhD,MAAM,CAAC2C,OAAO,CAAE,CAAEpC,KAAK,EAAEqC,KAAK,KAAM;MACnC,IAAKA,KAAK,KAAK,CAAC,EAAG;QAClBrC,KAAK,CAACS,SAAS,CAACC,GAAG,CAAE,WAAY,CAAC;QAClCV,KAAK,CAACO,KAAK,CAACI,OAAO,GAAG,GAAG;MAC1B,CAAC,MAAM;QACNX,KAAK,CAACS,SAAS,CAACI,MAAM,CAAE,WAAY,CAAC;QACrCb,KAAK,CAACO,KAAK,CAACI,OAAO,GAAG,GAAG;MAC1B;IACD,CAAE,CAAC;;IAEH;IACAG,iBAAiB,CAAC,CAAC;;IAEnB;IACAzB,KAAK,CAACqD,cAAc,GAAG,YAAY;MAClCzD,MAAM,CAAC0D,mBAAmB,CAAE,QAAQ,EAAEL,QAAS,CAAC;IACjD,CAAC;EACF;;EAEA;AACD;AACA;EACC,SAASM,aAAaA,CAAA,EAAG;IACxB,MAAMC,MAAM,GAAGC,QAAQ,CAACpD,gBAAgB,CAAE,cAAe,CAAC;IAC1DmD,MAAM,CAACT,OAAO,CAAEhD,eAAgB,CAAC;EAClC;;EAEA;EACA,IAAK0D,QAAQ,CAACC,UAAU,KAAK,SAAS,EAAG;IACxCD,QAAQ,CAACN,gBAAgB,CAAE,kBAAkB,EAAEI,aAAc,CAAC;EAC/D,CAAC,MAAM;IACNA,aAAa,CAAC,CAAC;EAChB;AACD,CAAC,EAAG,CAAC,C","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript\n *\n * Handles scroll-triggered frame transitions with three-phase behavior:\n * 1. Enter: Background scrolls into view naturally\n * 2. Fixed: Background freezes while content scrolls, frame transitions occur\n * 3. Exit: Background scrolls away naturally\n */\n\n( function () {\n\t'use strict';\n\n\t// Check reduced motion preference\n\tconst prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n\t/**\n\t * Initialize a single Reveal block\n\t *\n\t * @param {HTMLElement} block The reveal block element\n\t */\n\tfunction initRevealBlock( block ) {\n\t\tconst background = block.querySelector( '.reveal-background' );\n\t\tconst content = block.querySelector( '.reveal-content' );\n\t\tconst frames = block.querySelectorAll( '.reveal-frame' );\n\n\t\tif ( ! background || ! content || frames.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst frameCount = frames.length;\n\t\tlet currentFrameIndex = 0;\n\t\tlet ticking = false;\n\n\t\t/**\n\t\t * Apply transition to a frame\n\t\t *\n\t\t * @param {HTMLElement} frame     The frame element\n\t\t * @param {boolean}     isActive  Whether frame should be active\n\t\t */\n\t\tfunction applyTransition( frame, isActive ) {\n\t\t\tconst transitionType = frame.dataset.transitionType || 'fade';\n\t\t\tconst transitionSpeed = parseInt( frame.dataset.transitionSpeed, 10 ) || 500;\n\n\t\t\t// Set transition duration (or 0 for reduced motion)\n\t\t\tconst duration = prefersReducedMotion ? 0 : transitionSpeed;\n\t\t\tframe.style.transitionDuration = `${ duration }ms`;\n\n\t\t\tif ( isActive ) {\n\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\tframe.style.opacity = '1';\n\t\t\t\tframe.style.transform = 'translate(0, 0)';\n\t\t\t} else {\n\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\tframe.style.opacity = '0';\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Update scroll state and active frame\n\t\t */\n\t\tfunction updateScrollState() {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tconst blockTop = blockRect.top;\n\t\t\tconst blockBottom = blockRect.bottom;\n\t\t\tconst blockHeight = block.offsetHeight;\n\n\t\t\t// Determine which phase we're in\n\t\t\t// Phase 1 (Enter): Block top is below viewport top (blockTop > 0)\n\t\t\t// Phase 2 (Fixed): Block top is at or above viewport top, AND block bottom is below viewport bottom\n\t\t\t// Phase 3 (Exit): Block bottom is at or above viewport bottom\n\n\t\t\tconst shouldBeFixed = blockTop <= 0 && blockBottom > viewportHeight;\n\t\t\tconst isPastEnd = blockTop <= 0 && blockBottom <= viewportHeight;\n\n\t\t\t// Update classes based on phase\n\t\t\tif ( shouldBeFixed ) {\n\t\t\t\t// Phase 2: Fixed\n\t\t\t\tblock.classList.add( 'is-in-view' );\n\t\t\t\tblock.classList.remove( 'is-past-end' );\n\t\t\t\tbackground.classList.add( 'is-fixed' );\n\t\t\t} else if ( isPastEnd ) {\n\t\t\t\t// Phase 3: Exit - pin background to bottom\n\t\t\t\tblock.classList.add( 'is-in-view' );\n\t\t\t\tblock.classList.add( 'is-past-end' );\n\t\t\t\tbackground.classList.remove( 'is-fixed' );\n\t\t\t} else {\n\t\t\t\t// Phase 1: Enter - or completely out of view\n\t\t\t\tblock.classList.remove( 'is-in-view' );\n\t\t\t\tblock.classList.remove( 'is-past-end' );\n\t\t\t\tbackground.classList.remove( 'is-fixed' );\n\t\t\t}\n\n\t\t\t// Calculate frame transitions only during fixed phase\n\t\t\tif ( shouldBeFixed ) {\n\t\t\t\t// Calculate scroll progress through the fixed phase\n\t\t\t\t// Total scrollable distance = block height - viewport height\n\t\t\t\tconst scrollableDistance = blockHeight - viewportHeight;\n\t\t\t\t\n\t\t\t\tif ( scrollableDistance > 0 ) {\n\t\t\t\t\t// How far we've scrolled into the block (blockTop is negative when scrolled past)\n\t\t\t\t\tconst scrolledDistance = Math.abs( blockTop );\n\t\t\t\t\tconst scrollProgress = Math.max( 0, Math.min( 1, scrolledDistance / scrollableDistance ) );\n\n\t\t\t\t\t// Determine which frame should be active\n\t\t\t\t\tconst newFrameIndex = Math.min(\n\t\t\t\t\t\tframeCount - 1,\n\t\t\t\t\t\tMath.floor( scrollProgress * frameCount )\n\t\t\t\t\t);\n\n\t\t\t\t\t// Update frames if index changed\n\t\t\t\t\tif ( newFrameIndex !== currentFrameIndex ) {\n\t\t\t\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\t\t\t\tapplyTransition( frame, index === newFrameIndex );\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tcurrentFrameIndex = newFrameIndex;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tticking = false;\n\t\t}\n\n\t\t/**\n\t\t * Handle scroll events with requestAnimationFrame throttling\n\t\t */\n\t\tfunction onScroll() {\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateScrollState );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t// Add scroll listener\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\n\t\t// Initial state - ensure first frame is visible\n\t\tframes.forEach( ( frame, index ) => {\n\t\t\tif ( index === 0 ) {\n\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\tframe.style.opacity = '1';\n\t\t\t} else {\n\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\tframe.style.opacity = '0';\n\t\t\t}\n\t\t} );\n\n\t\t// Initial scroll state check\n\t\tupdateScrollState();\n\n\t\t// Store cleanup function on element for potential future use\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t};\n\t}\n\n\t/**\n\t * Initialize all Reveal blocks on the page\n\t */\n\tfunction initAllBlocks() {\n\t\tconst blocks = document.querySelectorAll( '.caes-reveal' );\n\t\tblocks.forEach( initRevealBlock );\n\t}\n\n\t// Initialize on DOM ready\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","background","querySelector","content","frames","querySelectorAll","length","frameCount","currentFrameIndex","ticking","applyTransition","frame","isActive","transitionType","dataset","transitionSpeed","parseInt","duration","style","transitionDuration","classList","add","opacity","transform","remove","updateScrollState","blockRect","getBoundingClientRect","viewportHeight","innerHeight","blockTop","top","blockBottom","bottom","blockHeight","offsetHeight","shouldBeFixed","isPastEnd","scrollableDistance","scrolledDistance","Math","abs","scrollProgress","max","min","newFrameIndex","floor","forEach","index","onScroll","requestAnimationFrame","addEventListener","passive","_revealCleanup","removeEventListener","initAllBlocks","blocks","document","readyState"],"sourceRoot":""}