{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript\n * \n * Correctly mimics Shorthand's behavior:\n * - Content scrolls NATURALLY through the viewport (not faded in place)\n * - JavaScript only controls opacity based on content's ACTUAL position\n * - Content fades in as it enters viewport from below\n * - Content fades out as it exits viewport at top\n * - Background transitions happen at the right time based on content position\n */\n\n( function () {\n\t'use strict';\n\n\tconst prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n\tfunction initRevealBlock( block ) {\n\t\tconst frames = block.querySelectorAll( '.reveal-frame' );\n\t\tconst frameContents = block.querySelectorAll( '.reveal-frame-content' );\n\n\t\tif ( frames.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst frameCount = frames.length;\n\t\tlet ticking = false;\n\n\t\t// Parse transition data from frames\n\t\tconst transitions = [];\n\t\tframes.forEach( ( frame, index ) => {\n\t\t\ttransitions.push( {\n\t\t\t\ttype: frame.dataset.transitionType || 'fade',\n\t\t\t\tspeed: frame.dataset.transitionSpeed || 'normal'\n\t\t\t} );\n\t\t} );\n\n\t\t// Speed affects how much of the transition zone is used\n\t\tconst speedMultipliers = { slow: 0.5, normal: 0.35, fast: 0.2 };\n\n\t\t/**\n\t\t * Get clip-path style for wipe transitions\n\t\t */\n\t\tfunction getTransitionStyles( type, progress ) {\n\t\t\tif ( prefersReducedMotion ) {\n\t\t\t\ttype = 'fade';\n\t\t\t}\n\n\t\t\tconst clipAmount = ( ( 1 - progress ) * 100 ).toFixed( 2 );\n\n\t\t\tswitch ( type ) {\n\t\t\t\tcase 'fade':\n\t\t\t\t\treturn { opacity: progress, clipPath: 'none' };\n\t\t\t\tcase 'up':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(${ clipAmount }% 0 0 0)` };\n\t\t\t\tcase 'down':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(0 0 ${ clipAmount }% 0)` };\n\t\t\t\tcase 'left':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(0 0 0 ${ clipAmount }%)` };\n\t\t\t\tcase 'right':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(0 ${ clipAmount }% 0 0)` };\n\t\t\t\tdefault:\n\t\t\t\t\treturn { opacity: progress >= 0.5 ? 1 : 0, clipPath: 'none' };\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Calculate opacity based on element's actual position in viewport\n\t\t * This lets content scroll naturally while fading in/out at edges\n\t\t */\n\t\tfunction getContentOpacityFromPosition( element ) {\n\t\t\tconst rect = element.getBoundingClientRect();\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\t\n\t\t\t// Define fade zones (percentage of viewport height)\n\t\t\tconst fadeInZone = viewportHeight * 0.25;  // Bottom 25% of viewport\n\t\t\tconst fadeOutZone = viewportHeight * 0.15; // Top 15% of viewport\n\t\t\t\n\t\t\t// Element's vertical center\n\t\t\tconst elementCenter = rect.top + ( rect.height / 2 );\n\t\t\t\n\t\t\t// Fully off-screen below\n\t\t\tif ( rect.top >= viewportHeight ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t\n\t\t\t// Fully off-screen above\n\t\t\tif ( rect.bottom <= 0 ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t\n\t\t\t// Fading in from bottom\n\t\t\tif ( rect.top > viewportHeight - fadeInZone ) {\n\t\t\t\tconst distanceIntoFadeZone = viewportHeight - rect.top;\n\t\t\t\treturn Math.min( 1, distanceIntoFadeZone / fadeInZone );\n\t\t\t}\n\t\t\t\n\t\t\t// Fading out at top\n\t\t\tif ( rect.top < fadeOutZone && rect.bottom > 0 ) {\n\t\t\t\t// Use element top position for fade out\n\t\t\t\tconst distanceFromTop = rect.top;\n\t\t\t\tif ( distanceFromTop < 0 ) {\n\t\t\t\t\t// Element is partially off-screen at top\n\t\t\t\t\tconst visibleHeight = rect.bottom;\n\t\t\t\t\treturn Math.min( 1, visibleHeight / ( rect.height * 0.5 ) );\n\t\t\t\t}\n\t\t\t\treturn Math.min( 1, distanceFromTop / fadeOutZone );\n\t\t\t}\n\t\t\t\n\t\t\t// Fully visible\n\t\t\treturn 1;\n\t\t}\n\n\t\t/**\n\t\t * Determine which frame should be active based on content positions\n\t\t */\n\t\tfunction getActiveFrameIndex() {\n\t\t\tconst viewportCenter = window.innerHeight / 2;\n\t\t\tlet closestIndex = 0;\n\t\t\tlet closestDistance = Infinity;\n\n\t\t\tframeContents.forEach( ( content, index ) => {\n\t\t\t\tconst rect = content.getBoundingClientRect();\n\t\t\t\tconst contentCenter = rect.top + ( rect.height / 2 );\n\t\t\t\tconst distance = Math.abs( contentCenter - viewportCenter );\n\t\t\t\t\n\t\t\t\t// Only consider if content is at least partially in viewport\n\t\t\t\tif ( rect.bottom > 0 && rect.top < window.innerHeight ) {\n\t\t\t\t\tif ( distance < closestDistance ) {\n\t\t\t\t\t\tclosestDistance = distance;\n\t\t\t\t\t\tclosestIndex = index;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Also check if we're at the very start or end\n\t\t\tconst firstContent = frameContents[ 0 ];\n\t\t\tconst lastContent = frameContents[ frameContents.length - 1 ];\n\t\t\t\n\t\t\tif ( firstContent ) {\n\t\t\t\tconst firstRect = firstContent.getBoundingClientRect();\n\t\t\t\tif ( firstRect.top > viewportCenter ) {\n\t\t\t\t\tclosestIndex = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif ( lastContent ) {\n\t\t\t\tconst lastRect = lastContent.getBoundingClientRect();\n\t\t\t\tif ( lastRect.bottom < viewportCenter ) {\n\t\t\t\t\tclosestIndex = frameContents.length - 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn closestIndex;\n\t\t}\n\n\t\t/**\n\t\t * Calculate background transition progress based on content positions\n\t\t */\n\t\tfunction getBackgroundTransitionProgress( fromIndex, toIndex ) {\n\t\t\tif ( fromIndex >= frameContents.length || toIndex >= frameContents.length ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst fromContent = frameContents[ fromIndex ];\n\t\t\tconst toContent = frameContents[ toIndex ];\n\t\t\t\n\t\t\tif ( ! fromContent || ! toContent ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst fromRect = fromContent.getBoundingClientRect();\n\t\t\tconst toRect = toContent.getBoundingClientRect();\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\t\n\t\t\t// Transition starts when \"from\" content is in upper portion of screen\n\t\t\t// and \"to\" content is entering from below\n\t\t\tconst transitionZone = viewportHeight * 0.4; // 40% of viewport\n\t\t\tconst transitionStart = viewportHeight * 0.3; // Starts at 30% from top\n\t\t\t\n\t\t\t// If the \"from\" content top is above the transition start point\n\t\t\tif ( fromRect.top < transitionStart && toRect.top < viewportHeight ) {\n\t\t\t\t// Calculate how far through the transition we are\n\t\t\t\tconst progress = ( transitionStart - fromRect.top ) / transitionZone;\n\t\t\t\treturn Math.max( 0, Math.min( 1, progress ) );\n\t\t\t}\n\t\t\t\n\t\t\treturn 0;\n\t\t}\n\n\t\t/**\n\t\t * Main scroll handler\n\t\t */\n\t\tfunction updateOnScroll() {\n\t\t\tconst activeIndex = getActiveFrameIndex();\n\n\t\t\t// Update content opacity based on actual position\n\t\t\tframeContents.forEach( ( content, index ) => {\n\t\t\t\tconst opacity = getContentOpacityFromPosition( content );\n\t\t\t\tcontent.style.opacity = opacity;\n\t\t\t\tcontent.style.pointerEvents = opacity > 0.3 ? 'auto' : 'none';\n\t\t\t} );\n\n\t\t\t// Update background frames\n\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\tframe.style.transitionDuration = '0ms';\n\n\t\t\t\tif ( index === activeIndex ) {\n\t\t\t\t\t// This is the active frame\n\t\t\t\t\tframe.style.opacity = '1';\n\t\t\t\t\tframe.style.clipPath = 'none';\n\t\t\t\t\tframe.style.zIndex = '1';\n\t\t\t\t\tframe.style.display = 'block';\n\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t} else if ( index === activeIndex + 1 ) {\n\t\t\t\t\t// This is the NEXT frame - check if it should be transitioning in\n\t\t\t\t\tconst transitionProgress = getBackgroundTransitionProgress( activeIndex, index );\n\t\t\t\t\t\n\t\t\t\t\tif ( transitionProgress > 0 ) {\n\t\t\t\t\t\tconst styles = getTransitionStyles( transitions[ index ].type, transitionProgress );\n\t\t\t\t\t\tframe.style.opacity = styles.opacity;\n\t\t\t\t\t\tframe.style.clipPath = styles.clipPath;\n\t\t\t\t\t\tframe.style.zIndex = '2'; // Above current active\n\t\t\t\t\t\tframe.style.display = 'block';\n\t\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tframe.style.opacity = '0';\n\t\t\t\t\t\tframe.style.display = 'none';\n\t\t\t\t\t\tframe.style.zIndex = '0';\n\t\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Not active, not transitioning\n\t\t\t\t\tframe.style.opacity = '0';\n\t\t\t\t\tframe.style.display = 'none';\n\t\t\t\t\tframe.style.zIndex = '0';\n\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tticking = false;\n\t\t}\n\n\t\tfunction onScroll() {\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateOnScroll );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t// Initialize\n\t\tframeContents.forEach( ( content ) => {\n\t\t\tcontent.style.opacity = '0';\n\t\t\t// Remove any transition on opacity so it responds instantly to scroll\n\t\t\tcontent.style.transition = 'none';\n\t\t} );\n\n\t\t// First frame visible\n\t\tif ( frames[ 0 ] ) {\n\t\t\tframes[ 0 ].style.opacity = '1';\n\t\t\tframes[ 0 ].style.clipPath = 'none';\n\t\t\tframes[ 0 ].style.display = 'block';\n\t\t\tframes[ 0 ].classList.add( 'is-active' );\n\t\t}\n\n\t\t// Set up event listeners\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\t\twindow.addEventListener( 'resize', updateOnScroll );\n\t\t\n\t\t// Initial update\n\t\tupdateOnScroll();\n\n\t\t// Cleanup function\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t\twindow.removeEventListener( 'resize', updateOnScroll );\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll( '.caes-reveal' ).forEach( initRevealBlock );\n\t}\n\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","frames","querySelectorAll","frameContents","length","frameCount","ticking","transitions","forEach","frame","index","push","type","dataset","transitionType","speed","transitionSpeed","speedMultipliers","slow","normal","fast","getTransitionStyles","progress","clipAmount","toFixed","opacity","clipPath","getContentOpacityFromPosition","element","rect","getBoundingClientRect","viewportHeight","innerHeight","fadeInZone","fadeOutZone","elementCenter","top","height","bottom","distanceIntoFadeZone","Math","min","distanceFromTop","visibleHeight","getActiveFrameIndex","viewportCenter","closestIndex","closestDistance","Infinity","content","contentCenter","distance","abs","firstContent","lastContent","firstRect","lastRect","getBackgroundTransitionProgress","fromIndex","toIndex","fromContent","toContent","fromRect","toRect","transitionZone","transitionStart","max","updateOnScroll","activeIndex","style","pointerEvents","transitionDuration","zIndex","display","classList","add","transitionProgress","styles","remove","onScroll","requestAnimationFrame","transition","addEventListener","passive","_revealCleanup","removeEventListener","initAllBlocks","document","readyState"],"sourceRoot":""}