{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["( function () {\n    'use strict';\n\n    const prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n    function initRevealBlock( block ) {\n        const stage = block.querySelector('.reveal-stage');\n        const triggers = block.querySelectorAll('.reveal-trigger');\n        const frames = block.querySelectorAll('.reveal-frame');\n        const contents = block.querySelectorAll('.reveal-frame-content');\n\n        if ( !triggers.length || !frames.length ) return;\n\n        let ticking = false;\n\n        function updateOnScroll() {\n            const viewportHeight = window.innerHeight;\n            \n            // Iterate over every trigger to determine state\n            triggers.forEach((trigger, index) => {\n                const rect = trigger.getBoundingClientRect();\n                const frame = frames[index];\n                const content = contents[index];\n                \n                // Calculate LOCAL progress for this specific slide\n                // 0 = Trigger top is at bottom of viewport (entering)\n                // 1 = Trigger bottom is at bottom of viewport (leaving)\n                // We actually want: 0 = Trigger top at TOP of viewport.\n                \n                // Logic: How far has the trigger top moved up past the viewport top?\n                // When rect.top == 0, progress = 0.\n                // When rect.top == -(rect.height - viewportHeight), progress = 1.\n                // This assumes the trigger is taller than the viewport (which it is, min 100vh).\n                \n                let progress = -rect.top / (rect.height - viewportHeight);\n                \n                // Clamp progress\n                const clampedProgress = Math.max(0, Math.min(1, progress));\n\n                // --- 1. Background Transitions ---\n                \n                // Frame 0 is the base, it handles differently (always visible unless covered)\n                if (index === 0) {\n                    frame.style.opacity = '1';\n                } else {\n                    // Transition Logic for frames > 0\n                    // Transition happens in the first 30% of the trigger\n                    const transitionEnd = 0.3; \n                    const transitionProgress = Math.min(1, clampedProgress / transitionEnd);\n\n                    const type = frame.dataset.transitionType || 'fade';\n                    \n                    if (prefersReducedMotion) {\n                        frame.style.opacity = transitionProgress >= 1 ? '1' : '0';\n                    } else if (type === 'wipe') {\n                        // Wipe Up Effect\n                        frame.style.opacity = '1';\n                        // 100% -> 0% (inset from top)\n                        const clipVal = (1 - transitionProgress) * 100;\n                        frame.style.clipPath = `inset(${clipVal}% 0 0 0)`;\n                    } else {\n                        // Fade Effect\n                        frame.style.opacity = transitionProgress;\n                        frame.style.clipPath = 'none';\n                    }\n                }\n\n                // --- 2. Content Transitions ---\n                \n                if (content) {\n                    // Content Logic:\n                    // Fade In: 10% - 30%\n                    // Stay: 30% - 70%\n                    // Fade Out: 70% - 90%\n                    \n                    let opacity = 0;\n                    \n                    if (clampedProgress > 0.1 && clampedProgress < 0.9) {\n                        if (clampedProgress < 0.3) {\n                            // Fading in\n                            opacity = (clampedProgress - 0.1) / 0.2;\n                        } else if (clampedProgress > 0.7) {\n                            // Fading out\n                            opacity = 1 - ((clampedProgress - 0.7) / 0.2);\n                        } else {\n                            // Fully visible\n                            opacity = 1;\n                        }\n                    }\n                    \n                    content.style.opacity = opacity;\n                    // Prevent hidden content from blocking clicks\n                    content.style.pointerEvents = opacity > 0.5 ? 'auto' : 'none';\n                    \n                    // Optional: subtle vertical shift for content\n                    if (!prefersReducedMotion) {\n                        const translateY = (1 - opacity) * 20; \n                        content.children[0].style.transform = `translateY(${translateY}px)`;\n                        content.children[0].style.transition = 'transform 0.1s linear';\n                    }\n                }\n            });\n            \n            ticking = false;\n        }\n\n        function onScroll() {\n            if ( ! ticking ) {\n                window.requestAnimationFrame( updateOnScroll );\n                ticking = true;\n            }\n        }\n\n        window.addEventListener( 'scroll', onScroll, { passive: true } );\n        window.addEventListener( 'resize', updateOnScroll );\n        \n        // Initial call\n        updateOnScroll();\n    }\n\n    // Initialize on load\n    document.addEventListener( 'DOMContentLoaded', function() {\n        const blocks = document.querySelectorAll( '.caes-reveal' );\n        blocks.forEach( initRevealBlock );\n    });\n\n}() );"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","stage","querySelector","triggers","querySelectorAll","frames","contents","length","ticking","updateOnScroll","viewportHeight","innerHeight","forEach","trigger","index","rect","getBoundingClientRect","frame","content","progress","top","height","clampedProgress","Math","max","min","style","opacity","transitionEnd","transitionProgress","type","dataset","transitionType","clipVal","clipPath","pointerEvents","translateY","children","transform","transition","onScroll","requestAnimationFrame","addEventListener","passive","document","blocks"],"sourceRoot":""}