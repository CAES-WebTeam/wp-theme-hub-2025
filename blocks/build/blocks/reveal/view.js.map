{"version":3,"file":"blocks/reveal/view.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAE,YAAY;EACb,YAAY;;EAEZ,SAASA,eAAeA,CAAEC,KAAK,EAAG;IACjC,MAAMC,QAAQ,GAAGD,KAAK,CAACE,gBAAgB,CAAE,uBAAwB,CAAC;IAClE,MAAMC,QAAQ,GAAGH,KAAK,CAACE,gBAAgB,CAAE,uBAAwB,CAAC;IAElE,IAAKD,QAAQ,CAACG,MAAM,KAAK,CAAC,EAAG;MAC5B;IACD;IAEA,IAAIC,OAAO,GAAG,KAAK;;IAEnB;AACF;AACA;AACA;IACE,SAASC,iBAAiBA,CAAA,EAAG;MAC5B,MAAMC,cAAc,GAAGC,MAAM,CAACC,WAAW;MAEzCR,QAAQ,CAACS,OAAO,CAAE,CAAEC,OAAO,EAAEC,KAAK,KAAM;QACvC,MAAMC,OAAO,GAAGF,OAAO,CAACG,aAAa,CAAE,uBAAwB,CAAC;QAChE,IAAK,CAAED,OAAO,EAAG;;QAEjB;QACA,MAAME,eAAe,GAAGF,OAAO,CAACG,QAAQ;QACxC,IAAIC,aAAa,GAAG,CAAC;QAErB,KAAM,IAAIC,KAAK,IAAIH,eAAe,EAAG;UACpCE,aAAa,IAAIC,KAAK,CAACC,YAAY;UACnC;UACA,MAAMC,KAAK,GAAGZ,MAAM,CAACa,gBAAgB,CAAEH,KAAM,CAAC;UAC9CD,aAAa,IAAIK,QAAQ,CAAEF,KAAK,CAACG,SAAU,CAAC,GAAGD,QAAQ,CAAEF,KAAK,CAACI,YAAa,CAAC;QAC9E;;QAEA;QACAP,aAAa,GAAGQ,IAAI,CAACC,GAAG,CAAET,aAAa,EAAE,GAAI,CAAC;;QAE9C;QACA;QACA;QACA;QACA;;QAEA,MAAMU,aAAa,GAAGf,KAAK,KAAKX,QAAQ,CAACG,MAAM,GAAG,CAAC;QAEnD,IAAIwB,aAAa;QACjB,IAAKD,aAAa,EAAG;UACpB;UACAC,aAAa,GAAGrB,cAAc,GAAGU,aAAa;QAC/C,CAAC,MAAM;UACN;UACAW,aAAa,GAAGrB,cAAc,GAAGU,aAAa,GAAGV,cAAc;QAChE;QAEAI,OAAO,CAACS,KAAK,CAACS,MAAM,GAAGD,aAAa,GAAG,IAAI;MAC5C,CAAE,CAAC;IACJ;;IAEA;AACF;AACA;IACE,SAASE,iBAAiBA,CAAEC,OAAO,EAAG;MACrC,MAAMxB,cAAc,GAAGC,MAAM,CAACC,WAAW;;MAEzC;MACA,MAAMM,eAAe,GAAGgB,OAAO,CAACf,QAAQ;MACxC,IAAKD,eAAe,CAACX,MAAM,KAAK,CAAC,EAAG;QACnC,OAAO,CAAC;MACT;MAEA,IAAI4B,UAAU,GAAGC,QAAQ;MACzB,IAAIC,aAAa,GAAG,CAACD,QAAQ;MAE7B,KAAM,IAAIf,KAAK,IAAIH,eAAe,EAAG;QACpC,MAAMoB,SAAS,GAAGjB,KAAK,CAACkB,qBAAqB,CAAC,CAAC;QAC/C,IAAKD,SAAS,CAACN,MAAM,KAAK,CAAC,EAAG,SAAS,CAAC;QACxC,IAAKM,SAAS,CAACE,GAAG,GAAGL,UAAU,EAAGA,UAAU,GAAGG,SAAS,CAACE,GAAG;QAC5D,IAAKF,SAAS,CAACG,MAAM,GAAGJ,aAAa,EAAGA,aAAa,GAAGC,SAAS,CAACG,MAAM;MACzE;;MAEA;MACA,IAAKN,UAAU,KAAKC,QAAQ,EAAG;QAC9B,OAAO,CAAC;MACT;MAEA,MAAMM,QAAQ,GAAGhC,cAAc,GAAG,IAAI,CAAC,CAAC;;MAExC;MACA,IAAKyB,UAAU,IAAIzB,cAAc,EAAG;QACnC,OAAO,CAAC;MACT;;MAEA;MACA,IAAK2B,aAAa,IAAI,CAAC,EAAG;QACzB,OAAO,CAAC;MACT;;MAEA;MACA,IAAKF,UAAU,GAAGzB,cAAc,GAAGgC,QAAQ,EAAG;QAC7C,OAAO,CAAEhC,cAAc,GAAGyB,UAAU,IAAKO,QAAQ;MAClD;;MAEA;MACA,IAAKL,aAAa,GAAGK,QAAQ,EAAG;QAC/B,OAAOL,aAAa,GAAGK,QAAQ;MAChC;;MAEA;MACA,OAAO,CAAC;IACT;IAEA,SAASC,cAAcA,CAAA,EAAG;MACzBrC,QAAQ,CAACO,OAAO,CAAIG,OAAO,IAAM;QAChC,MAAM4B,OAAO,GAAGX,iBAAiB,CAAEjB,OAAQ,CAAC;QAC5CA,OAAO,CAACO,KAAK,CAACqB,OAAO,GAAGhB,IAAI,CAACC,GAAG,CAAE,CAAC,EAAED,IAAI,CAACiB,GAAG,CAAE,CAAC,EAAED,OAAQ,CAAE,CAAC;MAC9D,CAAE,CAAC;MAEHpC,OAAO,GAAG,KAAK;IAChB;IAEA,SAASsC,QAAQA,CAAA,EAAG;MACnB,IAAK,CAAEtC,OAAO,EAAG;QAChBG,MAAM,CAACoC,qBAAqB,CAAEJ,cAAe,CAAC;QAC9CnC,OAAO,GAAG,IAAI;MACf;IACD;IAEA,SAASwC,QAAQA,CAAA,EAAG;MACnBvC,iBAAiB,CAAC,CAAC;MACnBkC,cAAc,CAAC,CAAC;IACjB;;IAEA;IACArC,QAAQ,CAACO,OAAO,CAAIG,OAAO,IAAM;MAChCA,OAAO,CAACO,KAAK,CAAC0B,UAAU,GAAG,MAAM;IAClC,CAAE,CAAC;;IAEH;IACAxC,iBAAiB,CAAC,CAAC;;IAEnB;IACAE,MAAM,CAACuC,gBAAgB,CAAE,QAAQ,EAAEJ,QAAQ,EAAE;MAAEK,OAAO,EAAE;IAAK,CAAE,CAAC;IAChExC,MAAM,CAACuC,gBAAgB,CAAE,QAAQ,EAAEF,QAAQ,EAAE;MAAEG,OAAO,EAAE;IAAK,CAAE,CAAC;;IAEhE;IACAhD,KAAK,CAACE,gBAAgB,CAAE,KAAM,CAAC,CAACQ,OAAO,CAAIuC,GAAG,IAAM;MACnD,IAAK,CAAEA,GAAG,CAACC,QAAQ,EAAG;QACrBD,GAAG,CAACF,gBAAgB,CAAE,MAAM,EAAEzC,iBAAkB,CAAC;MAClD;IACD,CAAE,CAAC;IAEHkC,cAAc,CAAC,CAAC;IAEhBxC,KAAK,CAACmD,cAAc,GAAG,YAAY;MAClC3C,MAAM,CAAC4C,mBAAmB,CAAE,QAAQ,EAAET,QAAS,CAAC;MAChDnC,MAAM,CAAC4C,mBAAmB,CAAE,QAAQ,EAAEP,QAAS,CAAC;IACjD,CAAC;EACF;EAEA,SAASQ,aAAaA,CAAA,EAAG;IACxBC,QAAQ,CAACpD,gBAAgB,CAAE,cAAe,CAAC,CAACQ,OAAO,CAAEX,eAAgB,CAAC;EACvE;EAEA,IAAKuD,QAAQ,CAACC,UAAU,KAAK,SAAS,EAAG;IACxCD,QAAQ,CAACP,gBAAgB,CAAE,kBAAkB,EAAEM,aAAc,CAAC;EAC/D,CAAC,MAAM;IACNA,aAAa,CAAC,CAAC;EAChB;AACD,CAAC,EAAG,CAAC,C","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript - Sticky Approach v6\n * \n * Handles:\n * 1. Setting section heights based on content height\n * 2. Content opacity fade as it enters/exits\n */\n\n( function () {\n\t'use strict';\n\n\tfunction initRevealBlock( block ) {\n\t\tconst sections = block.querySelectorAll( '.reveal-frame-section' );\n\t\tconst contents = block.querySelectorAll( '.reveal-frame-content' );\n\n\t\tif ( sections.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet ticking = false;\n\n\t\t/**\n\t\t * Calculate and set section heights based on content\n\t\t * Section needs: 100vh (for sticky background) + content height + 100vh (for content to scroll through)\n\t\t */\n\t\tfunction setSectionHeights() {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\tsections.forEach( ( section, index ) => {\n\t\t\t\tconst content = section.querySelector( '.reveal-frame-content' );\n\t\t\t\tif ( ! content ) return;\n\n\t\t\t\t// Get actual content height (excluding padding)\n\t\t\t\tconst contentChildren = content.children;\n\t\t\t\tlet contentHeight = 0;\n\t\t\t\t\n\t\t\t\tfor ( let child of contentChildren ) {\n\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\t// Add margin\n\t\t\t\t\tconst style = window.getComputedStyle( child );\n\t\t\t\t\tcontentHeight += parseInt( style.marginTop ) + parseInt( style.marginBottom );\n\t\t\t\t}\n\n\t\t\t\t// Minimum content height\n\t\t\t\tcontentHeight = Math.max( contentHeight, 100 );\n\n\t\t\t\t// Section height calculation:\n\t\t\t\t// - 100vh for the sticky background\n\t\t\t\t// - contentHeight for the actual content\n\t\t\t\t// - 100vh for the content to scroll completely through the viewport\n\t\t\t\t// But we subtract 100vh because content has margin-top: -100vh\n\t\t\t\t\n\t\t\t\tconst isLastSection = index === sections.length - 1;\n\t\t\t\t\n\t\t\t\tlet sectionHeight;\n\t\t\t\tif ( isLastSection ) {\n\t\t\t\t\t// Last section: just needs enough for content to scroll away naturally\n\t\t\t\t\tsectionHeight = viewportHeight + contentHeight;\n\t\t\t\t} else {\n\t\t\t\t\t// Other sections: need full scroll-through distance\n\t\t\t\t\tsectionHeight = viewportHeight + contentHeight + viewportHeight;\n\t\t\t\t}\n\n\t\t\t\tsection.style.height = sectionHeight + 'px';\n\t\t\t} );\n\t\t}\n\n\t\t/**\n\t\t * Calculate content opacity based on actual content position\n\t\t */\n\t\tfunction getContentOpacity( element ) {\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\t\n\t\t\t// Find actual content children bounds\n\t\t\tconst contentChildren = element.children;\n\t\t\tif ( contentChildren.length === 0 ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\t\n\t\t\tlet contentTop = Infinity;\n\t\t\tlet contentBottom = -Infinity;\n\t\t\t\n\t\t\tfor ( let child of contentChildren ) {\n\t\t\t\tconst childRect = child.getBoundingClientRect();\n\t\t\t\tif ( childRect.height === 0 ) continue; // Skip empty elements\n\t\t\t\tif ( childRect.top < contentTop ) contentTop = childRect.top;\n\t\t\t\tif ( childRect.bottom > contentBottom ) contentBottom = childRect.bottom;\n\t\t\t}\n\t\t\t\n\t\t\t// Fallback if no visible children\n\t\t\tif ( contentTop === Infinity ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\t\n\t\t\tconst fadeZone = viewportHeight * 0.15; // 15% of viewport for fade\n\t\t\t\n\t\t\t// Content fully below viewport - hidden\n\t\t\tif ( contentTop >= viewportHeight ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t\n\t\t\t// Content fully above viewport - hidden\n\t\t\tif ( contentBottom <= 0 ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t\n\t\t\t// Fading in from bottom\n\t\t\tif ( contentTop > viewportHeight - fadeZone ) {\n\t\t\t\treturn ( viewportHeight - contentTop ) / fadeZone;\n\t\t\t}\n\t\t\t\n\t\t\t// Fading out at top\n\t\t\tif ( contentBottom < fadeZone ) {\n\t\t\t\treturn contentBottom / fadeZone;\n\t\t\t}\n\t\t\t\n\t\t\t// Fully visible\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction updateOnScroll() {\n\t\t\tcontents.forEach( ( content ) => {\n\t\t\t\tconst opacity = getContentOpacity( content );\n\t\t\t\tcontent.style.opacity = Math.max( 0, Math.min( 1, opacity ) );\n\t\t\t} );\n\n\t\t\tticking = false;\n\t\t}\n\n\t\tfunction onScroll() {\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateOnScroll );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\tfunction onResize() {\n\t\t\tsetSectionHeights();\n\t\t\tupdateOnScroll();\n\t\t}\n\n\t\t// Initialize\n\t\tcontents.forEach( ( content ) => {\n\t\t\tcontent.style.transition = 'none';\n\t\t} );\n\n\t\t// Set initial heights\n\t\tsetSectionHeights();\n\n\t\t// Set up listeners\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\t\twindow.addEventListener( 'resize', onResize, { passive: true } );\n\t\t\n\t\t// Recalculate after images load\n\t\tblock.querySelectorAll( 'img' ).forEach( ( img ) => {\n\t\t\tif ( ! img.complete ) {\n\t\t\t\timg.addEventListener( 'load', setSectionHeights );\n\t\t\t}\n\t\t} );\n\n\t\tupdateOnScroll();\n\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t\twindow.removeEventListener( 'resize', onResize );\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll( '.caes-reveal' ).forEach( initRevealBlock );\n\t}\n\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["initRevealBlock","block","sections","querySelectorAll","contents","length","ticking","setSectionHeights","viewportHeight","window","innerHeight","forEach","section","index","content","querySelector","contentChildren","children","contentHeight","child","offsetHeight","style","getComputedStyle","parseInt","marginTop","marginBottom","Math","max","isLastSection","sectionHeight","height","getContentOpacity","element","contentTop","Infinity","contentBottom","childRect","getBoundingClientRect","top","bottom","fadeZone","updateOnScroll","opacity","min","onScroll","requestAnimationFrame","onResize","transition","addEventListener","passive","img","complete","_revealCleanup","removeEventListener","initAllBlocks","document","readyState"],"sourceRoot":""}