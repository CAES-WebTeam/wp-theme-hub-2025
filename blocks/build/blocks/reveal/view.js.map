{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript\n *\n * Handles scroll-triggered frame transitions with Shorthand-style phased scrolling:\n * 1. Background frame transitions in\n * 2. Content scrolls into view and stays\n * 3. Content scrolls out\n * 4. Next background frame transitions in\n * 5. Repeat...\n */\n\n( function () {\n\t'use strict';\n\n\tconst prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n\tfunction initRevealBlock( block ) {\n\t\tconst frames = block.querySelectorAll( '.reveal-frame' );\n\t\tconst frameContents = block.querySelectorAll( '.reveal-frame-content' );\n\n\t\tif ( frames.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst frameCount = frames.length;\n\t\tlet ticking = false;\n\t\tlet currentActiveIndex = 0;\n\n\t\t// Each frame has 3 phases:\n\t\t// 1. Background transition in (from previous frame)\n\t\t// 2. Content visible (scrolls in, holds, scrolls out)\n\t\t// 3. Background transition out (to next frame)\n\t\t//\n\t\t// Phase weights (as proportion of each frame's scroll segment):\n\t\tconst PHASE_BG_IN = 0.2;      // 20% for background transition in\n\t\tconst PHASE_CONTENT = 0.6;    // 60% for content (in + hold + out)\n\t\tconst PHASE_BG_OUT = 0.2;     // 20% for background transition out\n\t\t\n\t\t// Within the content phase, subdivide:\n\t\tconst CONTENT_IN = 0.25;      // Content fades/slides in\n\t\tconst CONTENT_HOLD = 0.5;     // Content fully visible\n\t\tconst CONTENT_OUT = 0.25;     // Content fades/slides out\n\n\t\t// Build frame segments based on transition speed\n\t\tconst speedMultipliers = { slow: 1.5, normal: 1, fast: 0.5 };\n\t\tconst frameWeights = [];\n\t\tlet totalWeight = 0;\n\n\t\tframes.forEach( ( frame, index ) => {\n\t\t\tconst speed = frame.dataset.transitionSpeed || 'normal';\n\t\t\tconst weight = speedMultipliers[ speed ] || 1;\n\t\t\tframeWeights.push( weight );\n\t\t\ttotalWeight += weight;\n\t\t} );\n\n\t\t// Calculate cumulative positions (0 to 1) for each frame's start\n\t\tconst framePositions = [];\n\t\tlet cumulative = 0;\n\t\tfor ( let i = 0; i < frameCount; i++ ) {\n\t\t\tframePositions.push( cumulative );\n\t\t\tcumulative += frameWeights[ i ] / totalWeight;\n\t\t}\n\t\tframePositions.push( 1 ); // End position\n\n\t\t/**\n\t\t * Get transition styles for background frame wipe/fade.\n\t\t */\n\t\tfunction getBackgroundTransitionStyles( type, progress ) {\n\t\t\tif ( prefersReducedMotion ) {\n\t\t\t\ttype = 'fade';\n\t\t\t}\n\n\t\t\tlet styles = {\n\t\t\t\topacity: '1',\n\t\t\t\tclipPath: 'inset(0 0 0 0)',\n\t\t\t};\n\n\t\t\tconst clipAmount = ( ( 1 - progress ) * 100 ).toFixed( 2 );\n\n\t\t\tswitch ( type ) {\n\t\t\t\tcase 'fade':\n\t\t\t\t\tstyles.opacity = progress.toFixed( 3 );\n\t\t\t\t\tstyles.clipPath = 'none';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'up':\n\t\t\t\t\tstyles.clipPath = `inset(${ clipAmount }% 0 0 0)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'down':\n\t\t\t\t\tstyles.clipPath = `inset(0 0 ${ clipAmount }% 0)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'left':\n\t\t\t\t\tstyles.clipPath = `inset(0 0 0 ${ clipAmount }%)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'right':\n\t\t\t\t\tstyles.clipPath = `inset(0 ${ clipAmount }% 0 0)`;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tstyles.opacity = progress >= 0.5 ? '1' : '0';\n\t\t\t\t\tstyles.clipPath = 'none';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn styles;\n\t\t}\n\n\t\t/**\n\t\t * Get content visibility styles based on content phase progress.\n\t\t * Progress 0-1 covers: fade in -> hold -> fade out\n\t\t */\n\t\tfunction getContentStyles( progress ) {\n\t\t\tlet opacity = 1;\n\t\t\tlet transform = 'translateY(0)';\n\n\t\t\tif ( progress < CONTENT_IN ) {\n\t\t\t\t// Fading/sliding in\n\t\t\t\tconst inProgress = progress / CONTENT_IN;\n\t\t\t\topacity = inProgress;\n\t\t\t\ttransform = prefersReducedMotion ? 'translateY(0)' : `translateY(${ ( 1 - inProgress ) * 30 }px)`;\n\t\t\t} else if ( progress < CONTENT_IN + CONTENT_HOLD ) {\n\t\t\t\t// Fully visible\n\t\t\t\topacity = 1;\n\t\t\t\ttransform = 'translateY(0)';\n\t\t\t} else {\n\t\t\t\t// Fading/sliding out\n\t\t\t\tconst outProgress = ( progress - CONTENT_IN - CONTENT_HOLD ) / CONTENT_OUT;\n\t\t\t\topacity = 1 - outProgress;\n\t\t\t\ttransform = prefersReducedMotion ? 'translateY(0)' : `translateY(${ -outProgress * 30 }px)`;\n\t\t\t}\n\n\t\t\treturn { opacity: opacity.toFixed( 3 ), transform };\n\t\t}\n\n\t\t/**\n\t\t * Update all frames and content based on scroll position.\n\t\t */\n\t\tfunction updateActiveFrame() {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tconst blockTop = blockRect.top;\n\t\t\tconst blockHeight = block.offsetHeight;\n\n\t\t\t// Calculate overall scroll progress through the block (0 to 1)\n\t\t\tconst scrollableDistance = blockHeight - viewportHeight;\n\t\t\tlet scrollProgress = 0;\n\n\t\t\tif ( scrollableDistance > 0 ) {\n\t\t\t\tconst scrolledDistance = Math.max( 0, -blockTop );\n\t\t\t\tscrollProgress = Math.min( 1, scrolledDistance / scrollableDistance );\n\t\t\t}\n\n\t\t\t// Determine which frame segment we're in\n\t\t\tlet currentFrameIndex = 0;\n\t\t\tfor ( let i = 0; i < frameCount; i++ ) {\n\t\t\t\tif ( scrollProgress >= framePositions[ i ] ) {\n\t\t\t\t\tcurrentFrameIndex = i;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Calculate progress within the current frame's segment (0 to 1)\n\t\t\tconst frameStart = framePositions[ currentFrameIndex ];\n\t\t\tconst frameEnd = framePositions[ currentFrameIndex + 1 ] || 1;\n\t\t\tconst frameLength = frameEnd - frameStart;\n\t\t\tlet frameProgress = 0;\n\t\t\tif ( frameLength > 0 ) {\n\t\t\t\tframeProgress = Math.min( 1, ( scrollProgress - frameStart ) / frameLength );\n\t\t\t}\n\n\t\t\t// Determine which phase we're in within this frame\n\t\t\tlet phase = 'content'; // 'bg-in', 'content', 'bg-out'\n\t\t\tlet phaseProgress = 0;\n\n\t\t\tif ( currentFrameIndex === 0 && frameProgress < PHASE_BG_IN ) {\n\t\t\t\t// First frame: no bg-in transition, jump straight to content\n\t\t\t\tphase = 'content';\n\t\t\t\tphaseProgress = frameProgress / ( PHASE_BG_IN + PHASE_CONTENT );\n\t\t\t} else if ( frameProgress < PHASE_BG_IN ) {\n\t\t\t\t// Background transitioning in\n\t\t\t\tphase = 'bg-in';\n\t\t\t\tphaseProgress = frameProgress / PHASE_BG_IN;\n\t\t\t} else if ( frameProgress < PHASE_BG_IN + PHASE_CONTENT ) {\n\t\t\t\t// Content phase\n\t\t\t\tphase = 'content';\n\t\t\t\tphaseProgress = ( frameProgress - PHASE_BG_IN ) / PHASE_CONTENT;\n\t\t\t} else {\n\t\t\t\t// Background transitioning out (next frame transitioning in)\n\t\t\t\tphase = 'bg-out';\n\t\t\t\tphaseProgress = ( frameProgress - PHASE_BG_IN - PHASE_CONTENT ) / PHASE_BG_OUT;\n\t\t\t}\n\n\t\t\t// Update background frames\n\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\tframe.style.transitionDuration = '0ms';\n\n\t\t\t\tif ( index < currentFrameIndex ) {\n\t\t\t\t\t// Past frames - hidden\n\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t\tframe.style.opacity = '0';\n\t\t\t\t\tframe.style.clipPath = 'inset(0 0 0 0)';\n\t\t\t\t\tframe.style.zIndex = '0';\n\t\t\t\t} else if ( index === currentFrameIndex ) {\n\t\t\t\t\t// Current frame - fully visible (base layer)\n\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t\tframe.style.opacity = '1';\n\t\t\t\t\tframe.style.clipPath = 'none';\n\t\t\t\t\tframe.style.zIndex = '1';\n\t\t\t\t} else if ( index === currentFrameIndex + 1 ) {\n\t\t\t\t\t// Next frame - transitioning in during bg-out phase\n\t\t\t\t\tif ( phase === 'bg-out' ) {\n\t\t\t\t\t\tconst type = frame.dataset.transitionType || 'fade';\n\t\t\t\t\t\tconst styles = getBackgroundTransitionStyles( type, phaseProgress );\n\t\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t\t\tframe.style.opacity = styles.opacity;\n\t\t\t\t\t\tframe.style.clipPath = styles.clipPath;\n\t\t\t\t\t\tframe.style.zIndex = '2';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Not yet visible\n\t\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t\t\tframe.style.opacity = '0';\n\t\t\t\t\t\tframe.style.clipPath = 'inset(100% 0 0 0)';\n\t\t\t\t\t\tframe.style.zIndex = '0';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Future frames - hidden\n\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t\tframe.style.opacity = '0';\n\t\t\t\t\tframe.style.clipPath = 'inset(100% 0 0 0)';\n\t\t\t\t\tframe.style.zIndex = '0';\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Update content visibility\n\t\t\tframeContents.forEach( ( content ) => {\n\t\t\t\tconst contentIndex = parseInt( content.dataset.frameIndex, 10 );\n\n\t\t\t\tif ( contentIndex === currentFrameIndex ) {\n\t\t\t\t\t// Current frame's content\n\t\t\t\t\tif ( phase === 'bg-in' && currentFrameIndex > 0 ) {\n\t\t\t\t\t\t// Background still transitioning in, content not visible yet\n\t\t\t\t\t\tcontent.style.opacity = '0';\n\t\t\t\t\t\tcontent.style.transform = 'translateY(30px)';\n\t\t\t\t\t\tcontent.style.pointerEvents = 'none';\n\t\t\t\t\t} else if ( phase === 'content' || phase === 'bg-in' ) {\n\t\t\t\t\t\t// Content phase - animate in/hold/out\n\t\t\t\t\t\tconst styles = getContentStyles( phaseProgress );\n\t\t\t\t\t\tcontent.style.opacity = styles.opacity;\n\t\t\t\t\t\tcontent.style.transform = styles.transform;\n\t\t\t\t\t\tcontent.style.pointerEvents = parseFloat( styles.opacity ) > 0.5 ? 'auto' : 'none';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// bg-out phase - content fading out as we prepare for next frame\n\t\t\t\t\t\tconst fadeOut = 1 - phaseProgress;\n\t\t\t\t\t\tcontent.style.opacity = fadeOut.toFixed( 3 );\n\t\t\t\t\t\tcontent.style.transform = prefersReducedMotion ? 'translateY(0)' : `translateY(${ -phaseProgress * 30 }px)`;\n\t\t\t\t\t\tcontent.style.pointerEvents = 'none';\n\t\t\t\t\t}\n\t\t\t\t\tcontent.setAttribute( 'aria-hidden', 'false' );\n\t\t\t\t} else {\n\t\t\t\t\t// Not the current frame's content - hide it\n\t\t\t\t\tcontent.style.opacity = '0';\n\t\t\t\t\tcontent.style.transform = 'translateY(30px)';\n\t\t\t\t\tcontent.style.pointerEvents = 'none';\n\t\t\t\t\tcontent.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tcurrentActiveIndex = currentFrameIndex;\n\t\t\tticking = false;\n\t\t}\n\n\t\tfunction onScroll() {\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateActiveFrame );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t// Initialize styles\n\t\tframeContents.forEach( ( content, index ) => {\n\t\t\tcontent.style.transition = 'none'; // We control animations manually\n\t\t\tif ( index === 0 ) {\n\t\t\t\tcontent.style.opacity = '1';\n\t\t\t\tcontent.style.transform = 'translateY(0)';\n\t\t\t\tcontent.style.pointerEvents = 'auto';\n\t\t\t\tcontent.setAttribute( 'aria-hidden', 'false' );\n\t\t\t} else {\n\t\t\t\tcontent.style.opacity = '0';\n\t\t\t\tcontent.style.transform = 'translateY(30px)';\n\t\t\t\tcontent.style.pointerEvents = 'none';\n\t\t\t\tcontent.setAttribute( 'aria-hidden', 'true' );\n\t\t\t}\n\t\t} );\n\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\t\twindow.addEventListener( 'resize', updateActiveFrame );\n\n\t\t// Run immediately to set initial state\n\t\tupdateActiveFrame();\n\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t\twindow.removeEventListener( 'resize', updateActiveFrame );\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tconst blocks = document.querySelectorAll( '.caes-reveal' );\n\t\tblocks.forEach( initRevealBlock );\n\t}\n\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","frames","querySelectorAll","frameContents","length","frameCount","ticking","currentActiveIndex","PHASE_BG_IN","PHASE_CONTENT","PHASE_BG_OUT","CONTENT_IN","CONTENT_HOLD","CONTENT_OUT","speedMultipliers","slow","normal","fast","frameWeights","totalWeight","forEach","frame","index","speed","dataset","transitionSpeed","weight","push","framePositions","cumulative","i","getBackgroundTransitionStyles","type","progress","styles","opacity","clipPath","clipAmount","toFixed","getContentStyles","transform","inProgress","outProgress","updateActiveFrame","blockRect","getBoundingClientRect","viewportHeight","innerHeight","blockTop","top","blockHeight","offsetHeight","scrollableDistance","scrollProgress","scrolledDistance","Math","max","min","currentFrameIndex","frameStart","frameEnd","frameLength","frameProgress","phase","phaseProgress","style","transitionDuration","classList","remove","zIndex","add","transitionType","content","contentIndex","parseInt","frameIndex","pointerEvents","parseFloat","fadeOut","setAttribute","onScroll","requestAnimationFrame","transition","addEventListener","passive","_revealCleanup","removeEventListener","initAllBlocks","blocks","document","readyState"],"sourceRoot":""}