{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript - Sticky Approach v6\n * \n * Handles:\n * 1. Setting section heights based on content height\n * 2. Content opacity fade as it enters/exits\n */\n\n(function () {\n\t'use strict';\n\n\tfunction initRevealBlock(block) {\n\t\tconst sections = block.querySelectorAll('.reveal-frame-section');\n\t\tconst contents = block.querySelectorAll('.reveal-frame-content');\n\n\t\tif (sections.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet ticking = false;\n\n\t\t/**\n\t\t * Calculate and set section heights based on content\n\t\t * Section needs: 100vh (for sticky background) + content height + 100vh (for content to scroll through)\n\t\t */\n\t\tfunction setSectionHeights() {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\tsections.forEach((section, index) => {\n\t\t\t\tconst content = section.querySelector('.reveal-frame-content');\n\t\t\t\tif (!content) return;\n\n\t\t\t\t// Get actual content height (excluding padding)\n\t\t\t\tconst contentChildren = content.children;\n\t\t\t\tlet contentHeight = 0;\n\n\t\t\t\tfor (let child of contentChildren) {\n\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\t// Add margin\n\t\t\t\t\tconst style = window.getComputedStyle(child);\n\t\t\t\t\tcontentHeight += parseInt(style.marginTop) + parseInt(style.marginBottom);\n\t\t\t\t}\n\n\t\t\t\t// Minimum content height\n\t\t\t\tcontentHeight = Math.max(contentHeight, 100);\n\n\t\t\t\t// Section height calculation:\n\t\t\t\t// - 100vh for the sticky background\n\t\t\t\t// - contentHeight for the actual content\n\t\t\t\t// - 100vh for the content to scroll completely through the viewport\n\t\t\t\t// But we subtract 100vh because content has margin-top: -100vh\n\n\t\t\t\t// Uniform height calculation for ALL sections (including the last one)\n\t\t\t\t// This ensures the background stays sticky while content scrolls through\n\t\t\t\tconst sectionHeight = viewportHeight + contentHeight + viewportHeight;\n\n\t\t\t\tsection.style.height = sectionHeight + 'px';\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Calculate content opacity based on actual content position\n\t\t */\n\t\tfunction getContentOpacity(element) {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\t// Find actual content children bounds\n\t\t\tconst contentChildren = element.children;\n\t\t\tif (contentChildren.length === 0) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tlet contentTop = Infinity;\n\t\t\tlet contentBottom = -Infinity;\n\n\t\t\tfor (let child of contentChildren) {\n\t\t\t\tconst childRect = child.getBoundingClientRect();\n\t\t\t\tif (childRect.height === 0) continue; // Skip empty elements\n\t\t\t\tif (childRect.top < contentTop) contentTop = childRect.top;\n\t\t\t\tif (childRect.bottom > contentBottom) contentBottom = childRect.bottom;\n\t\t\t}\n\n\t\t\t// Fallback if no visible children\n\t\t\tif (contentTop === Infinity) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tconst fadeZone = viewportHeight * 0.15; // 15% of viewport for fade\n\n\t\t\t// Content fully below viewport - hidden\n\t\t\tif (contentTop >= viewportHeight) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\t// Content fully above viewport - hidden\n\t\t\tif (contentBottom <= 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\t// Fading in from bottom\n\t\t\tif (contentTop > viewportHeight - fadeZone) {\n\t\t\t\treturn (viewportHeight - contentTop) / fadeZone;\n\t\t\t}\n\n\t\t\t// Fading out at top\n\t\t\tif (contentBottom < fadeZone) {\n\t\t\t\treturn contentBottom / fadeZone;\n\t\t\t}\n\n\t\t\t// Fully visible\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction updateOnScroll() {\n            const viewportHeight = window.innerHeight;\n            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n            // Track which frames should be visible and at what progress\n            let activeIndex = 0;\n            let transitionProgress = 0;\n            let inTransition = false;\n            let nextIndex = -1;\n\n            // First, update all content opacity\n            contents.forEach((content) => {\n                const opacity = getContentOpacity(content);\n                content.style.opacity = Math.max(0, Math.min(1, opacity));\n            });\n\n            // Determine current state by finding which section we're in\n            sections.forEach((section, index) => {\n                const rect = section.getBoundingClientRect();\n                const sectionTop = scrollTop + rect.top;\n                const sectionBottom = sectionTop + section.offsetHeight;\n                const content = section.querySelector('.reveal-frame-content');\n                \n                // Check if content is visible\n                const contentOpacity = getContentOpacity(content);\n                const contentVisible = contentOpacity > 0.1; // Small threshold\n\n                // Determine if we're in this section\n                if (scrollTop >= sectionTop && scrollTop < sectionBottom) {\n                    if (contentVisible) {\n                        // We're viewing this section's content\n                        activeIndex = index;\n                        inTransition = false;\n                    } else if (index < sections.length - 1) {\n                        // Content has scrolled away, we're in transition zone\n                        inTransition = true;\n                        activeIndex = index;\n                        nextIndex = index + 1;\n                        \n                        // Get speed attribute from the NEXT frame (the one transitioning in)\n                        const nextBg = sections[nextIndex].querySelector('.reveal-frame-background');\n                        const speed = nextBg.getAttribute('data-speed') || 'normal';\n                        \n                        // Base transition distance (how much scroll needed for transition)\n                        // Adjust based on speed:\n                        // - slow: 2.0 viewport heights (more scrolling needed)\n                        // - normal: 1.5 viewport heights\n                        // - fast: 1.0 viewport height (less scrolling needed)\n                        let transitionDistance;\n                        if (speed === 'slow') {\n                            transitionDistance = 2.0 * viewportHeight;\n                        } else if (speed === 'fast') {\n                            transitionDistance = 1.0 * viewportHeight;\n                        } else {\n                            transitionDistance = 1.5 * viewportHeight;\n                        }\n                        \n                        // Calculate how far into the transition zone we are\n                        // Find where content ended\n                        const contentChildren = content.children;\n                        let contentBottom = sectionTop;\n                        \n                        for (let child of contentChildren) {\n                            const childRect = child.getBoundingClientRect();\n                            const childBottom = scrollTop + childRect.bottom;\n                            if (childBottom > contentBottom) {\n                                contentBottom = childBottom;\n                            }\n                        }\n                        \n                        // Transition starts after content scrolls past top of viewport\n                        const transitionStart = contentBottom - viewportHeight;\n                        const transitionEnd = transitionStart + transitionDistance;\n                        \n                        // Calculate progress through transition zone (0 to 1)\n                        transitionProgress = (scrollTop - transitionStart) / transitionDistance;\n                        transitionProgress = Math.max(0, Math.min(1, transitionProgress));\n                    }\n                }\n            });\n\n            // Apply visibility and transitions to all backgrounds\n            sections.forEach((section, index) => {\n                const bg = section.querySelector('.reveal-frame-background');\n                const transitionType = bg.getAttribute('data-transition') || 'none';\n\n                if (index === activeIndex && !inTransition) {\n                    // This is the active frame - fully visible\n                    bg.style.opacity = 1;\n                    bg.style.transform = 'none';\n                    bg.style.zIndex = 10;\n                } else if (index === activeIndex && inTransition) {\n                    // Current frame during transition - stay visible as backdrop\n                    bg.style.opacity = 1;\n                    bg.style.transform = 'none';\n                    bg.style.zIndex = 9;\n                } else if (index === nextIndex && inTransition) {\n                    // Next frame transitioning in - this is the key animation\n                    bg.style.zIndex = 10;\n                    \n                    if (transitionType === 'fade') {\n                        bg.style.opacity = transitionProgress;\n                        bg.style.transform = 'none';\n                    } else if (transitionType === 'left') {\n                        // Slide in from right\n                        const x = (1 - transitionProgress) * 100;\n                        bg.style.transform = `translate3d(${x}%, 0, 0)`;\n                        bg.style.opacity = 1;\n                    } else if (transitionType === 'right') {\n                        // Slide in from left\n                        const x = -(1 - transitionProgress) * 100;\n                        bg.style.transform = `translate3d(${x}%, 0, 0)`;\n                        bg.style.opacity = 1;\n                    } else if (transitionType === 'up') {\n                        // Slide up from bottom\n                        const y = (1 - transitionProgress) * 100;\n                        bg.style.transform = `translate3d(0, ${y}%, 0)`;\n                        bg.style.opacity = 1;\n                    } else {\n                        // 'none' - just fade in\n                        bg.style.opacity = transitionProgress;\n                        bg.style.transform = 'none';\n                    }\n                } else {\n                    // All other frames - hidden\n                    bg.style.opacity = 0;\n                    bg.style.transform = 'none';\n                    bg.style.zIndex = 5;\n                }\n            });\n\n            ticking = false;\n        }\n\n\t\tfunction onScroll() {\n\t\t\tif (!ticking) {\n\t\t\t\twindow.requestAnimationFrame(updateOnScroll);\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\tfunction onResize() {\n\t\t\tsetSectionHeights();\n\t\t\tupdateOnScroll();\n\t\t}\n\n\t\t// Initialize\n\t\tcontents.forEach((content) => {\n\t\t\tcontent.style.transition = 'none';\n\t\t});\n\n\t\t// Set initial state - first frame visible\n\t\tif (sections.length > 0) {\n\t\t\tconst firstBg = sections[0].querySelector('.reveal-frame-background');\n\t\t\tif (firstBg) {\n\t\t\t\tfirstBg.style.opacity = 1;\n\t\t\t\tfirstBg.style.zIndex = 10;\n\t\t\t}\n\t\t}\n\n\t\t// Set initial heights\n\t\tsetSectionHeights();\n\n\t\t// Set up listeners\n\t\twindow.addEventListener('scroll', onScroll, { passive: true });\n\t\twindow.addEventListener('resize', onResize, { passive: true });\n\n\t\t// Recalculate after images load\n\t\tblock.querySelectorAll('img').forEach((img) => {\n\t\t\tif (!img.complete) {\n\t\t\t\timg.addEventListener('load', setSectionHeights);\n\t\t\t}\n\t\t});\n\n\t\tupdateOnScroll();\n\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener('scroll', onScroll);\n\t\t\twindow.removeEventListener('resize', onResize);\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll('.caes-reveal').forEach(initRevealBlock);\n\t}\n\n\tif (document.readyState === 'loading') {\n\t\tdocument.addEventListener('DOMContentLoaded', initAllBlocks);\n\t} else {\n\t\tinitAllBlocks();\n\t}\n})();"],"names":["initRevealBlock","block","sections","querySelectorAll","contents","length","ticking","setSectionHeights","viewportHeight","window","innerHeight","forEach","section","index","content","querySelector","contentChildren","children","contentHeight","child","offsetHeight","style","getComputedStyle","parseInt","marginTop","marginBottom","Math","max","sectionHeight","height","getContentOpacity","element","contentTop","Infinity","contentBottom","childRect","getBoundingClientRect","top","bottom","fadeZone","updateOnScroll","scrollTop","pageYOffset","document","documentElement","activeIndex","transitionProgress","inTransition","nextIndex","opacity","min","rect","sectionTop","sectionBottom","contentOpacity","contentVisible","nextBg","speed","getAttribute","transitionDistance","childBottom","transitionStart","transitionEnd","bg","transitionType","transform","zIndex","x","y","onScroll","requestAnimationFrame","onResize","transition","firstBg","addEventListener","passive","img","complete","_revealCleanup","removeEventListener","initAllBlocks","readyState"],"sourceRoot":""}