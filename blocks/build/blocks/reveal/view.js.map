{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript - Fixed Scroll Approach\n * \n * Behavior:\n * 1. Block starts as normal flow\n * 2. When block reaches top of viewport, it becomes fixed\n * 3. While fixed, scroll controls: content position, frame transitions\n * 4. When complete, block unfixes and normal scroll resumes\n */\n\n(function () {\n\t'use strict';\n\n\tfunction initRevealBlock(block) {\n\t\tconst sections = block.querySelectorAll('.reveal-frame-section');\n\t\tconst backgrounds = block.querySelectorAll('.reveal-frame-background');\n\t\tconst contents = block.querySelectorAll('.reveal-frame-content');\n\n\t\tif (sections.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet ticking = false;\n\t\tlet blockFixed = false;\n\t\tlet virtualHeight = 0;\n\n\t\t/**\n\t\t * Calculate total virtual height needed for all frames\n\t\t */\n\t\tfunction calculateVirtualHeight() {\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tlet totalHeight = 0;\n\n\t\t\tsections.forEach((section, index) => {\n\t\t\t\tconst content = section.querySelector('.reveal-frame-content');\n\t\t\t\tconst bg = section.querySelector('.reveal-frame-background');\n\t\t\t\t\n\t\t\t\t// Get actual content height\n\t\t\t\tconst contentChildren = content.children;\n\t\t\t\tlet contentHeight = 0;\n\t\t\t\tfor (let child of contentChildren) {\n\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\tconst style = window.getComputedStyle(child);\n\t\t\t\t\tcontentHeight += parseInt(style.marginTop) + parseInt(style.marginBottom);\n\t\t\t\t}\n\t\t\t\tcontentHeight = Math.max(contentHeight, 100);\n\n\t\t\t\t// For each frame we need:\n\t\t\t\t// 1. One viewport height + content height to scroll content through\n\t\t\t\ttotalHeight += viewportHeight + contentHeight;\n\n\t\t\t\t// 2. Transition distance to next frame (except for last frame)\n\t\t\t\tif (index < sections.length - 1) {\n\t\t\t\t\tconst speed = bg.getAttribute('data-speed') || 'normal';\n\t\t\t\t\tlet transitionDistance;\n\t\t\t\t\tif (speed === 'slow') {\n\t\t\t\t\t\ttransitionDistance = 2.0 * viewportHeight;\n\t\t\t\t\t} else if (speed === 'fast') {\n\t\t\t\t\t\ttransitionDistance = 1.0 * viewportHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttransitionDistance = 1.5 * viewportHeight;\n\t\t\t\t\t}\n\t\t\t\t\ttotalHeight += transitionDistance;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvirtualHeight = totalHeight;\n\t\t\t\n\t\t\t// Set block's height to create scroll space\n\t\t\tblock.style.minHeight = virtualHeight + 'px';\n\t\t}\n\n\t\t/**\n\t\t * Update based on scroll position\n\t\t */\n\t\tfunction updateOnScroll() {\n\t\t\tconst scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst blockTop = scrollTop + blockRect.top;\n\n\t\t\t// Determine if block should be fixed\n\t\t\tconst shouldFix = blockRect.top <= 0 && blockRect.bottom > viewportHeight;\n\n\t\t\tif (shouldFix && !blockFixed) {\n\t\t\t\t// Fix the block\n\t\t\t\tblockFixed = true;\n\t\t\t\tblock.classList.add('is-fixed');\n\t\t\t} else if (!shouldFix && blockFixed) {\n\t\t\t\t// Unfix the block\n\t\t\t\tblockFixed = false;\n\t\t\t\tblock.classList.remove('is-fixed');\n\t\t\t}\n\n\t\t\tif (!blockFixed) {\n\t\t\t\t// Not fixed - reset all frames to default state\n\t\t\t\tbackgrounds.forEach((bg, index) => {\n\t\t\t\t\tif (index === 0) {\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\t\tbg.style.zIndex = 10;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbg.style.opacity = 0;\n\t\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\t\tbg.style.zIndex = 5;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tcontents.forEach((content) => {\n\t\t\t\t\tcontent.style.transform = 'translateY(100vh)';\n\t\t\t\t\tcontent.style.opacity = 0;\n\t\t\t\t});\n\t\t\t\tticking = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Calculate virtual scroll (how far through the fixed experience)\n\t\t\tconst virtualScroll = scrollTop - blockTop;\n\t\t\t\n\t\t\t// Track state\n\t\t\tlet currentFrameIndex = 0;\n\t\t\tlet accumulatedHeight = 0;\n\t\t\tlet inTransition = false;\n\t\t\tlet transitionProgress = 0;\n\t\t\tlet nextFrameIndex = -1;\n\n\t\t\t// Determine which frame we're in and calculate states\n\t\t\tsections.forEach((section, index) => {\n\t\t\t\tconst content = section.querySelector('.reveal-frame-content');\n\t\t\t\tconst bg = section.querySelector('.reveal-frame-background');\n\t\t\t\t\n\t\t\t\t// Calculate content height\n\t\t\t\tconst contentChildren = content.children;\n\t\t\t\tlet contentHeight = 0;\n\t\t\t\tfor (let child of contentChildren) {\n\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\tconst style = window.getComputedStyle(child);\n\t\t\t\t\tcontentHeight += parseInt(style.marginTop) + parseInt(style.marginBottom);\n\t\t\t\t}\n\t\t\t\tcontentHeight = Math.max(contentHeight, 100);\n\n\t\t\t\tconst frameContentHeight = viewportHeight + contentHeight;\n\t\t\t\t\n\t\t\t\t// Get transition distance for this frame\n\t\t\t\tconst speed = bg.getAttribute('data-speed') || 'normal';\n\t\t\t\tlet transitionDistance = 0;\n\t\t\t\tif (index < sections.length - 1) {\n\t\t\t\t\tif (speed === 'slow') {\n\t\t\t\t\t\ttransitionDistance = 2.0 * viewportHeight;\n\t\t\t\t\t} else if (speed === 'fast') {\n\t\t\t\t\t\ttransitionDistance = 1.0 * viewportHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttransitionDistance = 1.5 * viewportHeight;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst frameStartHeight = accumulatedHeight;\n\t\t\t\tconst frameEndHeight = frameStartHeight + frameContentHeight;\n\t\t\t\tconst transitionEndHeight = frameEndHeight + transitionDistance;\n\n\t\t\t\t// Check where we are in this frame\n\t\t\t\tif (virtualScroll >= frameStartHeight && virtualScroll < frameEndHeight) {\n\t\t\t\t\t// We're in this frame's content\n\t\t\t\t\tcurrentFrameIndex = index;\n\t\t\t\t\t\n\t\t\t\t\t// Calculate content position (scroll from bottom to top)\n\t\t\t\t\tconst frameProgress = (virtualScroll - frameStartHeight) / frameContentHeight;\n\t\t\t\t\tconst contentOffset = frameProgress * (viewportHeight + contentHeight) - viewportHeight;\n\t\t\t\t\tcontent.style.transform = `translateY(${-contentOffset}px)`;\n\t\t\t\t\t\n\t\t\t\t\t// Fade content in/out at edges\n\t\t\t\t\tif (frameProgress < 0.15) {\n\t\t\t\t\t\tcontent.style.opacity = frameProgress / 0.15;\n\t\t\t\t\t} else if (frameProgress > 0.85) {\n\t\t\t\t\t\tcontent.style.opacity = (1 - frameProgress) / 0.15;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontent.style.opacity = 1;\n\t\t\t\t\t}\n\t\t\t\t} else if (virtualScroll >= frameEndHeight && virtualScroll < transitionEndHeight && index < sections.length - 1) {\n\t\t\t\t\t// We're in transition to next frame\n\t\t\t\t\tcurrentFrameIndex = index;\n\t\t\t\t\tnextFrameIndex = index + 1;\n\t\t\t\t\tinTransition = true;\n\t\t\t\t\t\n\t\t\t\t\tconst transitionVirtualScroll = virtualScroll - frameEndHeight;\n\t\t\t\t\ttransitionProgress = transitionVirtualScroll / transitionDistance;\n\t\t\t\t\ttransitionProgress = Math.max(0, Math.min(1, transitionProgress));\n\t\t\t\t\t\n\t\t\t\t\t// Hide current frame's content\n\t\t\t\t\tcontent.style.opacity = 0;\n\t\t\t\t\tcontent.style.transform = 'translateY(-100vh)';\n\t\t\t\t} else {\n\t\t\t\t\t// Content is not visible\n\t\t\t\t\tcontent.style.opacity = 0;\n\t\t\t\t\tif (virtualScroll < frameStartHeight) {\n\t\t\t\t\t\tcontent.style.transform = 'translateY(100vh)';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontent.style.transform = 'translateY(-100vh)';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\taccumulatedHeight = transitionEndHeight;\n\t\t\t});\n\n\t\t\t// Apply frame visibility and transitions\n\t\t\tbackgrounds.forEach((bg, index) => {\n\t\t\t\tconst transitionType = bg.getAttribute('data-transition') || 'none';\n\n\t\t\t\tif (index === currentFrameIndex && !inTransition) {\n\t\t\t\t\t// Active frame\n\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\tbg.style.zIndex = 10;\n\t\t\t\t} else if (index === currentFrameIndex && inTransition) {\n\t\t\t\t\t// Current frame during transition - backdrop\n\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\tbg.style.zIndex = 9;\n\t\t\t\t} else if (index === nextFrameIndex && inTransition) {\n\t\t\t\t\t// Next frame transitioning in\n\t\t\t\t\tbg.style.zIndex = 10;\n\t\t\t\t\t\n\t\t\t\t\tif (transitionType === 'fade') {\n\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\t} else if (transitionType === 'left') {\n\t\t\t\t\t\tconst x = (1 - transitionProgress) * 100;\n\t\t\t\t\t\tbg.style.transform = `translate3d(${x}%, 0, 0)`;\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t} else if (transitionType === 'right') {\n\t\t\t\t\t\tconst x = -(1 - transitionProgress) * 100;\n\t\t\t\t\t\tbg.style.transform = `translate3d(${x}%, 0, 0)`;\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t} else if (transitionType === 'up') {\n\t\t\t\t\t\tconst y = (1 - transitionProgress) * 100;\n\t\t\t\t\t\tbg.style.transform = `translate3d(0, ${y}%, 0)`;\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Hidden frames\n\t\t\t\t\tbg.style.opacity = 0;\n\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\tbg.style.zIndex = 5;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tticking = false;\n\t\t}\n\n\t\tfunction onScroll() {\n\t\t\tif (!ticking) {\n\t\t\t\twindow.requestAnimationFrame(updateOnScroll);\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\tfunction onResize() {\n\t\t\tcalculateVirtualHeight();\n\t\t\tupdateOnScroll();\n\t\t}\n\n\t\t// Initialize\n\t\tcalculateVirtualHeight();\n\t\t\n\t\t// Set initial state\n\t\tbackgrounds.forEach((bg, index) => {\n\t\t\tif (index === 0) {\n\t\t\t\tbg.style.opacity = 1;\n\t\t\t\tbg.style.zIndex = 10;\n\t\t\t} else {\n\t\t\t\tbg.style.opacity = 0;\n\t\t\t\tbg.style.zIndex = 5;\n\t\t\t}\n\t\t});\n\t\t\n\t\tcontents.forEach((content) => {\n\t\t\tcontent.style.transform = 'translateY(100vh)';\n\t\t\tcontent.style.opacity = 0;\n\t\t\tcontent.style.transition = 'none';\n\t\t});\n\n\t\t// Set up listeners\n\t\twindow.addEventListener('scroll', onScroll, { passive: true });\n\t\twindow.addEventListener('resize', onResize, { passive: true });\n\n\t\t// Recalculate after images load\n\t\tblock.querySelectorAll('img').forEach((img) => {\n\t\t\tif (!img.complete) {\n\t\t\t\timg.addEventListener('load', () => {\n\t\t\t\t\tcalculateVirtualHeight();\n\t\t\t\t\tupdateOnScroll();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tupdateOnScroll();\n\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener('scroll', onScroll);\n\t\t\twindow.removeEventListener('resize', onResize);\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll('.caes-reveal').forEach(initRevealBlock);\n\t}\n\n\tif (document.readyState === 'loading') {\n\t\tdocument.addEventListener('DOMContentLoaded', initAllBlocks);\n\t} else {\n\t\tinitAllBlocks();\n\t}\n})();"],"names":["initRevealBlock","block","sections","querySelectorAll","backgrounds","contents","length","ticking","blockFixed","virtualHeight","calculateVirtualHeight","viewportHeight","window","innerHeight","totalHeight","forEach","section","index","content","querySelector","bg","contentChildren","children","contentHeight","child","offsetHeight","style","getComputedStyle","parseInt","marginTop","marginBottom","Math","max","speed","getAttribute","transitionDistance","minHeight","updateOnScroll","scrollTop","pageYOffset","document","documentElement","blockRect","getBoundingClientRect","blockTop","top","shouldFix","bottom","classList","add","remove","opacity","transform","zIndex","virtualScroll","currentFrameIndex","accumulatedHeight","inTransition","transitionProgress","nextFrameIndex","frameContentHeight","frameStartHeight","frameEndHeight","transitionEndHeight","frameProgress","contentOffset","transitionVirtualScroll","min","transitionType","x","y","onScroll","requestAnimationFrame","onResize","transition","addEventListener","passive","img","complete","_revealCleanup","removeEventListener","initAllBlocks","readyState"],"sourceRoot":""}