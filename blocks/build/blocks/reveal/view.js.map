{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript - Single Sticky Container Approach\n * \n * This approach uses ONE sticky container for all backgrounds.\n * The container sticks when the block reaches the top of the viewport,\n * and all transitions are handled via opacity/transform - never position changes.\n * \n * Key benefits:\n * - No position switching = no visual jumps\n * - All backgrounds share the same coordinate space = perfect alignment\n * - GPU-accelerated opacity/transform transitions = smooth animations\n */\n\n(function () {\n\t'use strict';\n\n\tfunction debounce(fn, ms) {\n\t\tlet timer;\n\t\treturn function () {\n\t\t\tclearTimeout(timer);\n\t\t\ttimer = setTimeout(fn, ms);\n\t\t};\n\t}\n\n\t/**\n\t * Initialize a single reveal block\n\t */\n\tfunction initRevealBlock(block) {\n\t\tconst backgroundsContainer = block.querySelector('.reveal-backgrounds');\n\t\tconst backgrounds = block.querySelectorAll('.reveal-frame-background');\n\t\tconst sectionsContainer = block.querySelector('.reveal-sections');\n\t\tconst sections = block.querySelectorAll('.reveal-frame-section');\n\n\t\tif (!backgroundsContainer || sections.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Configuration\n\t\tconst config = {\n\t\t\t// How much of the viewport the content area takes up\n\t\t\tcontentViewportRatio: 0.7,\n\t\t\t// Extra scroll distance after last content before unsticking\n\t\t\texitScrollDistance: 0.5, // viewport heights\n\t\t};\n\n\t\tlet ticking = false;\n\t\tlet frameData = [];\n\t\tlet cachedTotalHeight = 0;\n\n\t\t/**\n\t\t * Calculate layout metrics for each frame\n\t\t */\n\t\tfunction calculateLayout() {\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tframeData = [];\n\n\t\t\tlet cumulativeHeight = 0;\n\n\t\t\tsections.forEach((section, index) => {\n\t\t\t\tconst content = section.querySelector('.reveal-frame-content');\n\t\t\t\tconst bg = backgrounds[index];\n\n\t\t\t\t// Get content height\n\t\t\t\tlet contentHeight = 0;\n\t\t\t\tif (content) {\n\t\t\t\t\tconst contentChildren = content.children;\n\t\t\t\t\tfor (let child of contentChildren) {\n\t\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\t\tconst style = window.getComputedStyle(child);\n\t\t\t\t\t\tcontentHeight += parseInt(style.marginTop || 0) + parseInt(style.marginBottom || 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontentHeight = Math.max(contentHeight, 100);\n\n\t\t\t\t// Get transition config\n\t\t\t\tconst speed = bg ? (bg.getAttribute('data-speed') || 'normal') : 'normal';\n\t\t\t\tlet transitionDistance;\n\t\t\t\tswitch (speed) {\n\t\t\t\t\tcase 'slow':\n\t\t\t\t\t\ttransitionDistance = viewportHeight * 2.5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'fast':\n\t\t\t\t\t\ttransitionDistance = viewportHeight * 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ttransitionDistance = viewportHeight * 1.8;\n\t\t\t\t}\n\n\t\t\t\t// Calculate section height:\n\t\t\t\t// For frame 0: content starts centered, padding-top = (vh - contentHeight) / 2\n\t\t\t\t// For other frames: content enters from bottom, padding-top = 100vh (CSS default)\n\t\t\t\t// transitionDistance for the background transition (except last frame)\n\t\t\t\tconst isFirstFrame = index === 0;\n\t\t\t\tconst isLastFrame = index === sections.length - 1;\n\n\t\t\t\t// How far content is pushed down within its section before scrolling begins\n\t\t\t\tconst initialPaddingTop = isFirstFrame\n\t\t\t\t\t? Math.max(0, (viewportHeight - contentHeight) / 2)\n\t\t\t\t\t: viewportHeight;\n\n\t\t\t\t// Override CSS padding-top for the first frame so content starts centered\n\t\t\t\tif (isFirstFrame) {\n\t\t\t\t\tsection.style.paddingTop = initialPaddingTop + 'px';\n\t\t\t\t}\n\n\t\t\t\t// How far user must scroll before content exits the top of the viewport\n\t\t\t\tconst scrollToExit = initialPaddingTop + contentHeight;\n\n\t\t\t\tconst sectionHeight = isLastFrame\n\t\t\t\t\t? scrollToExit + (viewportHeight * config.exitScrollDistance)\n\t\t\t\t\t: scrollToExit + transitionDistance;\n\n\t\t\t\tframeData.push({\n\t\t\t\t\tindex,\n\t\t\t\t\tsection,\n\t\t\t\t\tcontent,\n\t\t\t\t\tbackground: bg,\n\t\t\t\t\tcontentHeight,\n\t\t\t\t\ttransitionDistance,\n\t\t\t\t\tsectionHeight,\n\t\t\t\t\tsectionStart: cumulativeHeight,\n\t\t\t\t\tsectionEnd: cumulativeHeight + sectionHeight,\n\t\t\t\t\tcontentStart: cumulativeHeight,\n\t\t\t\t\tcontentEnd: cumulativeHeight + scrollToExit,\n\t\t\t\t\t// Transition zone starts after content exits the top\n\t\t\t\t\ttransitionStart: cumulativeHeight + scrollToExit,\n\t\t\t\t\ttransitionEnd: cumulativeHeight + scrollToExit + transitionDistance,\n\t\t\t\t\tisLastFrame,\n\t\t\t\t});\n\n\t\t\t\tcumulativeHeight += sectionHeight;\n\n\t\t\t\t// Set section height\n\t\t\t\tsection.style.height = sectionHeight + 'px';\n\t\t\t});\n\n\t\t\t// Set total height for sections container\n\t\t\tsectionsContainer.style.height = cumulativeHeight + 'px';\n\t\t\tcachedTotalHeight = cumulativeHeight;\n\n\t\t\treturn cumulativeHeight;\n\t\t}\n\n\t\t/**\n\t\t * Get scroll progress within the reveal block (0 = top of block at top of viewport, 1 = end)\n\t\t */\n\t\tfunction getBlockScrollProgress() {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst blockTop = window.pageYOffset + blockRect.top;\n\t\t\tconst scrollTop = window.pageYOffset;\n\n\t\t\t// How far we've scrolled into the block\n\t\t\tconst scrollIntoBlock = scrollTop - blockTop;\n\n\t\t\t// Total scrollable distance within the block (cached to avoid forced reflow)\n\t\t\tconst totalHeight = cachedTotalHeight;\n\n\t\t\treturn {\n\t\t\t\tscrollIntoBlock,\n\t\t\t\ttotalHeight,\n\t\t\t\tblockTop,\n\t\t\t\tblockRect,\n\t\t\t\t// Is the block currently \"active\" (sticky container should be stuck)\n\t\t\t\tisActive: blockRect.top <= 0 && blockRect.bottom > window.innerHeight,\n\t\t\t\t// Has the block started (top is at or above viewport top)\n\t\t\t\thasStarted: blockRect.top <= 0,\n\t\t\t\t// Is the block finished (bottom is at or above viewport bottom)\n\t\t\t\tisFinished: blockRect.bottom <= window.innerHeight,\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Determine which frame is active and calculate transition progress\n\t\t */\n\t\tfunction getCurrentFrameState(scrollIntoBlock) {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\tlet activeIndex = 0;\n\t\t\tlet transitioningToIndex = -1;\n\t\t\tlet transitionProgress = 0;\n\n\t\t\tfor (let i = 0; i < frameData.length; i++) {\n\t\t\t\tconst frame = frameData[i];\n\n\t\t\t\tif (scrollIntoBlock >= frame.sectionStart && scrollIntoBlock < frame.sectionEnd) {\n\t\t\t\t\tactiveIndex = i;\n\n\t\t\t\t\t// Check if we're in the transition zone\n\t\t\t\t\tif (!frame.isLastFrame && scrollIntoBlock >= frame.transitionStart) {\n\t\t\t\t\t\ttransitioningToIndex = i + 1;\n\t\t\t\t\t\tconst progressIntoTransition = scrollIntoBlock - frame.transitionStart;\n\t\t\t\t\t\ttransitionProgress = Math.min(1, Math.max(0, progressIntoTransition / frame.transitionDistance));\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we've scrolled past all frames, show the last one\n\t\t\tif (scrollIntoBlock >= frameData[frameData.length - 1]?.sectionEnd) {\n\t\t\t\tactiveIndex = frameData.length - 1;\n\t\t\t}\n\n\t\t\treturn { activeIndex, transitioningToIndex, transitionProgress };\n\t\t}\n\n\t\t/**\n * Apply transition effects to backgrounds\n */\n\t\tfunction applyBackgroundTransitions(activeIndex, transitioningToIndex, transitionProgress) {\n\t\t\tbackgrounds.forEach((bg, index) => {\n\t\t\t\tconst transitionType = bg.getAttribute('data-transition') || 'fade';\n\n\t\t\t\t// Reset transforms\n\t\t\t\tbg.style.transform = '';\n\t\t\t\tbg.style.opacity = '';\n\t\t\t\tbg.style.clipPath = '';\n\n\t\t\t\tif (index === activeIndex && transitioningToIndex === -1) {\n\t\t\t\t\t// Active frame, no transition happening\n\t\t\t\t\tbg.classList.add('is-active');\n\t\t\t\t\tbg.classList.remove('is-transitioning-in', 'is-transitioning-out');\n\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\tbg.style.zIndex = '10';\n\t\t\t\t} else if (index === activeIndex && transitioningToIndex !== -1) {\n\t\t\t\t\t// Active frame, but transitioning out\n\t\t\t\t\tbg.classList.remove('is-active', 'is-transitioning-in');\n\t\t\t\t\tbg.classList.add('is-transitioning-out');\n\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\tbg.style.zIndex = '9';\n\t\t\t\t} else if (index === transitioningToIndex) {\n\t\t\t\t\t// Frame transitioning in\n\t\t\t\t\tbg.classList.remove('is-active', 'is-transitioning-out');\n\t\t\t\t\tbg.classList.add('is-transitioning-in');\n\t\t\t\t\tbg.style.zIndex = '10';\n\n\t\t\t\t\t// Apply transition based on type\n\t\t\t\t\tswitch (transitionType) {\n\t\t\t\t\t\tcase 'fade':\n\t\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\t// Wipe from left edge toward right\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.clipPath = `inset(0 ${(1 - transitionProgress) * 100}% 0 0)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\t// Wipe from right edge toward left\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.clipPath = `inset(0 0 0 ${(1 - transitionProgress) * 100}%)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'up':\n\t\t\t\t\t\t\t// Wipe from top edge downward\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.clipPath = `inset(0 0 ${(1 - transitionProgress) * 100}% 0)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'down':\n\t\t\t\t\t\t\t// Wipe from bottom edge upward\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.clipPath = `inset(${(1 - transitionProgress) * 100}% 0 0 0)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'zoom':\n\t\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\t\tbg.style.transform = `scale(${0.8 + (0.2 * transitionProgress)})`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Hidden frame\n\t\t\t\t\tbg.classList.remove('is-active', 'is-transitioning-in', 'is-transitioning-out');\n\t\t\t\t\tbg.style.opacity = '0';\n\t\t\t\t\tbg.style.zIndex = '5';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Position content within viewport during scroll\n\t\t */\n\t\tfunction updateContentPositions(scrollIntoBlock) {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\tframeData.forEach((frame) => {\n\t\t\t\tif (!frame.content) return;\n\n\t\t\t\t// Calculate where content should be positioned\n\t\t\t\t// Content starts at bottom of viewport, scrolls to top, then off top\n\t\t\t\tconst localScroll = scrollIntoBlock - frame.sectionStart;\n\n\t\t\t\t// Content enters when localScroll = 0 (at bottom)\n\t\t\t\t// Content is centered when localScroll = viewportHeight * 0.15\n\t\t\t\t// Content exits when localScroll = viewportHeight + contentHeight\n\n\t\t\t\t// The content div uses CSS to position itself, we just need to ensure\n\t\t\t\t// the section is tall enough (which we do in calculateLayout)\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Main scroll handler\n\t\t */\n\t\tfunction updateOnScroll() {\n\t\t\tconst { scrollIntoBlock, isActive, hasStarted, isFinished } = getBlockScrollProgress();\n\n\t\t\t// Update block state classes\n\t\t\tblock.classList.toggle('has-started', hasStarted);\n\t\t\tblock.classList.toggle('is-active', isActive);\n\t\t\tblock.classList.toggle('is-finished', isFinished);\n\n\t\t\t// Get current frame state\n\t\t\tconst { activeIndex, transitioningToIndex, transitionProgress } = getCurrentFrameState(scrollIntoBlock);\n\n\t\t\t// Apply background transitions\n\t\t\tapplyBackgroundTransitions(activeIndex, transitioningToIndex, transitionProgress);\n\n\t\t\t// Update content positions if needed\n\t\t\tupdateContentPositions(scrollIntoBlock);\n\n\t\t\t// Store current frame for potential use by other scripts\n\t\t\tblock.dataset.currentFrame = activeIndex;\n\n\t\t\tticking = false;\n\t\t}\n\n\t\t/**\n\t\t * Throttled scroll handler\n\t\t */\n\t\tfunction onScroll() {\n\t\t\tif (!ticking) {\n\t\t\t\twindow.requestAnimationFrame(updateOnScroll);\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Handle resize\n\t\t */\n\t\tfunction onResize() {\n\t\t\tcalculateLayout();\n\t\t\tupdateOnScroll();\n\t\t}\n\n\t\t/**\n\t\t * Initialize\n\t\t */\n\t\tfunction init() {\n\t\t\tcalculateLayout();\n\n\t\t\t// Set up event listeners\n\t\t\twindow.addEventListener('scroll', onScroll, { passive: true });\n\t\t\twindow.addEventListener('resize', onResize, { passive: true });\n\n\t\t\t// Recalculate after images load, debounced to batch rapid successive loads\n\t\t\tconst debouncedRecalculate = debounce(() => {\n\t\t\t\tcalculateLayout();\n\t\t\t\tupdateOnScroll();\n\t\t\t}, 100);\n\n\t\t\tblock.querySelectorAll('img').forEach((img) => {\n\t\t\t\tif (!img.complete) {\n\t\t\t\t\timg.addEventListener('load', debouncedRecalculate);\n\t\t\t\t\timg.addEventListener('error', debouncedRecalculate);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Initial update\n\t\t\tupdateOnScroll();\n\n\t\t\t// Mark as initialized\n\t\t\tblock.dataset.initialized = 'true';\n\t\t}\n\n\t\t// Store cleanup function\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener('scroll', onScroll);\n\t\t\twindow.removeEventListener('resize', onResize);\n\t\t\tactiveBlocks.delete(block);\n\t\t\tif (activeBlocks.size === 0 && domObserver) {\n\t\t\t\tdomObserver.disconnect();\n\t\t\t\tdomObserver = null;\n\t\t\t}\n\t\t};\n\n\t\t// Initialize\n\t\tinit();\n\t\tactiveBlocks.add(block);\n\t}\n\n\tconst activeBlocks = new Set();\n\tlet domObserver = null;\n\n\t/**\n\t * Initialize all reveal blocks on the page\n\t */\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll('.caes-reveal').forEach((block) => {\n\t\t\tif (!block.dataset.initialized) {\n\t\t\t\tinitRevealBlock(block);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Initialize when DOM is ready\n\tif (document.readyState === 'loading') {\n\t\tdocument.addEventListener('DOMContentLoaded', initAllBlocks);\n\t} else {\n\t\tinitAllBlocks();\n\t}\n\n\t// Re-initialize if new blocks are added (for block editor compatibility)\n\tif (typeof MutationObserver !== 'undefined') {\n\t\tdomObserver = new MutationObserver((mutations) => {\n\t\t\tmutations.forEach((mutation) => {\n\t\t\t\tmutation.addedNodes.forEach((node) => {\n\t\t\t\t\tif (node.nodeType === 1) {\n\t\t\t\t\t\tif (node.classList?.contains('caes-reveal')) {\n\t\t\t\t\t\t\tinitRevealBlock(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.querySelectorAll('.caes-reveal').forEach(initRevealBlock);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tdomObserver.observe(document.body, { childList: true, subtree: true });\n\t}\n})();"],"names":["debounce","fn","ms","timer","clearTimeout","setTimeout","initRevealBlock","block","backgroundsContainer","querySelector","backgrounds","querySelectorAll","sectionsContainer","sections","length","config","contentViewportRatio","exitScrollDistance","ticking","frameData","cachedTotalHeight","calculateLayout","viewportHeight","window","innerHeight","cumulativeHeight","forEach","section","index","content","bg","contentHeight","contentChildren","children","child","offsetHeight","style","getComputedStyle","parseInt","marginTop","marginBottom","Math","max","speed","getAttribute","transitionDistance","isFirstFrame","isLastFrame","initialPaddingTop","paddingTop","scrollToExit","sectionHeight","push","background","sectionStart","sectionEnd","contentStart","contentEnd","transitionStart","transitionEnd","height","getBlockScrollProgress","blockRect","getBoundingClientRect","blockTop","pageYOffset","top","scrollTop","scrollIntoBlock","totalHeight","isActive","bottom","hasStarted","isFinished","getCurrentFrameState","activeIndex","transitioningToIndex","transitionProgress","i","frame","progressIntoTransition","min","applyBackgroundTransitions","transitionType","transform","opacity","clipPath","classList","add","remove","zIndex","updateContentPositions","localScroll","updateOnScroll","toggle","dataset","currentFrame","onScroll","requestAnimationFrame","onResize","init","addEventListener","passive","debouncedRecalculate","img","complete","initialized","_revealCleanup","removeEventListener","activeBlocks","delete","size","domObserver","disconnect","Set","initAllBlocks","document","readyState","MutationObserver","mutations","mutation","addedNodes","node","nodeType","contains","observe","body","childList","subtree"],"sourceRoot":""}