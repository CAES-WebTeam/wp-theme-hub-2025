{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript\n *\n * Handles scroll-triggered frame transitions with support for\n * multiple transition types and reduced motion preferences.\n */\n\n( function () {\n\t'use strict';\n\n\t// Check reduced motion preference\n\tconst prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n\t/**\n\t * Initialize a single Reveal block\n\t *\n\t * @param {HTMLElement} block The reveal block element\n\t */\n\tfunction initRevealBlock( block ) {\n\t\tconst background = block.querySelector( '.reveal-background' );\n\t\tconst content = block.querySelector( '.reveal-content' );\n\t\tconst frames = block.querySelectorAll( '.reveal-frame' );\n\n\t\tif ( ! background || ! content || frames.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst frameCount = frames.length;\n\t\tlet currentFrameIndex = 0;\n\t\tlet isInView = false;\n\t\tlet ticking = false;\n\n\t\t/**\n\t\t * Apply transition to a frame\n\t\t *\n\t\t * @param {HTMLElement} frame     The frame element\n\t\t * @param {boolean}     isActive  Whether frame should be active\n\t\t * @param {boolean}     isEntering Whether frame is entering (vs leaving)\n\t\t */\n\t\tfunction applyTransition( frame, isActive, isEntering ) {\n\t\t\tconst transitionType = frame.dataset.transitionType || 'fade';\n\t\t\tconst transitionSpeed = parseInt( frame.dataset.transitionSpeed, 10 ) || 500;\n\n\t\t\t// Set transition duration (or 0 for reduced motion)\n\t\t\tconst duration = prefersReducedMotion ? 0 : transitionSpeed;\n\t\t\tframe.style.transitionDuration = `${ duration }ms`;\n\n\t\t\t// Reset transform\n\t\t\tframe.style.transform = '';\n\n\t\t\tif ( isActive ) {\n\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\tframe.style.opacity = '1';\n\n\t\t\t\t// Apply entrance animation\n\t\t\t\tif ( ! prefersReducedMotion && transitionType !== 'none' && transitionType !== 'fade' ) {\n\t\t\t\t\t// Set initial position for entrance\n\t\t\t\t\tconst startPositions = {\n\t\t\t\t\t\tup: 'translateY(100%)',\n\t\t\t\t\t\tdown: 'translateY(-100%)',\n\t\t\t\t\t\tleft: 'translateX(100%)',\n\t\t\t\t\t\tright: 'translateX(-100%)',\n\t\t\t\t\t};\n\n\t\t\t\t\tif ( startPositions[ transitionType ] ) {\n\t\t\t\t\t\t// Start from offset position\n\t\t\t\t\t\tframe.style.transform = startPositions[ transitionType ];\n\t\t\t\t\t\t// Force reflow\n\t\t\t\t\t\tframe.offsetHeight; // eslint-disable-line no-unused-expressions\n\t\t\t\t\t\t// Animate to center\n\t\t\t\t\t\tframe.style.transform = 'translate(0, 0)';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\tframe.style.opacity = '0';\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Update active frame based on scroll position\n\t\t */\n\t\tfunction updateActiveFrame() {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\t// Calculate scroll progress through the block\n\t\t\t// 0 = block just entered viewport at bottom\n\t\t\t// 1 = block has left viewport at top\n\t\t\tconst blockHeight = block.offsetHeight;\n\t\t\tconst scrollStart = viewportHeight; // Block top at viewport bottom\n\t\t\tconst scrollEnd = -blockHeight; // Block bottom at viewport top\n\t\t\tconst scrollRange = scrollStart - scrollEnd;\n\t\t\tconst currentScroll = blockRect.top;\n\t\t\tconst scrollProgress = Math.max( 0, Math.min( 1, ( scrollStart - currentScroll ) / scrollRange ) );\n\n\t\t\t// Determine which frame should be active\n\t\t\t// Divide scroll progress into equal segments for each frame\n\t\t\tconst newFrameIndex = Math.min(\n\t\t\t\tframeCount - 1,\n\t\t\t\tMath.floor( scrollProgress * frameCount )\n\t\t\t);\n\n\t\t\t// Update frames if index changed\n\t\t\tif ( newFrameIndex !== currentFrameIndex ) {\n\t\t\t\tconst isScrollingDown = newFrameIndex > currentFrameIndex;\n\n\t\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\t\tconst isActive = index === newFrameIndex;\n\t\t\t\t\tconst wasActive = index === currentFrameIndex;\n\n\t\t\t\t\tif ( isActive || wasActive ) {\n\t\t\t\t\t\tapplyTransition( frame, isActive, isActive && isScrollingDown );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tcurrentFrameIndex = newFrameIndex;\n\t\t\t}\n\n\t\t\tticking = false;\n\t\t}\n\n\t\t/**\n\t\t * Handle scroll events with requestAnimationFrame throttling\n\t\t */\n\t\tfunction onScroll() {\n\t\t\tif ( ! isInView ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateActiveFrame );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Handle block entering/leaving viewport\n\t\t *\n\t\t * @param {IntersectionObserverEntry[]} entries Observer entries\n\t\t */\n\t\tfunction onIntersection( entries ) {\n\t\t\tentries.forEach( ( entry ) => {\n\t\t\t\tisInView = entry.isIntersecting;\n\n\t\t\t\tif ( isInView ) {\n\t\t\t\t\t// Block is in viewport - fix background\n\t\t\t\t\tblock.classList.add( 'is-in-view' );\n\t\t\t\t\tbackground.classList.add( 'is-fixed' );\n\t\t\t\t\t// Trigger initial frame update\n\t\t\t\t\tupdateActiveFrame();\n\t\t\t\t} else {\n\t\t\t\t\t// Block left viewport - unfix background\n\t\t\t\t\tblock.classList.remove( 'is-in-view' );\n\t\t\t\t\tbackground.classList.remove( 'is-fixed' );\n\n\t\t\t\t\t// Reset to first or last frame based on scroll direction\n\t\t\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\t\t\tconst resetToFirst = blockRect.top > window.innerHeight;\n\n\t\t\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\t\t\tconst shouldBeActive = resetToFirst ? index === 0 : index === frameCount - 1;\n\t\t\t\t\t\tframe.classList.toggle( 'is-active', shouldBeActive );\n\t\t\t\t\t\tframe.style.opacity = shouldBeActive ? '1' : '0';\n\t\t\t\t\t\tframe.style.transform = '';\n\t\t\t\t\t} );\n\n\t\t\t\t\tcurrentFrameIndex = resetToFirst ? 0 : frameCount - 1;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Set up Intersection Observer\n\t\tconst observer = new IntersectionObserver( onIntersection, {\n\t\t\tthreshold: 0,\n\t\t\trootMargin: '0px',\n\t\t} );\n\n\t\tobserver.observe( block );\n\n\t\t// Add scroll listener\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\n\t\t// Initial state - ensure first frame is visible\n\t\tframes.forEach( ( frame, index ) => {\n\t\t\tif ( index === 0 ) {\n\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\tframe.style.opacity = '1';\n\t\t\t} else {\n\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\tframe.style.opacity = '0';\n\t\t\t}\n\t\t} );\n\n\t\t// Store cleanup function on element for potential future use\n\t\tblock._revealCleanup = function () {\n\t\t\tobserver.disconnect();\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t};\n\t}\n\n\t/**\n\t * Initialize all Reveal blocks on the page\n\t */\n\tfunction initAllBlocks() {\n\t\tconst blocks = document.querySelectorAll( '.caes-reveal' );\n\t\tblocks.forEach( initRevealBlock );\n\t}\n\n\t// Initialize on DOM ready\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","background","querySelector","content","frames","querySelectorAll","length","frameCount","currentFrameIndex","isInView","ticking","applyTransition","frame","isActive","isEntering","transitionType","dataset","transitionSpeed","parseInt","duration","style","transitionDuration","transform","classList","add","opacity","startPositions","up","down","left","right","offsetHeight","remove","updateActiveFrame","blockRect","getBoundingClientRect","viewportHeight","innerHeight","blockHeight","scrollStart","scrollEnd","scrollRange","currentScroll","top","scrollProgress","Math","max","min","newFrameIndex","floor","isScrollingDown","forEach","index","wasActive","onScroll","requestAnimationFrame","onIntersection","entries","entry","isIntersecting","resetToFirst","shouldBeActive","toggle","observer","IntersectionObserver","threshold","rootMargin","observe","addEventListener","passive","_revealCleanup","disconnect","removeEventListener","initAllBlocks","blocks","document","readyState"],"sourceRoot":""}