{"version":3,"file":"blocks/reveal/view.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,YAAY;EACZ,YAAY;;EAEZ;AACD;AACA;EACC,SAASA,eAAeA,CAACC,KAAK,EAAE;IAC/B,MAAMC,oBAAoB,GAAGD,KAAK,CAACE,aAAa,CAAC,qBAAqB,CAAC;IACvE,MAAMC,WAAW,GAAGH,KAAK,CAACI,gBAAgB,CAAC,0BAA0B,CAAC;IACtE,MAAMC,iBAAiB,GAAGL,KAAK,CAACE,aAAa,CAAC,kBAAkB,CAAC;IACjE,MAAMI,QAAQ,GAAGN,KAAK,CAACI,gBAAgB,CAAC,uBAAuB,CAAC;IAEhE,IAAI,CAACH,oBAAoB,IAAIK,QAAQ,CAACC,MAAM,KAAK,CAAC,EAAE;MACnD;IACD;;IAEA;IACA,MAAMC,MAAM,GAAG;MACd;MACAC,oBAAoB,EAAE,GAAG;MACzB;MACAC,kBAAkB,EAAE,GAAG,CAAE;IAC1B,CAAC;IAED,IAAIC,OAAO,GAAG,KAAK;IACnB,IAAIC,SAAS,GAAG,EAAE;;IAElB;AACF;AACA;IACE,SAASC,eAAeA,CAAA,EAAG;MAC1B,MAAMC,cAAc,GAAGC,MAAM,CAACC,WAAW;MACzCJ,SAAS,GAAG,EAAE;MAEd,IAAIK,gBAAgB,GAAG,CAAC;MAExBX,QAAQ,CAACY,OAAO,CAAC,CAACC,OAAO,EAAEC,KAAK,KAAK;QACpC,MAAMC,OAAO,GAAGF,OAAO,CAACjB,aAAa,CAAC,uBAAuB,CAAC;QAC9D,MAAMoB,EAAE,GAAGnB,WAAW,CAACiB,KAAK,CAAC;;QAE7B;QACA,IAAIG,aAAa,GAAG,CAAC;QACrB,IAAIF,OAAO,EAAE;UACZ,MAAMG,eAAe,GAAGH,OAAO,CAACI,QAAQ;UACxC,KAAK,IAAIC,KAAK,IAAIF,eAAe,EAAE;YAClCD,aAAa,IAAIG,KAAK,CAACC,YAAY;YACnC,MAAMC,KAAK,GAAGb,MAAM,CAACc,gBAAgB,CAACH,KAAK,CAAC;YAC5CH,aAAa,IAAIO,QAAQ,CAACF,KAAK,CAACG,SAAS,IAAI,CAAC,CAAC,GAAGD,QAAQ,CAACF,KAAK,CAACI,YAAY,IAAI,CAAC,CAAC;UACpF;QACD;QACAT,aAAa,GAAGU,IAAI,CAACC,GAAG,CAACX,aAAa,EAAE,GAAG,CAAC;;QAE5C;QACA,MAAMY,KAAK,GAAGb,EAAE,GAAIA,EAAE,CAACc,YAAY,CAAC,YAAY,CAAC,IAAI,QAAQ,GAAI,QAAQ;QACzE,IAAIC,kBAAkB;QACtB,QAAQF,KAAK;UACZ,KAAK,MAAM;YACVE,kBAAkB,GAAGvB,cAAc,GAAG,GAAG;YACzC;UACD,KAAK,MAAM;YACVuB,kBAAkB,GAAGvB,cAAc,GAAG,GAAG;YACzC;UACD;YACCuB,kBAAkB,GAAGvB,cAAc,GAAG,GAAG;QAC3C;;QAEA;QACA;QACA;QACA;QACA,MAAMwB,WAAW,GAAGlB,KAAK,KAAKd,QAAQ,CAACC,MAAM,GAAG,CAAC;QACjD,MAAMgC,aAAa,GAAGD,WAAW,GAC9BxB,cAAc,GAAGS,aAAa,GAAIT,cAAc,GAAGN,MAAM,CAACE,kBAAmB,GAC7EI,cAAc,GAAGS,aAAa,GAAGc,kBAAkB;QAEtDzB,SAAS,CAAC4B,IAAI,CAAC;UACdpB,KAAK;UACLD,OAAO;UACPE,OAAO;UACPoB,UAAU,EAAEnB,EAAE;UACdC,aAAa;UACbc,kBAAkB;UAClBE,aAAa;UACbG,YAAY,EAAEzB,gBAAgB;UAC9B0B,UAAU,EAAE1B,gBAAgB,GAAGsB,aAAa;UAC5C;UACAK,YAAY,EAAE3B,gBAAgB;UAC9B4B,UAAU,EAAE5B,gBAAgB,GAAGH,cAAc,GAAGS,aAAa;UAC7D;UACAuB,eAAe,EAAE7B,gBAAgB,GAAGH,cAAc,GAAGS,aAAa;UAClEwB,aAAa,EAAE9B,gBAAgB,GAAGH,cAAc,GAAGS,aAAa,GAAGc,kBAAkB;UACrFC;QACD,CAAC,CAAC;QAEFrB,gBAAgB,IAAIsB,aAAa;;QAEjC;QACApB,OAAO,CAACS,KAAK,CAACoB,MAAM,GAAGT,aAAa,GAAG,IAAI;MAC5C,CAAC,CAAC;;MAEF;MACAlC,iBAAiB,CAACuB,KAAK,CAACoB,MAAM,GAAG/B,gBAAgB,GAAG,IAAI;MAExD,OAAOA,gBAAgB;IACxB;;IAEA;AACF;AACA;IACE,SAASgC,sBAAsBA,CAAA,EAAG;MACjC,MAAMC,SAAS,GAAGlD,KAAK,CAACmD,qBAAqB,CAAC,CAAC;MAC/C,MAAMC,QAAQ,GAAGrC,MAAM,CAACsC,WAAW,GAAGH,SAAS,CAACI,GAAG;MACnD,MAAMC,SAAS,GAAGxC,MAAM,CAACsC,WAAW;;MAEpC;MACA,MAAMG,eAAe,GAAGD,SAAS,GAAGH,QAAQ;;MAE5C;MACA,MAAMK,WAAW,GAAGpD,iBAAiB,CAACsB,YAAY;MAElD,OAAO;QACN6B,eAAe;QACfC,WAAW;QACXL,QAAQ;QACRF,SAAS;QACT;QACAQ,QAAQ,EAAER,SAAS,CAACI,GAAG,IAAI,CAAC,IAAIJ,SAAS,CAACS,MAAM,GAAG5C,MAAM,CAACC,WAAW;QACrE;QACA4C,UAAU,EAAEV,SAAS,CAACI,GAAG,IAAI,CAAC;QAC9B;QACAO,UAAU,EAAEX,SAAS,CAACS,MAAM,IAAI5C,MAAM,CAACC;MACxC,CAAC;IACF;;IAEA;AACF;AACA;IACE,SAAS8C,oBAAoBA,CAACN,eAAe,EAAE;MAC9C,MAAM1C,cAAc,GAAGC,MAAM,CAACC,WAAW;MAEzC,IAAI+C,WAAW,GAAG,CAAC;MACnB,IAAIC,oBAAoB,GAAG,CAAC,CAAC;MAC7B,IAAIC,kBAAkB,GAAG,CAAC;MAE1B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGtD,SAAS,CAACL,MAAM,EAAE2D,CAAC,EAAE,EAAE;QAC1C,MAAMC,KAAK,GAAGvD,SAAS,CAACsD,CAAC,CAAC;QAE1B,IAAIV,eAAe,IAAIW,KAAK,CAACzB,YAAY,IAAIc,eAAe,GAAGW,KAAK,CAACxB,UAAU,EAAE;UAChFoB,WAAW,GAAGG,CAAC;;UAEf;UACA,IAAI,CAACC,KAAK,CAAC7B,WAAW,IAAIkB,eAAe,IAAIW,KAAK,CAACrB,eAAe,EAAE;YACnEkB,oBAAoB,GAAGE,CAAC,GAAG,CAAC;YAC5B,MAAME,sBAAsB,GAAGZ,eAAe,GAAGW,KAAK,CAACrB,eAAe;YACtEmB,kBAAkB,GAAGhC,IAAI,CAACoC,GAAG,CAAC,CAAC,EAAEpC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEkC,sBAAsB,GAAGD,KAAK,CAAC9B,kBAAkB,CAAC,CAAC;UACjG;UAEA;QACD;MACD;;MAEA;MACA,IAAImB,eAAe,IAAI5C,SAAS,CAACA,SAAS,CAACL,MAAM,GAAG,CAAC,CAAC,EAAEoC,UAAU,EAAE;QACnEoB,WAAW,GAAGnD,SAAS,CAACL,MAAM,GAAG,CAAC;MACnC;MAEA,OAAO;QAAEwD,WAAW;QAAEC,oBAAoB;QAAEC;MAAmB,CAAC;IACjE;;IAEA;AACF;AACA;IACE,SAASK,0BAA0BA,CAACP,WAAW,EAAEC,oBAAoB,EAAEC,kBAAkB,EAAE;MAC1F9D,WAAW,CAACe,OAAO,CAAC,CAACI,EAAE,EAAEF,KAAK,KAAK;QAClC,MAAMmD,cAAc,GAAGjD,EAAE,CAACc,YAAY,CAAC,iBAAiB,CAAC,IAAI,MAAM;;QAEnE;QACAd,EAAE,CAACM,KAAK,CAAC4C,SAAS,GAAG,EAAE;QACvBlD,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,EAAE;QAErB,IAAIrD,KAAK,KAAK2C,WAAW,IAAIC,oBAAoB,KAAK,CAAC,CAAC,EAAE;UACzD;UACA1C,EAAE,CAACoD,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;UAC7BrD,EAAE,CAACoD,SAAS,CAACE,MAAM,CAAC,qBAAqB,EAAE,sBAAsB,CAAC;UAClEtD,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,GAAG;UACtBnD,EAAE,CAACM,KAAK,CAACiD,MAAM,GAAG,IAAI;QACvB,CAAC,MAAM,IAAIzD,KAAK,KAAK2C,WAAW,IAAIC,oBAAoB,KAAK,CAAC,CAAC,EAAE;UAChE;UACA1C,EAAE,CAACoD,SAAS,CAACE,MAAM,CAAC,WAAW,EAAE,qBAAqB,CAAC;UACvDtD,EAAE,CAACoD,SAAS,CAACC,GAAG,CAAC,sBAAsB,CAAC;UACxCrD,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,GAAG;UACtBnD,EAAE,CAACM,KAAK,CAACiD,MAAM,GAAG,GAAG;QACtB,CAAC,MAAM,IAAIzD,KAAK,KAAK4C,oBAAoB,EAAE;UAC1C;UACA1C,EAAE,CAACoD,SAAS,CAACE,MAAM,CAAC,WAAW,EAAE,sBAAsB,CAAC;UACxDtD,EAAE,CAACoD,SAAS,CAACC,GAAG,CAAC,qBAAqB,CAAC;UACvCrD,EAAE,CAACM,KAAK,CAACiD,MAAM,GAAG,IAAI;;UAEtB;UACA,QAAQN,cAAc;YACrB,KAAK,MAAM;cACVjD,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAGR,kBAAkB;cACrC;YACD,KAAK,MAAM;cACV3C,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,GAAG;cACtBnD,EAAE,CAACM,KAAK,CAAC4C,SAAS,GAAG,eAAe,CAAC,CAAC,GAAGP,kBAAkB,IAAI,GAAG,UAAU;cAC5E;YACD,KAAK,OAAO;cACX3C,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,GAAG;cACtBnD,EAAE,CAACM,KAAK,CAAC4C,SAAS,GAAG,eAAe,CAACP,kBAAkB,GAAG,CAAC,IAAI,GAAG,UAAU;cAC5E;YACD,KAAK,IAAI;cACR3C,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,GAAG;cACtBnD,EAAE,CAACM,KAAK,CAAC4C,SAAS,GAAG,kBAAkB,CAAC,CAAC,GAAGP,kBAAkB,IAAI,GAAG,OAAO;cAC5E;YACD,KAAK,MAAM;cACV3C,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,GAAG;cACtBnD,EAAE,CAACM,KAAK,CAAC4C,SAAS,GAAG,kBAAkB,CAACP,kBAAkB,GAAG,CAAC,IAAI,GAAG,OAAO;cAC5E;YACD,KAAK,MAAM;cACV3C,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAGR,kBAAkB;cACrC3C,EAAE,CAACM,KAAK,CAAC4C,SAAS,GAAG,SAAS,GAAG,GAAI,GAAG,GAAGP,kBAAmB,GAAG;cACjE;YACD;cACC3C,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAGR,kBAAkB;UACvC;QACD,CAAC,MAAM;UACN;UACA3C,EAAE,CAACoD,SAAS,CAACE,MAAM,CAAC,WAAW,EAAE,qBAAqB,EAAE,sBAAsB,CAAC;UAC/EtD,EAAE,CAACM,KAAK,CAAC6C,OAAO,GAAG,GAAG;UACtBnD,EAAE,CAACM,KAAK,CAACiD,MAAM,GAAG,GAAG;QACtB;MACD,CAAC,CAAC;IACH;;IAEA;AACF;AACA;IACE,SAASC,sBAAsBA,CAACtB,eAAe,EAAE;MAChD,MAAM1C,cAAc,GAAGC,MAAM,CAACC,WAAW;MAEzCJ,SAAS,CAACM,OAAO,CAAEiD,KAAK,IAAK;QAC5B,IAAI,CAACA,KAAK,CAAC9C,OAAO,EAAE;;QAEpB;QACA;QACA,MAAM0D,WAAW,GAAGvB,eAAe,GAAGW,KAAK,CAACzB,YAAY;;QAExD;QACA;QACA;;QAEA;QACA;MACD,CAAC,CAAC;IACH;;IAEA;AACF;AACA;IACE,SAASsC,cAAcA,CAAA,EAAG;MACzB,MAAM;QAAExB,eAAe;QAAEE,QAAQ;QAAEE,UAAU;QAAEC;MAAW,CAAC,GAAGZ,sBAAsB,CAAC,CAAC;;MAEtF;MACAjD,KAAK,CAAC0E,SAAS,CAACO,MAAM,CAAC,aAAa,EAAErB,UAAU,CAAC;MACjD5D,KAAK,CAAC0E,SAAS,CAACO,MAAM,CAAC,WAAW,EAAEvB,QAAQ,CAAC;MAC7C1D,KAAK,CAAC0E,SAAS,CAACO,MAAM,CAAC,aAAa,EAAEpB,UAAU,CAAC;;MAEjD;MACA,MAAM;QAAEE,WAAW;QAAEC,oBAAoB;QAAEC;MAAmB,CAAC,GAAGH,oBAAoB,CAACN,eAAe,CAAC;;MAEvG;MACAc,0BAA0B,CAACP,WAAW,EAAEC,oBAAoB,EAAEC,kBAAkB,CAAC;;MAEjF;MACAa,sBAAsB,CAACtB,eAAe,CAAC;;MAEvC;MACAxD,KAAK,CAACkF,OAAO,CAACC,YAAY,GAAGpB,WAAW;MAExCpD,OAAO,GAAG,KAAK;IAChB;;IAEA;AACF;AACA;IACE,SAASyE,QAAQA,CAAA,EAAG;MACnB,IAAI,CAACzE,OAAO,EAAE;QACbI,MAAM,CAACsE,qBAAqB,CAACL,cAAc,CAAC;QAC5CrE,OAAO,GAAG,IAAI;MACf;IACD;;IAEA;AACF;AACA;IACE,SAAS2E,QAAQA,CAAA,EAAG;MACnBzE,eAAe,CAAC,CAAC;MACjBmE,cAAc,CAAC,CAAC;IACjB;;IAEA;AACF;AACA;IACE,SAASO,IAAIA,CAAA,EAAG;MACf1E,eAAe,CAAC,CAAC;;MAEjB;MACAE,MAAM,CAACyE,gBAAgB,CAAC,QAAQ,EAAEJ,QAAQ,EAAE;QAAEK,OAAO,EAAE;MAAK,CAAC,CAAC;MAC9D1E,MAAM,CAACyE,gBAAgB,CAAC,QAAQ,EAAEF,QAAQ,EAAE;QAAEG,OAAO,EAAE;MAAK,CAAC,CAAC;;MAE9D;MACA,MAAMC,MAAM,GAAG1F,KAAK,CAACI,gBAAgB,CAAC,KAAK,CAAC;MAC5C,IAAIuF,YAAY,GAAG,CAAC;MACpB,MAAMC,WAAW,GAAGF,MAAM,CAACnF,MAAM;MAEjCmF,MAAM,CAACxE,OAAO,CAAE2E,GAAG,IAAK;QACvB,IAAIA,GAAG,CAACC,QAAQ,EAAE;UACjBH,YAAY,EAAE;QACf,CAAC,MAAM;UACNE,GAAG,CAACL,gBAAgB,CAAC,MAAM,EAAE,MAAM;YAClCG,YAAY,EAAE;YACd,IAAIA,YAAY,KAAKC,WAAW,EAAE;cACjC/E,eAAe,CAAC,CAAC;cACjBmE,cAAc,CAAC,CAAC;YACjB;UACD,CAAC,CAAC;UACFa,GAAG,CAACL,gBAAgB,CAAC,OAAO,EAAE,MAAM;YACnCG,YAAY,EAAE;UACf,CAAC,CAAC;QACH;MACD,CAAC,CAAC;;MAEF;MACAX,cAAc,CAAC,CAAC;;MAEhB;MACAhF,KAAK,CAACkF,OAAO,CAACa,WAAW,GAAG,MAAM;IACnC;;IAEA;IACA/F,KAAK,CAACgG,cAAc,GAAG,YAAY;MAClCjF,MAAM,CAACkF,mBAAmB,CAAC,QAAQ,EAAEb,QAAQ,CAAC;MAC9CrE,MAAM,CAACkF,mBAAmB,CAAC,QAAQ,EAAEX,QAAQ,CAAC;IAC/C,CAAC;;IAED;IACAC,IAAI,CAAC,CAAC;EACP;;EAEA;AACD;AACA;EACC,SAASW,aAAaA,CAAA,EAAG;IACxBC,QAAQ,CAAC/F,gBAAgB,CAAC,cAAc,CAAC,CAACc,OAAO,CAAElB,KAAK,IAAK;MAC5D,IAAI,CAACA,KAAK,CAACkF,OAAO,CAACa,WAAW,EAAE;QAC/BhG,eAAe,CAACC,KAAK,CAAC;MACvB;IACD,CAAC,CAAC;EACH;;EAEA;EACA,IAAImG,QAAQ,CAACC,UAAU,KAAK,SAAS,EAAE;IACtCD,QAAQ,CAACX,gBAAgB,CAAC,kBAAkB,EAAEU,aAAa,CAAC;EAC7D,CAAC,MAAM;IACNA,aAAa,CAAC,CAAC;EAChB;;EAEA;EACA,IAAI,OAAOG,gBAAgB,KAAK,WAAW,EAAE;IAC5C,MAAMC,QAAQ,GAAG,IAAID,gBAAgB,CAAEE,SAAS,IAAK;MACpDA,SAAS,CAACrF,OAAO,CAAEsF,QAAQ,IAAK;QAC/BA,QAAQ,CAACC,UAAU,CAACvF,OAAO,CAAEwF,IAAI,IAAK;UACrC,IAAIA,IAAI,CAACC,QAAQ,KAAK,CAAC,EAAE;YACxB,IAAID,IAAI,CAAChC,SAAS,EAAEkC,QAAQ,CAAC,aAAa,CAAC,EAAE;cAC5C7G,eAAe,CAAC2G,IAAI,CAAC;YACtB;YACAA,IAAI,CAACtG,gBAAgB,GAAG,cAAc,CAAC,EAAEc,OAAO,CAACnB,eAAe,CAAC;UAClE;QACD,CAAC,CAAC;MACH,CAAC,CAAC;IACH,CAAC,CAAC;IAEFuG,QAAQ,CAACO,OAAO,CAACV,QAAQ,CAACW,IAAI,EAAE;MAAEC,SAAS,EAAE,IAAI;MAAEC,OAAO,EAAE;IAAK,CAAC,CAAC;EACpE;AACD,CAAC,EAAE,CAAC,C","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript - Single Sticky Container Approach\n * \n * This approach uses ONE sticky container for all backgrounds.\n * The container sticks when the block reaches the top of the viewport,\n * and all transitions are handled via opacity/transform - never position changes.\n * \n * Key benefits:\n * - No position switching = no visual jumps\n * - All backgrounds share the same coordinate space = perfect alignment\n * - GPU-accelerated opacity/transform transitions = smooth animations\n */\n\n(function () {\n\t'use strict';\n\n\t/**\n\t * Initialize a single reveal block\n\t */\n\tfunction initRevealBlock(block) {\n\t\tconst backgroundsContainer = block.querySelector('.reveal-backgrounds');\n\t\tconst backgrounds = block.querySelectorAll('.reveal-frame-background');\n\t\tconst sectionsContainer = block.querySelector('.reveal-sections');\n\t\tconst sections = block.querySelectorAll('.reveal-frame-section');\n\n\t\tif (!backgroundsContainer || sections.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Configuration\n\t\tconst config = {\n\t\t\t// How much of the viewport the content area takes up\n\t\t\tcontentViewportRatio: 0.7,\n\t\t\t// Extra scroll distance after last content before unsticking\n\t\t\texitScrollDistance: 0.5, // viewport heights\n\t\t};\n\n\t\tlet ticking = false;\n\t\tlet frameData = [];\n\n\t\t/**\n\t\t * Calculate layout metrics for each frame\n\t\t */\n\t\tfunction calculateLayout() {\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tframeData = [];\n\n\t\t\tlet cumulativeHeight = 0;\n\n\t\t\tsections.forEach((section, index) => {\n\t\t\t\tconst content = section.querySelector('.reveal-frame-content');\n\t\t\t\tconst bg = backgrounds[index];\n\t\t\t\t\n\t\t\t\t// Get content height\n\t\t\t\tlet contentHeight = 0;\n\t\t\t\tif (content) {\n\t\t\t\t\tconst contentChildren = content.children;\n\t\t\t\t\tfor (let child of contentChildren) {\n\t\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\t\tconst style = window.getComputedStyle(child);\n\t\t\t\t\t\tcontentHeight += parseInt(style.marginTop || 0) + parseInt(style.marginBottom || 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontentHeight = Math.max(contentHeight, 100);\n\n\t\t\t\t// Get transition config\n\t\t\t\tconst speed = bg ? (bg.getAttribute('data-speed') || 'normal') : 'normal';\n\t\t\t\tlet transitionDistance;\n\t\t\t\tswitch (speed) {\n\t\t\t\t\tcase 'slow':\n\t\t\t\t\t\ttransitionDistance = viewportHeight * 2.5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'fast':\n\t\t\t\t\t\ttransitionDistance = viewportHeight * 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ttransitionDistance = viewportHeight * 1.8;\n\t\t\t\t}\n\n\t\t\t\t// Calculate section height:\n\t\t\t\t// - 1vh for content to enter from bottom\n\t\t\t\t// - contentHeight for scrolling through content\n\t\t\t\t// - transitionDistance for the background transition (except last frame)\n\t\t\t\tconst isLastFrame = index === sections.length - 1;\n\t\t\t\tconst sectionHeight = isLastFrame\n\t\t\t\t\t? viewportHeight + contentHeight + (viewportHeight * config.exitScrollDistance)\n\t\t\t\t\t: viewportHeight + contentHeight + transitionDistance;\n\n\t\t\t\tframeData.push({\n\t\t\t\t\tindex,\n\t\t\t\t\tsection,\n\t\t\t\t\tcontent,\n\t\t\t\t\tbackground: bg,\n\t\t\t\t\tcontentHeight,\n\t\t\t\t\ttransitionDistance,\n\t\t\t\t\tsectionHeight,\n\t\t\t\t\tsectionStart: cumulativeHeight,\n\t\t\t\t\tsectionEnd: cumulativeHeight + sectionHeight,\n\t\t\t\t\t// Content is visible from sectionStart to sectionStart + vh + contentHeight\n\t\t\t\t\tcontentStart: cumulativeHeight,\n\t\t\t\t\tcontentEnd: cumulativeHeight + viewportHeight + contentHeight,\n\t\t\t\t\t// Transition zone starts after content\n\t\t\t\t\ttransitionStart: cumulativeHeight + viewportHeight + contentHeight,\n\t\t\t\t\ttransitionEnd: cumulativeHeight + viewportHeight + contentHeight + transitionDistance,\n\t\t\t\t\tisLastFrame,\n\t\t\t\t});\n\n\t\t\t\tcumulativeHeight += sectionHeight;\n\n\t\t\t\t// Set section height\n\t\t\t\tsection.style.height = sectionHeight + 'px';\n\t\t\t});\n\n\t\t\t// Set total height for sections container\n\t\t\tsectionsContainer.style.height = cumulativeHeight + 'px';\n\n\t\t\treturn cumulativeHeight;\n\t\t}\n\n\t\t/**\n\t\t * Get scroll progress within the reveal block (0 = top of block at top of viewport, 1 = end)\n\t\t */\n\t\tfunction getBlockScrollProgress() {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst blockTop = window.pageYOffset + blockRect.top;\n\t\t\tconst scrollTop = window.pageYOffset;\n\t\t\t\n\t\t\t// How far we've scrolled into the block\n\t\t\tconst scrollIntoBlock = scrollTop - blockTop;\n\t\t\t\n\t\t\t// Total scrollable distance within the block\n\t\t\tconst totalHeight = sectionsContainer.offsetHeight;\n\t\t\t\n\t\t\treturn {\n\t\t\t\tscrollIntoBlock,\n\t\t\t\ttotalHeight,\n\t\t\t\tblockTop,\n\t\t\t\tblockRect,\n\t\t\t\t// Is the block currently \"active\" (sticky container should be stuck)\n\t\t\t\tisActive: blockRect.top <= 0 && blockRect.bottom > window.innerHeight,\n\t\t\t\t// Has the block started (top is at or above viewport top)\n\t\t\t\thasStarted: blockRect.top <= 0,\n\t\t\t\t// Is the block finished (bottom is at or above viewport bottom)\n\t\t\t\tisFinished: blockRect.bottom <= window.innerHeight,\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Determine which frame is active and calculate transition progress\n\t\t */\n\t\tfunction getCurrentFrameState(scrollIntoBlock) {\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\t\n\t\t\tlet activeIndex = 0;\n\t\t\tlet transitioningToIndex = -1;\n\t\t\tlet transitionProgress = 0;\n\n\t\t\tfor (let i = 0; i < frameData.length; i++) {\n\t\t\t\tconst frame = frameData[i];\n\t\t\t\t\n\t\t\t\tif (scrollIntoBlock >= frame.sectionStart && scrollIntoBlock < frame.sectionEnd) {\n\t\t\t\t\tactiveIndex = i;\n\t\t\t\t\t\n\t\t\t\t\t// Check if we're in the transition zone\n\t\t\t\t\tif (!frame.isLastFrame && scrollIntoBlock >= frame.transitionStart) {\n\t\t\t\t\t\ttransitioningToIndex = i + 1;\n\t\t\t\t\t\tconst progressIntoTransition = scrollIntoBlock - frame.transitionStart;\n\t\t\t\t\t\ttransitionProgress = Math.min(1, Math.max(0, progressIntoTransition / frame.transitionDistance));\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we've scrolled past all frames, show the last one\n\t\t\tif (scrollIntoBlock >= frameData[frameData.length - 1]?.sectionEnd) {\n\t\t\t\tactiveIndex = frameData.length - 1;\n\t\t\t}\n\n\t\t\treturn { activeIndex, transitioningToIndex, transitionProgress };\n\t\t}\n\n\t\t/**\n\t\t * Apply transition effects to backgrounds\n\t\t */\n\t\tfunction applyBackgroundTransitions(activeIndex, transitioningToIndex, transitionProgress) {\n\t\t\tbackgrounds.forEach((bg, index) => {\n\t\t\t\tconst transitionType = bg.getAttribute('data-transition') || 'fade';\n\t\t\t\t\n\t\t\t\t// Reset transforms\n\t\t\t\tbg.style.transform = '';\n\t\t\t\tbg.style.opacity = '';\n\t\t\t\t\n\t\t\t\tif (index === activeIndex && transitioningToIndex === -1) {\n\t\t\t\t\t// Active frame, no transition happening\n\t\t\t\t\tbg.classList.add('is-active');\n\t\t\t\t\tbg.classList.remove('is-transitioning-in', 'is-transitioning-out');\n\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\tbg.style.zIndex = '10';\n\t\t\t\t} else if (index === activeIndex && transitioningToIndex !== -1) {\n\t\t\t\t\t// Active frame, but transitioning out\n\t\t\t\t\tbg.classList.remove('is-active', 'is-transitioning-in');\n\t\t\t\t\tbg.classList.add('is-transitioning-out');\n\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\tbg.style.zIndex = '9';\n\t\t\t\t} else if (index === transitioningToIndex) {\n\t\t\t\t\t// Frame transitioning in\n\t\t\t\t\tbg.classList.remove('is-active', 'is-transitioning-out');\n\t\t\t\t\tbg.classList.add('is-transitioning-in');\n\t\t\t\t\tbg.style.zIndex = '10';\n\t\t\t\t\t\n\t\t\t\t\t// Apply transition based on type\n\t\t\t\t\tswitch (transitionType) {\n\t\t\t\t\t\tcase 'fade':\n\t\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.transform = `translate3d(${(1 - transitionProgress) * 100}%, 0, 0)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.transform = `translate3d(${(transitionProgress - 1) * 100}%, 0, 0)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'up':\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.transform = `translate3d(0, ${(1 - transitionProgress) * 100}%, 0)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'down':\n\t\t\t\t\t\t\tbg.style.opacity = '1';\n\t\t\t\t\t\t\tbg.style.transform = `translate3d(0, ${(transitionProgress - 1) * 100}%, 0)`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'zoom':\n\t\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\t\tbg.style.transform = `scale(${0.8 + (0.2 * transitionProgress)})`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Hidden frame\n\t\t\t\t\tbg.classList.remove('is-active', 'is-transitioning-in', 'is-transitioning-out');\n\t\t\t\t\tbg.style.opacity = '0';\n\t\t\t\t\tbg.style.zIndex = '5';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Position content within viewport during scroll\n\t\t */\n\t\tfunction updateContentPositions(scrollIntoBlock) {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\tframeData.forEach((frame) => {\n\t\t\t\tif (!frame.content) return;\n\n\t\t\t\t// Calculate where content should be positioned\n\t\t\t\t// Content starts at bottom of viewport, scrolls to top, then off top\n\t\t\t\tconst localScroll = scrollIntoBlock - frame.sectionStart;\n\t\t\t\t\n\t\t\t\t// Content enters when localScroll = 0 (at bottom)\n\t\t\t\t// Content is centered when localScroll = viewportHeight * 0.15\n\t\t\t\t// Content exits when localScroll = viewportHeight + contentHeight\n\t\t\t\t\n\t\t\t\t// The content div uses CSS to position itself, we just need to ensure\n\t\t\t\t// the section is tall enough (which we do in calculateLayout)\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Main scroll handler\n\t\t */\n\t\tfunction updateOnScroll() {\n\t\t\tconst { scrollIntoBlock, isActive, hasStarted, isFinished } = getBlockScrollProgress();\n\n\t\t\t// Update block state classes\n\t\t\tblock.classList.toggle('has-started', hasStarted);\n\t\t\tblock.classList.toggle('is-active', isActive);\n\t\t\tblock.classList.toggle('is-finished', isFinished);\n\n\t\t\t// Get current frame state\n\t\t\tconst { activeIndex, transitioningToIndex, transitionProgress } = getCurrentFrameState(scrollIntoBlock);\n\n\t\t\t// Apply background transitions\n\t\t\tapplyBackgroundTransitions(activeIndex, transitioningToIndex, transitionProgress);\n\n\t\t\t// Update content positions if needed\n\t\t\tupdateContentPositions(scrollIntoBlock);\n\n\t\t\t// Store current frame for potential use by other scripts\n\t\t\tblock.dataset.currentFrame = activeIndex;\n\n\t\t\tticking = false;\n\t\t}\n\n\t\t/**\n\t\t * Throttled scroll handler\n\t\t */\n\t\tfunction onScroll() {\n\t\t\tif (!ticking) {\n\t\t\t\twindow.requestAnimationFrame(updateOnScroll);\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Handle resize\n\t\t */\n\t\tfunction onResize() {\n\t\t\tcalculateLayout();\n\t\t\tupdateOnScroll();\n\t\t}\n\n\t\t/**\n\t\t * Initialize\n\t\t */\n\t\tfunction init() {\n\t\t\tcalculateLayout();\n\t\t\t\n\t\t\t// Set up event listeners\n\t\t\twindow.addEventListener('scroll', onScroll, { passive: true });\n\t\t\twindow.addEventListener('resize', onResize, { passive: true });\n\n\t\t\t// Recalculate after images load\n\t\t\tconst images = block.querySelectorAll('img');\n\t\t\tlet imagesLoaded = 0;\n\t\t\tconst totalImages = images.length;\n\n\t\t\timages.forEach((img) => {\n\t\t\t\tif (img.complete) {\n\t\t\t\t\timagesLoaded++;\n\t\t\t\t} else {\n\t\t\t\t\timg.addEventListener('load', () => {\n\t\t\t\t\t\timagesLoaded++;\n\t\t\t\t\t\tif (imagesLoaded === totalImages) {\n\t\t\t\t\t\t\tcalculateLayout();\n\t\t\t\t\t\t\tupdateOnScroll();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\timg.addEventListener('error', () => {\n\t\t\t\t\t\timagesLoaded++;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Initial update\n\t\t\tupdateOnScroll();\n\n\t\t\t// Mark as initialized\n\t\t\tblock.dataset.initialized = 'true';\n\t\t}\n\n\t\t// Store cleanup function\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener('scroll', onScroll);\n\t\t\twindow.removeEventListener('resize', onResize);\n\t\t};\n\n\t\t// Initialize\n\t\tinit();\n\t}\n\n\t/**\n\t * Initialize all reveal blocks on the page\n\t */\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll('.caes-reveal').forEach((block) => {\n\t\t\tif (!block.dataset.initialized) {\n\t\t\t\tinitRevealBlock(block);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Initialize when DOM is ready\n\tif (document.readyState === 'loading') {\n\t\tdocument.addEventListener('DOMContentLoaded', initAllBlocks);\n\t} else {\n\t\tinitAllBlocks();\n\t}\n\n\t// Re-initialize if new blocks are added (for block editor compatibility)\n\tif (typeof MutationObserver !== 'undefined') {\n\t\tconst observer = new MutationObserver((mutations) => {\n\t\t\tmutations.forEach((mutation) => {\n\t\t\t\tmutation.addedNodes.forEach((node) => {\n\t\t\t\t\tif (node.nodeType === 1) {\n\t\t\t\t\t\tif (node.classList?.contains('caes-reveal')) {\n\t\t\t\t\t\t\tinitRevealBlock(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.querySelectorAll?.('.caes-reveal')?.forEach(initRevealBlock);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tobserver.observe(document.body, { childList: true, subtree: true });\n\t}\n})();"],"names":["initRevealBlock","block","backgroundsContainer","querySelector","backgrounds","querySelectorAll","sectionsContainer","sections","length","config","contentViewportRatio","exitScrollDistance","ticking","frameData","calculateLayout","viewportHeight","window","innerHeight","cumulativeHeight","forEach","section","index","content","bg","contentHeight","contentChildren","children","child","offsetHeight","style","getComputedStyle","parseInt","marginTop","marginBottom","Math","max","speed","getAttribute","transitionDistance","isLastFrame","sectionHeight","push","background","sectionStart","sectionEnd","contentStart","contentEnd","transitionStart","transitionEnd","height","getBlockScrollProgress","blockRect","getBoundingClientRect","blockTop","pageYOffset","top","scrollTop","scrollIntoBlock","totalHeight","isActive","bottom","hasStarted","isFinished","getCurrentFrameState","activeIndex","transitioningToIndex","transitionProgress","i","frame","progressIntoTransition","min","applyBackgroundTransitions","transitionType","transform","opacity","classList","add","remove","zIndex","updateContentPositions","localScroll","updateOnScroll","toggle","dataset","currentFrame","onScroll","requestAnimationFrame","onResize","init","addEventListener","passive","images","imagesLoaded","totalImages","img","complete","initialized","_revealCleanup","removeEventListener","initAllBlocks","document","readyState","MutationObserver","observer","mutations","mutation","addedNodes","node","nodeType","contains","observe","body","childList","subtree"],"sourceRoot":""}