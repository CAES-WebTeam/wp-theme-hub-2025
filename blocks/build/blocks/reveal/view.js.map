{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript\n *\n * Handles scroll-triggered frame transitions.\n * The CSS uses clip-path to handle the visual \"window\" effect,\n * so JS only needs to manage frame transitions based on scroll position.\n */\n\n( function () {\n\t'use strict';\n\n\t// Check reduced motion preference\n\tconst prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n\t/**\n\t * Initialize a single Reveal block\n\t *\n\t * @param {HTMLElement} block The reveal block element\n\t */\n\tfunction initRevealBlock( block ) {\n\t\tconst frames = block.querySelectorAll( '.reveal-frame' );\n\n\t\tif ( frames.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst frameCount = frames.length;\n\t\tlet ticking = false;\n\n\t\t/**\n\t\t * Calculate styles for the entering frame based on type and progress\n\t\t * @param {string} type Transition type (up, down, left, right, fade)\n\t\t * @param {number} progress 0 to 1\n\t\t * @return {object} Object with opacity and transform properties\n\t\t */\n\t\tfunction getTransitionStyles( type, progress ) {\n\t\t\t// Force fade for reduced motion\n\t\t\tif ( prefersReducedMotion ) {\n\t\t\t\ttype = 'fade';\n\t\t\t}\n\n\t\t\tlet styles = {\n\t\t\t\topacity: '1',\n\t\t\t\ttransform: 'translate(0, 0)'\n\t\t\t};\n\n\t\t\tswitch ( type ) {\n\t\t\t\tcase 'fade':\n\t\t\t\t\tstyles.opacity = progress.toFixed( 3 );\n\t\t\t\t\tstyles.transform = 'translate(0, 0)';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'up': // Enter from bottom\n\t\t\t\t\tstyles.transform = `translateY(${ ( 1 - progress ) * 100 }%)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'down': // Enter from top\n\t\t\t\t\tstyles.transform = `translateY(${ ( 1 - progress ) * -100 }%)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'left': // Enter from right\n\t\t\t\t\tstyles.transform = `translateX(${ ( 1 - progress ) * 100 }%)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'right': // Enter from left\n\t\t\t\t\tstyles.transform = `translateX(${ ( 1 - progress ) * -100 }%)`;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: // None or unknown\n\t\t\t\t\tstyles.opacity = progress >= 0.5 ? '1' : '0';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn styles;\n\t\t}\n\n\t\t/**\n\t\t * Update active frame based on scroll position\n\t\t */\n\t\tfunction updateActiveFrame() {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tconst blockTop = blockRect.top;\n\t\t\tconst blockHeight = block.offsetHeight;\n\n\t\t\t// Calculate scroll progress through the block\n\t\t\tconst scrollableDistance = blockHeight - viewportHeight;\n\t\t\t\n\t\t\tif ( scrollableDistance <= 0 ) {\n\t\t\t\tticking = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// How far we've scrolled into the block\n\t\t\tconst scrolledDistance = Math.max( 0, -blockTop );\n\t\t\t// 0.0 to 1.0\n\t\t\tconst scrollProgress = Math.min( 1, scrolledDistance / scrollableDistance );\n\n\t\t\t// Map 0..1 to 0..(Frames-1)\n\t\t\tconst totalTransitions = frameCount - 1;\n\t\t\t// Ensure we don't go out of bounds\n\t\t\tconst virtualScroll = Math.min( totalTransitions, scrollProgress * totalTransitions );\n\t\t\t\n\t\t\t// Determine which frames are involved\n\t\t\tconst currentIndex = Math.floor( virtualScroll );\n\t\t\tconst nextIndex = Math.min( frameCount - 1, currentIndex + 1 );\n\t\t\tconst localProgress = virtualScroll - currentIndex;\n\n\t\t\t// Update all frames\n\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\t// Kill CSS transitions so we can scrub manually\n\t\t\t\tframe.style.transitionDuration = '0ms';\n\n\t\t\t\tif ( index === currentIndex ) {\n\t\t\t\t\t// This is the \"bottom\" frame of the current stack\n\t\t\t\t\t// It stays static and fully visible behind the entering frame\n\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t\tframe.style.opacity = '1';\n\t\t\t\t\tframe.style.transform = 'translate(0, 0)';\n\t\t\t\t\tframe.style.zIndex = '1';\n\t\t\t\t} else if ( index === nextIndex && nextIndex !== currentIndex ) {\n\t\t\t\t\t// This is the \"top\" frame entering the stack\n\t\t\t\t\tconst type = frame.dataset.transitionType || 'fade';\n\t\t\t\t\tconst styles = getTransitionStyles( type, localProgress );\n\t\t\t\t\t\n\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t\tframe.style.opacity = styles.opacity;\n\t\t\t\t\tframe.style.transform = styles.transform;\n\t\t\t\t\tframe.style.zIndex = '2';\n\t\t\t\t} else {\n\t\t\t\t\t// Frames not involved in the current transition pair\n\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t\tframe.style.opacity = '0';\n\t\t\t\t\tframe.style.zIndex = '0';\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tticking = false;\n\t\t}\n\n\t\t/**\n\t\t * Handle scroll events with requestAnimationFrame throttling\n\t\t */\n\t\tfunction onScroll() {\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateActiveFrame );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t// Add scroll listener\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\n\t\t// Initial state\n\t\tupdateActiveFrame();\n\n\t\t// Store cleanup function on element\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t};\n\t}\n\n\t/**\n\t * Initialize all Reveal blocks on the page\n\t */\n\tfunction initAllBlocks() {\n\t\tconst blocks = document.querySelectorAll( '.caes-reveal' );\n\t\tblocks.forEach( initRevealBlock );\n\t}\n\n\t// Initialize on DOM ready\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","frames","querySelectorAll","length","frameCount","ticking","getTransitionStyles","type","progress","styles","opacity","transform","toFixed","updateActiveFrame","blockRect","getBoundingClientRect","viewportHeight","innerHeight","blockTop","top","blockHeight","offsetHeight","scrollableDistance","scrolledDistance","Math","max","scrollProgress","min","totalTransitions","virtualScroll","currentIndex","floor","nextIndex","localProgress","forEach","frame","index","style","transitionDuration","classList","add","zIndex","dataset","transitionType","remove","onScroll","requestAnimationFrame","addEventListener","passive","_revealCleanup","removeEventListener","initAllBlocks","blocks","document","readyState"],"sourceRoot":""}