{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript\n *\n * Handles scroll-triggered frame transitions and frame-specific content visibility.\n */\n\n( function () {\n\t'use strict';\n\n\tconst prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n\tfunction initRevealBlock( block ) {\n\t\tconst frames = block.querySelectorAll( '.reveal-frame' );\n\t\tconst frameContents = block.querySelectorAll( '.reveal-frame-content' );\n\n\t\tif ( frames.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst frameCount = frames.length;\n\t\tlet ticking = false;\n\t\tlet currentActiveIndex = 0;\n\n\t\t// Build frame weights based on transition speed\n\t\t// slow = 1.5x scroll distance, normal = 1x, fast = 0.5x\n\t\tconst speedMultipliers = { slow: 1.5, normal: 1, fast: 0.5 };\n\t\tconst frameWeights = [];\n\t\tlet totalWeight = 0;\n\n\t\tframes.forEach( ( frame, index ) => {\n\t\t\tif ( index === 0 ) {\n\t\t\t\t// First frame has no incoming transition\n\t\t\t\tframeWeights.push( 0 );\n\t\t\t} else {\n\t\t\t\tconst speed = frame.dataset.transitionSpeed || 'normal';\n\t\t\t\tconst weight = speedMultipliers[ speed ] || 1;\n\t\t\t\tframeWeights.push( weight );\n\t\t\t\ttotalWeight += weight;\n\t\t\t}\n\t\t} );\n\n\t\t// Calculate cumulative positions (0 to 1) for each frame transition\n\t\tconst framePositions = [ 0 ]; // First frame starts at 0\n\t\tlet cumulative = 0;\n\t\tfor ( let i = 1; i < frameCount; i++ ) {\n\t\t\tcumulative += frameWeights[ i ] / totalWeight;\n\t\t\tframePositions.push( cumulative );\n\t\t}\n\n\t\t/**\n\t\t * Get transition styles for the incoming frame.\n\t\t * \n\t\t * For wipe transitions, we use clip-path: inset() to reveal the image.\n\t\t * The image stays stationary; only the clipping boundary moves.\n\t\t * \n\t\t * clip-path: inset(top right bottom left)\n\t\t * - 'up' wipe: reveals from bottom to top, so we clip from top\n\t\t * - 'down' wipe: reveals from top to bottom, so we clip from bottom\n\t\t * - 'left' wipe: reveals from right to left, so we clip from left\n\t\t * - 'right' wipe: reveals from left to right, so we clip from right\n\t\t */\n\t\tfunction getTransitionStyles( type, progress ) {\n\t\t\tif ( prefersReducedMotion ) {\n\t\t\t\ttype = 'fade';\n\t\t\t}\n\n\t\t\t// Default: fully visible, no clipping\n\t\t\tlet styles = {\n\t\t\t\topacity: '1',\n\t\t\t\tclipPath: 'inset(0 0 0 0)'\n\t\t\t};\n\n\t\t\t// Calculate the remaining amount to clip (inverse of progress)\n\t\t\tconst clipAmount = ( ( 1 - progress ) * 100 ).toFixed( 2 );\n\n\t\t\tswitch ( type ) {\n\t\t\t\tcase 'fade':\n\t\t\t\t\tstyles.opacity = progress.toFixed( 3 );\n\t\t\t\t\tstyles.clipPath = 'none';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'up':\n\t\t\t\t\t// Wipe upward: reveal from bottom, clip from top\n\t\t\t\t\tstyles.clipPath = `inset(${ clipAmount }% 0 0 0)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'down':\n\t\t\t\t\t// Wipe downward: reveal from top, clip from bottom\n\t\t\t\t\tstyles.clipPath = `inset(0 0 ${ clipAmount }% 0)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'left':\n\t\t\t\t\t// Wipe leftward: reveal from right, clip from left\n\t\t\t\t\tstyles.clipPath = `inset(0 0 0 ${ clipAmount }%)`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'right':\n\t\t\t\t\t// Wipe rightward: reveal from left, clip from right\n\t\t\t\t\tstyles.clipPath = `inset(0 ${ clipAmount }% 0 0)`;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t// 'none' or unknown: hard cut at 50%\n\t\t\t\t\tstyles.opacity = progress >= 0.5 ? '1' : '0';\n\t\t\t\t\tstyles.clipPath = 'none';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn styles;\n\t\t}\n\n\t\t/**\n\t\t * Update frame content visibility with smooth transitions\n\t\t */\n\t\tfunction updateFrameContentVisibility( targetIndex ) {\n\t\t\tif ( targetIndex === currentActiveIndex ) {\n\t\t\t\treturn; // No change needed\n\t\t\t}\n\n\t\t\tframeContents.forEach( ( content ) => {\n\t\t\t\tconst contentIndex = parseInt( content.dataset.frameIndex, 10 );\n\t\t\t\t\n\t\t\t\tif ( contentIndex === targetIndex ) {\n\t\t\t\t\t// Show this content\n\t\t\t\t\tcontent.style.opacity = '1';\n\t\t\t\t\tcontent.style.pointerEvents = 'auto';\n\t\t\t\t\tcontent.setAttribute( 'aria-hidden', 'false' );\n\t\t\t\t} else {\n\t\t\t\t\t// Hide this content\n\t\t\t\t\tcontent.style.opacity = '0';\n\t\t\t\t\tcontent.style.pointerEvents = 'none';\n\t\t\t\t\tcontent.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tcurrentActiveIndex = targetIndex;\n\t\t}\n\n\t\tfunction updateActiveFrame() {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\t// Strategy: \n\t\t\t// - Find which content block is currently in view\n\t\t\t// - That determines which background is shown\n\t\t\t// - Transition to next background happens AFTER content scrolls off top\n\n\t\t\tlet activeFrameIndex = 0;\n\t\t\tlet transitionProgress = 0;\n\t\t\tlet transitioningToIndex = -1;\n\n\t\t\t// Check each content block's position\n\t\t\tfor ( let i = 0; i < frameContents.length; i++ ) {\n\t\t\t\tconst content = frameContents[ i ];\n\t\t\t\tconst rect = content.getBoundingClientRect();\n\n\t\t\t\t// If this content is visible or hasn't scrolled off yet, this is our active frame\n\t\t\t\tif ( rect.bottom > 0 ) {\n\t\t\t\t\tactiveFrameIndex = i;\n\n\t\t\t\t\t// Check if content is scrolling off the top and we should transition\n\t\t\t\t\t// Transition zone: from when content bottom hits viewport center to when it exits\n\t\t\t\t\tif ( rect.bottom < viewportHeight * 0.5 && i < frameContents.length - 1 ) {\n\t\t\t\t\t\t// Calculate progress: 0 when bottom is at 50vh, 1 when bottom reaches 0\n\t\t\t\t\t\tconst transitionZone = viewportHeight * 0.5;\n\t\t\t\t\t\ttransitionProgress = 1 - ( rect.bottom / transitionZone );\n\t\t\t\t\t\ttransitionProgress = Math.max( 0, Math.min( 1, transitionProgress ) );\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Apply speed multiplier\n\t\t\t\t\t\tconst nextFrame = frames[ i + 1 ];\n\t\t\t\t\t\tif ( nextFrame ) {\n\t\t\t\t\t\t\tconst speed = nextFrame.dataset.transitionSpeed || 'normal';\n\t\t\t\t\t\t\tconst speedMultiplier = { slow: 0.5, normal: 1, fast: 2 }[ speed ] || 1;\n\t\t\t\t\t\t\ttransitionProgress = Math.pow( transitionProgress, 1 / speedMultiplier );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\ttransitioningToIndex = i + 1;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If all content has scrolled off, show last frame\n\t\t\tif ( activeFrameIndex === 0 && frameContents.length > 0 ) {\n\t\t\t\tconst firstRect = frameContents[ 0 ].getBoundingClientRect();\n\t\t\t\tif ( firstRect.bottom <= 0 ) {\n\t\t\t\t\tactiveFrameIndex = frameContents.length - 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Clamp to valid frame range\n\t\t\tactiveFrameIndex = Math.max( 0, Math.min( frameCount - 1, activeFrameIndex ) );\n\n\t\t\t// Update background frames\n\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\t// Kill CSS transitions to allow manual scrubbing\n\t\t\t\tframe.style.transitionDuration = '0ms';\n\n\t\t\t\tif ( index === activeFrameIndex ) {\n\t\t\t\t\t// Current base frame - fully visible\n\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t\tframe.style.opacity = '1';\n\t\t\t\t\tframe.style.clipPath = 'none';\n\t\t\t\t\tframe.style.zIndex = '1';\n\t\t\t\t} else if ( index === transitioningToIndex && transitionProgress > 0 ) {\n\t\t\t\t\t// Incoming frame - apply wipe/fade transition\n\t\t\t\t\tconst type = frame.dataset.transitionType || 'fade';\n\t\t\t\t\tconst styles = getTransitionStyles( type, transitionProgress );\n\t\t\t\t\t\n\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t\tframe.style.opacity = styles.opacity;\n\t\t\t\t\tframe.style.clipPath = styles.clipPath;\n\t\t\t\t\tframe.style.zIndex = '2';\n\t\t\t\t} else {\n\t\t\t\t\t// Inactive frames - hidden\n\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t\tframe.style.opacity = '0';\n\t\t\t\t\tframe.style.clipPath = 'inset(0 0 0 0)';\n\t\t\t\t\tframe.style.zIndex = '0';\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Update content visibility - show content for active frame\n\t\t\tconst targetContentIndex = transitionProgress > 0.8 ? transitioningToIndex : activeFrameIndex;\n\t\t\tupdateFrameContentVisibility( Math.max( 0, targetContentIndex ) );\n\n\t\t\tticking = false;\n\t\t}\n\n\t\tfunction onScroll() {\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateActiveFrame );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t// Initialize frame content visibility\n\t\tframeContents.forEach( ( content, index ) => {\n\t\t\tcontent.style.transition = 'opacity 0.3s ease';\n\t\t\tif ( index === 0 ) {\n\t\t\t\tcontent.style.opacity = '1';\n\t\t\t\tcontent.style.pointerEvents = 'auto';\n\t\t\t\tcontent.setAttribute( 'aria-hidden', 'false' );\n\t\t\t} else {\n\t\t\t\tcontent.style.opacity = '0';\n\t\t\t\tcontent.style.pointerEvents = 'none';\n\t\t\t\tcontent.setAttribute( 'aria-hidden', 'true' );\n\t\t\t}\n\t\t} );\n\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\t\twindow.addEventListener( 'resize', updateActiveFrame );\n\n\t\t// Run immediately to set initial state\n\t\tupdateActiveFrame();\n\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t\twindow.removeEventListener( 'resize', updateActiveFrame );\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tconst blocks = document.querySelectorAll( '.caes-reveal' );\n\t\tblocks.forEach( initRevealBlock );\n\t}\n\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","frames","querySelectorAll","frameContents","length","frameCount","ticking","currentActiveIndex","speedMultipliers","slow","normal","fast","frameWeights","totalWeight","forEach","frame","index","push","speed","dataset","transitionSpeed","weight","framePositions","cumulative","i","getTransitionStyles","type","progress","styles","opacity","clipPath","clipAmount","toFixed","updateFrameContentVisibility","targetIndex","content","contentIndex","parseInt","frameIndex","style","pointerEvents","setAttribute","updateActiveFrame","viewportHeight","innerHeight","activeFrameIndex","transitionProgress","transitioningToIndex","rect","getBoundingClientRect","bottom","transitionZone","Math","max","min","nextFrame","speedMultiplier","pow","firstRect","transitionDuration","classList","add","zIndex","transitionType","remove","targetContentIndex","onScroll","requestAnimationFrame","transition","addEventListener","passive","_revealCleanup","removeEventListener","initAllBlocks","blocks","document","readyState"],"sourceRoot":""}