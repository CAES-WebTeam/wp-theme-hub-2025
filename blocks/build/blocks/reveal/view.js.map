{"version":3,"file":"blocks/reveal/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript\n * \n * Improved to more closely match Shorthand's behavior:\n * - Content starts completely hidden (opacity: 0)\n * - Content fades in AFTER the background is fully visible\n * - Content fades out BEFORE the next background transitions in\n * - Background transitions use clip-path for wipes\n * - Transition percentages match Shorthand's 0.35 (35%) pattern\n */\n\n( function () {\n\t'use strict';\n\n\tconst prefersReducedMotion = window.matchMedia( '(prefers-reduced-motion: reduce)' ).matches;\n\n\tfunction initRevealBlock( block ) {\n\t\tconst frames = block.querySelectorAll( '.reveal-frame' );\n\t\tconst frameContents = block.querySelectorAll( '.reveal-frame-content' );\n\n\t\tif ( frames.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst frameCount = frames.length;\n\t\tlet ticking = false;\n\n\t\t// Parse transition data from frames\n\t\t// Shorthand uses format: \"0.35 fade;0.35 up\" where 0.35 is the transition percentage\n\t\tconst transitions = [];\n\t\tframes.forEach( ( frame, index ) => {\n\t\t\tconst speed = frame.dataset.transitionSpeed || 'normal';\n\t\t\ttransitions.push( {\n\t\t\t\ttype: frame.dataset.transitionType || 'fade',\n\t\t\t\tspeed: speed,\n\t\t\t\t// Convert speed to percentage (like Shorthand's 0.35)\n\t\t\t\tpercentage: getTransitionPercentage( speed )\n\t\t\t} );\n\t\t} );\n\n\t\t/**\n\t\t * Get transition percentage based on speed setting\n\t\t * Shorthand uses 0.35 (35%) as default\n\t\t */\n\t\tfunction getTransitionPercentage( speed ) {\n\t\t\tswitch ( speed ) {\n\t\t\t\tcase 'slow': return 0.45;\n\t\t\t\tcase 'fast': return 0.20;\n\t\t\t\tcase 'normal':\n\t\t\t\tdefault: return 0.35;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Get clip-path style for wipe transitions\n\t\t */\n\t\tfunction getTransitionStyles( type, progress ) {\n\t\t\tif ( prefersReducedMotion ) {\n\t\t\t\ttype = 'fade';\n\t\t\t}\n\n\t\t\tconst clipAmount = ( ( 1 - progress ) * 100 ).toFixed( 2 );\n\n\t\t\tswitch ( type ) {\n\t\t\t\tcase 'fade':\n\t\t\t\t\treturn { opacity: progress, clipPath: 'none' };\n\t\t\t\tcase 'up':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(${ clipAmount }% 0 0 0)` };\n\t\t\t\tcase 'down':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(0 0 ${ clipAmount }% 0)` };\n\t\t\t\tcase 'left':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(0 0 0 ${ clipAmount }%)` };\n\t\t\t\tcase 'right':\n\t\t\t\t\treturn { opacity: 1, clipPath: `inset(0 ${ clipAmount }% 0 0)` };\n\t\t\t\tdefault:\n\t\t\t\t\treturn { opacity: progress >= 0.5 ? 1 : 0, clipPath: 'none' };\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Calculate content opacity based on scroll position within frame segment\n\t\t * Content fades in after background, fades out before next transition\n\t\t */\n\t\tfunction getContentOpacity( scrollProgress, segmentStart, segmentEnd, transitionPercentage ) {\n\t\t\tconst segmentLength = segmentEnd - segmentStart;\n\t\t\t\n\t\t\t// Content fade-in starts slightly after segment starts (10% into segment)\n\t\t\tconst fadeInStart = segmentStart + ( segmentLength * 0.05 );\n\t\t\tconst fadeInEnd = segmentStart + ( segmentLength * 0.20 );\n\t\t\t\n\t\t\t// Content fade-out ends when background transition starts\n\t\t\tconst fadeOutStart = segmentEnd - ( segmentLength * transitionPercentage ) - ( segmentLength * 0.05 );\n\t\t\tconst fadeOutEnd = segmentEnd - ( segmentLength * transitionPercentage );\n\n\t\t\tif ( scrollProgress < fadeInStart ) {\n\t\t\t\treturn 0;\n\t\t\t} else if ( scrollProgress < fadeInEnd ) {\n\t\t\t\t// Fading in\n\t\t\t\treturn ( scrollProgress - fadeInStart ) / ( fadeInEnd - fadeInStart );\n\t\t\t} else if ( scrollProgress < fadeOutStart ) {\n\t\t\t\t// Fully visible\n\t\t\t\treturn 1;\n\t\t\t} else if ( scrollProgress < fadeOutEnd ) {\n\t\t\t\t// Fading out\n\t\t\t\treturn 1 - ( ( scrollProgress - fadeOutStart ) / ( fadeOutEnd - fadeOutStart ) );\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Main scroll handler\n\t\t */\n\t\tfunction updateOnScroll() {\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tconst blockHeight = block.offsetHeight;\n\n\t\t\t// Calculate scroll progress through the block (0 to 1)\n\t\t\t// Progress = 0 when block top is at viewport bottom\n\t\t\t// Progress = 1 when block bottom is at viewport top\n\t\t\tconst scrollableDistance = blockHeight - viewportHeight;\n\t\t\tconst scrolledDistance = Math.max( 0, -blockRect.top );\n\t\t\tconst scrollProgress = scrollableDistance > 0 \n\t\t\t\t? Math.min( 1, scrolledDistance / scrollableDistance ) \n\t\t\t\t: 0;\n\n\t\t\t// Calculate segment boundaries for each frame\n\t\t\tconst segmentSize = 1 / frameCount;\n\n\t\t\t// Process each frame\n\t\t\tframes.forEach( ( frame, index ) => {\n\t\t\t\tconst segmentStart = index * segmentSize;\n\t\t\t\tconst segmentEnd = ( index + 1 ) * segmentSize;\n\t\t\t\tconst transitionPct = transitions[ index ].percentage;\n\t\t\t\tconst transitionStart = segmentEnd - ( segmentSize * transitionPct );\n\t\t\t\tconst isFirstFrame = index === 0;\n\t\t\t\tconst isLastFrame = index === frameCount - 1;\n\n\t\t\t\t// Disable CSS transitions - we're controlling everything via JS\n\t\t\t\tframe.style.transitionDuration = '0ms';\n\n\t\t\t\t// Determine background state\n\t\t\t\tlet bgOpacity = 0;\n\t\t\t\tlet bgClipPath = 'inset(100% 0 0 0)'; // Start fully clipped\n\t\t\t\tlet bgZIndex = 0;\n\t\t\t\tlet bgDisplay = 'none';\n\n\t\t\t\tif ( isFirstFrame ) {\n\t\t\t\t\t// First frame: visible from start, no transition in\n\t\t\t\t\tif ( scrollProgress < transitionStart ) {\n\t\t\t\t\t\tbgOpacity = 1;\n\t\t\t\t\t\tbgClipPath = 'none';\n\t\t\t\t\t\tbgZIndex = 1;\n\t\t\t\t\t\tbgDisplay = 'block';\n\t\t\t\t\t} else if ( scrollProgress < segmentEnd ) {\n\t\t\t\t\t\t// Transitioning out (next frame coming in)\n\t\t\t\t\t\tbgOpacity = 1;\n\t\t\t\t\t\tbgClipPath = 'none';\n\t\t\t\t\t\tbgZIndex = 1;\n\t\t\t\t\t\tbgDisplay = 'block';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Completely past this frame\n\t\t\t\t\t\tbgOpacity = 0;\n\t\t\t\t\t\tbgDisplay = 'none';\n\t\t\t\t\t\tbgZIndex = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Subsequent frames: transition in during previous frame's transition period\n\t\t\t\t\tconst prevSegmentEnd = segmentStart;\n\t\t\t\t\tconst prevTransitionPct = transitions[ index ].percentage;\n\t\t\t\t\tconst incomingTransitionStart = prevSegmentEnd - ( segmentSize * prevTransitionPct );\n\n\t\t\t\t\tif ( scrollProgress < incomingTransitionStart ) {\n\t\t\t\t\t\t// Before this frame's transition starts\n\t\t\t\t\t\tbgOpacity = 0;\n\t\t\t\t\t\tbgDisplay = 'none';\n\t\t\t\t\t\tbgZIndex = 0;\n\t\t\t\t\t} else if ( scrollProgress < prevSegmentEnd ) {\n\t\t\t\t\t\t// This frame is transitioning IN\n\t\t\t\t\t\tconst transitionProgress = ( scrollProgress - incomingTransitionStart ) / ( prevSegmentEnd - incomingTransitionStart );\n\t\t\t\t\t\tconst styles = getTransitionStyles( transitions[ index ].type, transitionProgress );\n\t\t\t\t\t\tbgOpacity = styles.opacity;\n\t\t\t\t\t\tbgClipPath = styles.clipPath;\n\t\t\t\t\t\tbgZIndex = 2; // On top during transition\n\t\t\t\t\t\tbgDisplay = 'block';\n\t\t\t\t\t} else if ( scrollProgress < transitionStart || isLastFrame ) {\n\t\t\t\t\t\t// Fully visible\n\t\t\t\t\t\tbgOpacity = 1;\n\t\t\t\t\t\tbgClipPath = 'none';\n\t\t\t\t\t\tbgZIndex = 1;\n\t\t\t\t\t\tbgDisplay = 'block';\n\t\t\t\t\t} else if ( scrollProgress < segmentEnd && !isLastFrame ) {\n\t\t\t\t\t\t// Transitioning out (stays as base layer)\n\t\t\t\t\t\tbgOpacity = 1;\n\t\t\t\t\t\tbgClipPath = 'none';\n\t\t\t\t\t\tbgZIndex = 1;\n\t\t\t\t\t\tbgDisplay = 'block';\n\t\t\t\t\t} else if ( !isLastFrame ) {\n\t\t\t\t\t\t// Completely past this frame\n\t\t\t\t\t\tbgOpacity = 0;\n\t\t\t\t\t\tbgDisplay = 'none';\n\t\t\t\t\t\tbgZIndex = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Apply background styles\n\t\t\t\tframe.style.opacity = bgOpacity;\n\t\t\t\tframe.style.clipPath = bgClipPath;\n\t\t\t\tframe.style.zIndex = bgZIndex;\n\t\t\t\tframe.style.display = bgDisplay;\n\n\t\t\t\tif ( bgDisplay === 'block' && bgOpacity > 0.5 ) {\n\t\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t\t} else {\n\t\t\t\t\tframe.classList.remove( 'is-active' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Handle content opacity separately\n\t\t\tframeContents.forEach( ( content, index ) => {\n\t\t\t\tconst segmentStart = index * segmentSize;\n\t\t\t\tconst segmentEnd = ( index + 1 ) * segmentSize;\n\t\t\t\tconst isLastFrame = index === frameCount - 1;\n\t\t\t\t\n\t\t\t\t// Get next frame's transition percentage for fade-out timing\n\t\t\t\tconst nextTransitionPct = transitions[ index + 1 ]?.percentage || transitions[ index ].percentage;\n\n\t\t\t\tlet opacity;\n\t\t\t\t\n\t\t\t\tif ( isLastFrame ) {\n\t\t\t\t\t// Last frame: fade in but don't fade out\n\t\t\t\t\tconst fadeInStart = segmentStart + ( segmentSize * 0.05 );\n\t\t\t\t\tconst fadeInEnd = segmentStart + ( segmentSize * 0.20 );\n\t\t\t\t\t\n\t\t\t\t\tif ( scrollProgress < fadeInStart ) {\n\t\t\t\t\t\topacity = 0;\n\t\t\t\t\t} else if ( scrollProgress < fadeInEnd ) {\n\t\t\t\t\t\topacity = ( scrollProgress - fadeInStart ) / ( fadeInEnd - fadeInStart );\n\t\t\t\t\t} else {\n\t\t\t\t\t\topacity = 1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\topacity = getContentOpacity( scrollProgress, segmentStart, segmentEnd, nextTransitionPct );\n\t\t\t\t}\n\n\t\t\t\t// Apply content styles\n\t\t\t\tcontent.style.opacity = opacity;\n\t\t\t\tcontent.style.pointerEvents = opacity > 0.5 ? 'auto' : 'none';\n\t\t\t} );\n\n\t\t\tticking = false;\n\t\t}\n\n\t\tfunction onScroll() {\n\t\t\tif ( ! ticking ) {\n\t\t\t\twindow.requestAnimationFrame( updateOnScroll );\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\t// Initialize: all content starts hidden\n\t\tframeContents.forEach( ( content ) => {\n\t\t\tcontent.style.transition = 'none';\n\t\t\tcontent.style.opacity = '0';\n\t\t} );\n\n\t\t// All frames start hidden except the first\n\t\tframes.forEach( ( frame, index ) => {\n\t\t\tframe.style.transition = 'none';\n\t\t\tif ( index === 0 ) {\n\t\t\t\tframe.style.opacity = '1';\n\t\t\t\tframe.style.clipPath = 'none';\n\t\t\t\tframe.style.display = 'block';\n\t\t\t\tframe.style.zIndex = '1';\n\t\t\t\tframe.classList.add( 'is-active' );\n\t\t\t} else {\n\t\t\t\tframe.style.opacity = '0';\n\t\t\t\tframe.style.display = 'none';\n\t\t\t\tframe.style.zIndex = '0';\n\t\t\t}\n\t\t} );\n\n\t\t// Set up scroll listener\n\t\twindow.addEventListener( 'scroll', onScroll, { passive: true } );\n\t\twindow.addEventListener( 'resize', updateOnScroll );\n\t\t\n\t\t// Initial update\n\t\tupdateOnScroll();\n\n\t\t// Cleanup function for WordPress block editor\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener( 'scroll', onScroll );\n\t\t\twindow.removeEventListener( 'resize', updateOnScroll );\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll( '.caes-reveal' ).forEach( initRevealBlock );\n\t}\n\n\tif ( document.readyState === 'loading' ) {\n\t\tdocument.addEventListener( 'DOMContentLoaded', initAllBlocks );\n\t} else {\n\t\tinitAllBlocks();\n\t}\n} )();"],"names":["prefersReducedMotion","window","matchMedia","matches","initRevealBlock","block","frames","querySelectorAll","frameContents","length","frameCount","ticking","transitions","forEach","frame","index","speed","dataset","transitionSpeed","push","type","transitionType","percentage","getTransitionPercentage","getTransitionStyles","progress","clipAmount","toFixed","opacity","clipPath","getContentOpacity","scrollProgress","segmentStart","segmentEnd","transitionPercentage","segmentLength","fadeInStart","fadeInEnd","fadeOutStart","fadeOutEnd","updateOnScroll","blockRect","getBoundingClientRect","viewportHeight","innerHeight","blockHeight","offsetHeight","scrollableDistance","scrolledDistance","Math","max","top","min","segmentSize","transitionPct","transitionStart","isFirstFrame","isLastFrame","style","transitionDuration","bgOpacity","bgClipPath","bgZIndex","bgDisplay","prevSegmentEnd","prevTransitionPct","incomingTransitionStart","transitionProgress","styles","zIndex","display","classList","add","remove","content","nextTransitionPct","pointerEvents","onScroll","requestAnimationFrame","transition","addEventListener","passive","_revealCleanup","removeEventListener","initAllBlocks","document","readyState"],"sourceRoot":""}