{"version":3,"file":"blocks/reveal/view.js","mappings":";;;;AAAA;AACA;AACA;;AAEA,CAAC,YAAY;EACZ,YAAY;;EAEZ,SAASA,eAAeA,CAACC,KAAK,EAAE;IAC/B,MAAMC,QAAQ,GAAGD,KAAK,CAACE,gBAAgB,CAAC,uBAAuB,CAAC;IAChE,MAAMC,WAAW,GAAGH,KAAK,CAACE,gBAAgB,CAAC,0BAA0B,CAAC;IACtE,MAAME,QAAQ,GAAGJ,KAAK,CAACE,gBAAgB,CAAC,uBAAuB,CAAC;IAEhE,IAAID,QAAQ,CAACI,MAAM,KAAK,CAAC,EAAE;MAC1B;IACD;IAEA,IAAIC,OAAO,GAAG,KAAK;;IAEnB;AACF;AACA;IACE,SAASC,iBAAiBA,CAAA,EAAG;MAC5B,MAAMC,cAAc,GAAGC,MAAM,CAACC,WAAW;MAEzCT,QAAQ,CAACU,OAAO,CAAC,CAACC,OAAO,EAAEC,KAAK,KAAK;QACpC,MAAMC,OAAO,GAAGF,OAAO,CAACG,aAAa,CAAC,uBAAuB,CAAC;QAC9D,MAAMC,EAAE,GAAGJ,OAAO,CAACG,aAAa,CAAC,0BAA0B,CAAC;QAC5D,IAAI,CAACD,OAAO,EAAE;QAEd,MAAMG,eAAe,GAAGH,OAAO,CAACI,QAAQ;QACxC,IAAIC,aAAa,GAAG,CAAC;QAErB,KAAK,IAAIC,KAAK,IAAIH,eAAe,EAAE;UAClCE,aAAa,IAAIC,KAAK,CAACC,YAAY;UACnC,MAAMC,KAAK,GAAGb,MAAM,CAACc,gBAAgB,CAACH,KAAK,CAAC;UAC5CD,aAAa,IAAIK,QAAQ,CAACF,KAAK,CAACG,SAAS,CAAC,GAAGD,QAAQ,CAACF,KAAK,CAACI,YAAY,CAAC;QAC1E;QAEAP,aAAa,GAAGQ,IAAI,CAACC,GAAG,CAACT,aAAa,EAAE,GAAG,CAAC;;QAE5C;QACA,MAAMU,KAAK,GAAGb,EAAE,CAACc,YAAY,CAAC,YAAY,CAAC,IAAI,QAAQ;QACvD,IAAIC,kBAAkB;QACtB,IAAIF,KAAK,KAAK,MAAM,EAAE;UACrBE,kBAAkB,GAAG,GAAG,GAAGvB,cAAc;QAC1C,CAAC,MAAM,IAAIqB,KAAK,KAAK,MAAM,EAAE;UAC5BE,kBAAkB,GAAG,GAAG,GAAGvB,cAAc;QAC1C,CAAC,MAAM;UACNuB,kBAAkB,GAAG,GAAG,GAAGvB,cAAc;QAC1C;;QAEA;QACA;QACA,IAAIK,KAAK,KAAKZ,QAAQ,CAACI,MAAM,GAAG,CAAC,EAAE;UAClCO,OAAO,CAACU,KAAK,CAACU,MAAM,GAAIxB,cAAc,GAAG,CAAC,GAAGW,aAAa,GAAI,IAAI;QACnE,CAAC,MAAM;UACNP,OAAO,CAACU,KAAK,CAACU,MAAM,GAAIxB,cAAc,GAAG,CAAC,GAAGW,aAAa,GAAGY,kBAAkB,GAAI,IAAI;QACxF;MACD,CAAC,CAAC;IACH;;IAEA;AACF;AACA;IACE,SAASE,cAAcA,CAAA,EAAG;MACzB,MAAMC,SAAS,GAAGzB,MAAM,CAAC0B,WAAW,IAAIC,QAAQ,CAACC,eAAe,CAACH,SAAS;MAC1E,MAAM1B,cAAc,GAAGC,MAAM,CAACC,WAAW;MACzC,MAAM4B,SAAS,GAAGtC,KAAK,CAACuC,qBAAqB,CAAC,CAAC;MAC/C,MAAMC,QAAQ,GAAGN,SAAS,GAAGI,SAAS,CAACG,GAAG;MAC1C,MAAMC,WAAW,GAAGF,QAAQ,GAAGxC,KAAK,CAACqB,YAAY;;MAEjD;MACA,MAAMsB,OAAO,GAAGL,SAAS,CAACG,GAAG,IAAI,CAAC,IAAIH,SAAS,CAACM,MAAM,GAAGpC,cAAc;;MAEvE;MACA,IAAImC,OAAO,EAAE;QACZ3C,KAAK,CAAC6C,SAAS,CAACC,GAAG,CAAC,UAAU,CAAC;MAChC,CAAC,MAAM;QACN9C,KAAK,CAAC6C,SAAS,CAACE,MAAM,CAAC,UAAU,CAAC;MACnC;;MAEA;MACA,MAAMC,OAAO,GAAGd,SAAS,IAAIM,QAAQ,IAAIN,SAAS,IAAIQ,WAAW;MAEjE,IAAI,CAACM,OAAO,IAAI,CAACL,OAAO,EAAE;QACzB;QACAxC,WAAW,CAACQ,OAAO,CAAC,CAACK,EAAE,EAAEH,KAAK,KAAK;UAClC,IAAIA,KAAK,KAAK,CAAC,EAAE;YAChBG,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;YACpBjC,EAAE,CAACM,KAAK,CAAC4B,MAAM,GAAG,EAAE;YACpBlC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,MAAM;UAC5B,CAAC,MAAM;YACNnC,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;YACpBjC,EAAE,CAACM,KAAK,CAAC4B,MAAM,GAAG,CAAC;UACpB;QACD,CAAC,CAAC;QACF5C,OAAO,GAAG,KAAK;QACf;MACD;MAEA,IAAI8C,WAAW,GAAG,CAAC,CAAC;MACpB,IAAIC,eAAe,GAAG,CAAC,CAAC;MACxB,IAAIC,kBAAkB,GAAG,CAAC;;MAE1B;MACArD,QAAQ,CAACU,OAAO,CAAC,CAACC,OAAO,EAAEC,KAAK,KAAK;QACpC,MAAM0C,IAAI,GAAG3C,OAAO,CAAC2B,qBAAqB,CAAC,CAAC;QAC5C,MAAMiB,UAAU,GAAGtB,SAAS,GAAGqB,IAAI,CAACd,GAAG;QACvC,MAAMgB,aAAa,GAAGD,UAAU,GAAG5C,OAAO,CAACS,YAAY;QACvD,MAAMP,OAAO,GAAGF,OAAO,CAACG,aAAa,CAAC,uBAAuB,CAAC;QAC9D,MAAM2C,WAAW,GAAG5C,OAAO,CAACyB,qBAAqB,CAAC,CAAC;;QAEnD;QACA,IAAIL,SAAS,IAAIsB,UAAU,IAAItB,SAAS,GAAGuB,aAAa,EAAE;UACzD;UACA,MAAME,cAAc,GAAGD,WAAW,CAACd,MAAM,GAAGpC,cAAc,GAAG,IAAI,IAAIkD,WAAW,CAACjB,GAAG,GAAGjC,cAAc,GAAG,IAAI;UAE5G,IAAImD,cAAc,EAAE;YACnB;YACAP,WAAW,GAAGvC,KAAK;UACpB,CAAC,MAAM,IAAIA,KAAK,GAAGZ,QAAQ,CAACI,MAAM,GAAG,CAAC,EAAE;YACvC;YACA+C,WAAW,GAAGvC,KAAK;YACnBwC,eAAe,GAAGxC,KAAK,GAAG,CAAC;;YAE3B;YACA,MAAMG,EAAE,GAAGf,QAAQ,CAACoD,eAAe,CAAC,CAACtC,aAAa,CAAC,0BAA0B,CAAC;YAC9E,MAAMc,KAAK,GAAGb,EAAE,CAACc,YAAY,CAAC,YAAY,CAAC,IAAI,QAAQ;YAEvD,IAAIC,kBAAkB;YACtB,IAAIF,KAAK,KAAK,MAAM,EAAE;cACrBE,kBAAkB,GAAG,GAAG,GAAGvB,cAAc;YAC1C,CAAC,MAAM,IAAIqB,KAAK,KAAK,MAAM,EAAE;cAC5BE,kBAAkB,GAAG,GAAG,GAAGvB,cAAc;YAC1C,CAAC,MAAM;cACNuB,kBAAkB,GAAG,GAAG,GAAGvB,cAAc;YAC1C;;YAEA;YACA,MAAMS,eAAe,GAAGH,OAAO,CAACI,QAAQ;YACxC,IAAIC,aAAa,GAAG,CAAC;YACrB,KAAK,IAAIC,KAAK,IAAIH,eAAe,EAAE;cAClCE,aAAa,IAAIC,KAAK,CAACC,YAAY;cACnC,MAAMC,KAAK,GAAGb,MAAM,CAACc,gBAAgB,CAACH,KAAK,CAAC;cAC5CD,aAAa,IAAIK,QAAQ,CAACF,KAAK,CAACG,SAAS,CAAC,GAAGD,QAAQ,CAACF,KAAK,CAACI,YAAY,CAAC;YAC1E;YAEA,MAAMkC,eAAe,GAAGJ,UAAU,GAAI,CAAC,GAAGhD,cAAe,GAAGW,aAAa;YACzE,MAAM0C,sBAAsB,GAAG3B,SAAS,GAAG0B,eAAe;YAC1DN,kBAAkB,GAAGO,sBAAsB,GAAG9B,kBAAkB;YAChEuB,kBAAkB,GAAG3B,IAAI,CAACC,GAAG,CAAC,CAAC,EAAED,IAAI,CAACmC,GAAG,CAAC,CAAC,EAAER,kBAAkB,CAAC,CAAC;UAClE,CAAC,MAAM,IAAIzC,KAAK,KAAKZ,QAAQ,CAACI,MAAM,GAAG,CAAC,EAAE;YACzC;YACA+C,WAAW,GAAGvC,KAAK;UACpB;QACD;MACD,CAAC,CAAC;;MAEF;MACA,IAAIuC,WAAW,KAAK,CAAC,CAAC,EAAE;QACvBA,WAAW,GAAG,CAAC;MAChB;;MAEA;MACAjD,WAAW,CAACQ,OAAO,CAAC,CAACK,EAAE,EAAEH,KAAK,KAAK;QAClC,MAAMkD,cAAc,GAAG/C,EAAE,CAACc,YAAY,CAAC,iBAAiB,CAAC,IAAI,MAAM;QAEnE,IAAIjB,KAAK,KAAKuC,WAAW,IAAIC,eAAe,KAAK,CAAC,CAAC,EAAE;UACpD;UACArC,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;UACpBjC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,MAAM;UAC3BnC,EAAE,CAACM,KAAK,CAAC4B,MAAM,GAAG,EAAE;QACrB,CAAC,MAAM,IAAIrC,KAAK,KAAKuC,WAAW,IAAIC,eAAe,KAAK,CAAC,CAAC,EAAE;UAC3D;UACArC,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;UACpBjC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,MAAM;UAC3BnC,EAAE,CAACM,KAAK,CAAC4B,MAAM,GAAG,CAAC;QACpB,CAAC,MAAM,IAAIrC,KAAK,KAAKwC,eAAe,EAAE;UACrC;UACArC,EAAE,CAACM,KAAK,CAAC4B,MAAM,GAAG,EAAE;UAEpB,IAAIa,cAAc,KAAK,MAAM,EAAE;YAC9B/C,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAGK,kBAAkB;YACrCtC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,MAAM;UAC5B,CAAC,MAAM,IAAIY,cAAc,KAAK,MAAM,EAAE;YACrC,MAAMC,CAAC,GAAG,CAAC,CAAC,GAAGV,kBAAkB,IAAI,GAAG;YACxCtC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,eAAea,CAAC,UAAU;YAC/ChD,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;UACrB,CAAC,MAAM,IAAIc,cAAc,KAAK,OAAO,EAAE;YACtC,MAAMC,CAAC,GAAG,EAAE,CAAC,GAAGV,kBAAkB,CAAC,GAAG,GAAG;YACzCtC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,eAAea,CAAC,UAAU;YAC/ChD,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;UACrB,CAAC,MAAM,IAAIc,cAAc,KAAK,IAAI,EAAE;YACnC,MAAME,CAAC,GAAG,CAAC,CAAC,GAAGX,kBAAkB,IAAI,GAAG;YACxCtC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,kBAAkBc,CAAC,OAAO;YAC/CjD,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;UACrB,CAAC,MAAM;YACNjC,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAGK,kBAAkB;YACrCtC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,MAAM;UAC5B;QACD,CAAC,MAAM;UACN;UACAnC,EAAE,CAACM,KAAK,CAAC2B,OAAO,GAAG,CAAC;UACpBjC,EAAE,CAACM,KAAK,CAAC6B,SAAS,GAAG,MAAM;UAC3BnC,EAAE,CAACM,KAAK,CAAC4B,MAAM,GAAG,CAAC;QACpB;MACD,CAAC,CAAC;MAEF5C,OAAO,GAAG,KAAK;IAChB;IAEA,SAAS4D,QAAQA,CAAA,EAAG;MACnB,IAAI,CAAC5D,OAAO,EAAE;QACbG,MAAM,CAAC0D,qBAAqB,CAAClC,cAAc,CAAC;QAC5C3B,OAAO,GAAG,IAAI;MACf;IACD;IAEA,SAAS8D,QAAQA,CAAA,EAAG;MACnB7D,iBAAiB,CAAC,CAAC;MACnB0B,cAAc,CAAC,CAAC;IACjB;;IAEA;IACA1B,iBAAiB,CAAC,CAAC;;IAEnB;IACAE,MAAM,CAAC4D,gBAAgB,CAAC,QAAQ,EAAEH,QAAQ,EAAE;MAAEI,OAAO,EAAE;IAAK,CAAC,CAAC;IAC9D7D,MAAM,CAAC4D,gBAAgB,CAAC,QAAQ,EAAED,QAAQ,EAAE;MAAEE,OAAO,EAAE;IAAK,CAAC,CAAC;;IAE9D;IACAtE,KAAK,CAACE,gBAAgB,CAAC,KAAK,CAAC,CAACS,OAAO,CAAE4D,GAAG,IAAK;MAC9C,IAAI,CAACA,GAAG,CAACC,QAAQ,EAAE;QAClBD,GAAG,CAACF,gBAAgB,CAAC,MAAM,EAAE,MAAM;UAClC9D,iBAAiB,CAAC,CAAC;UACnB0B,cAAc,CAAC,CAAC;QACjB,CAAC,CAAC;MACH;IACD,CAAC,CAAC;IAEFA,cAAc,CAAC,CAAC;IAEhBjC,KAAK,CAACyE,cAAc,GAAG,YAAY;MAClChE,MAAM,CAACiE,mBAAmB,CAAC,QAAQ,EAAER,QAAQ,CAAC;MAC9CzD,MAAM,CAACiE,mBAAmB,CAAC,QAAQ,EAAEN,QAAQ,CAAC;IAC/C,CAAC;EACF;EAEA,SAASO,aAAaA,CAAA,EAAG;IACxBvC,QAAQ,CAAClC,gBAAgB,CAAC,cAAc,CAAC,CAACS,OAAO,CAACZ,eAAe,CAAC;EACnE;EAEA,IAAIqC,QAAQ,CAACwC,UAAU,KAAK,SAAS,EAAE;IACtCxC,QAAQ,CAACiC,gBAAgB,CAAC,kBAAkB,EAAEM,aAAa,CAAC;EAC7D,CAAC,MAAM;IACNA,aAAa,CAAC,CAAC;EAChB;AACD,CAAC,EAAE,CAAC,C","sources":["webpack://theme-blocks/./src/blocks/reveal/view.js"],"sourcesContent":["/**\n * Reveal Block Frontend JavaScript - Simple Fixed Background Approach\n */\n\n(function () {\n\t'use strict';\n\n\tfunction initRevealBlock(block) {\n\t\tconst sections = block.querySelectorAll('.reveal-frame-section');\n\t\tconst backgrounds = block.querySelectorAll('.reveal-frame-background');\n\t\tconst contents = block.querySelectorAll('.reveal-frame-content');\n\n\t\tif (sections.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet ticking = false;\n\n\t\t/**\n\t\t * Set section heights based on content\n\t\t */\n\t\tfunction setSectionHeights() {\n\t\t\tconst viewportHeight = window.innerHeight;\n\n\t\t\tsections.forEach((section, index) => {\n\t\t\t\tconst content = section.querySelector('.reveal-frame-content');\n\t\t\t\tconst bg = section.querySelector('.reveal-frame-background');\n\t\t\t\tif (!content) return;\n\n\t\t\t\tconst contentChildren = content.children;\n\t\t\t\tlet contentHeight = 0;\n\n\t\t\t\tfor (let child of contentChildren) {\n\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\tconst style = window.getComputedStyle(child);\n\t\t\t\t\tcontentHeight += parseInt(style.marginTop) + parseInt(style.marginBottom);\n\t\t\t\t}\n\n\t\t\t\tcontentHeight = Math.max(contentHeight, 200);\n\n\t\t\t\t// Get transition distance for this section\n\t\t\t\tconst speed = bg.getAttribute('data-speed') || 'normal';\n\t\t\t\tlet transitionDistance;\n\t\t\t\tif (speed === 'slow') {\n\t\t\t\t\ttransitionDistance = 2.5 * viewportHeight;\n\t\t\t\t} else if (speed === 'fast') {\n\t\t\t\t\ttransitionDistance = 1.2 * viewportHeight;\n\t\t\t\t} else {\n\t\t\t\t\ttransitionDistance = 2.0 * viewportHeight;\n\t\t\t\t}\n\n\t\t\t\t// Section height: viewport (for content to enter) + content height + viewport (for content to exit) + transition space\n\t\t\t\t// The last section needs extra space to scroll the background away\n\t\t\t\tif (index === sections.length - 1) {\n\t\t\t\t\tsection.style.height = (viewportHeight * 3 + contentHeight) + 'px';\n\t\t\t\t} else {\n\t\t\t\t\tsection.style.height = (viewportHeight * 2 + contentHeight + transitionDistance) + 'px';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Update on scroll\n\t\t */\n\t\tfunction updateOnScroll() {\n\t\t\tconst scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\t\t\tconst viewportHeight = window.innerHeight;\n\t\t\tconst blockRect = block.getBoundingClientRect();\n\t\t\tconst blockTop = scrollTop + blockRect.top;\n\t\t\tconst blockBottom = blockTop + block.offsetHeight;\n\n\t\t\t// Check if block should be \"stuck\" at top of viewport\n\t\t\tconst isStuck = blockRect.top <= 0 && blockRect.bottom > viewportHeight;\n\t\t\t\n\t\t\t// Toggle class for CSS to handle fixed positioning\n\t\t\tif (isStuck) {\n\t\t\t\tblock.classList.add('is-stuck');\n\t\t\t} else {\n\t\t\t\tblock.classList.remove('is-stuck');\n\t\t\t}\n\n\t\t\t// Check if we're in the reveal block\n\t\t\tconst inBlock = scrollTop >= blockTop && scrollTop <= blockBottom;\n\n\t\t\tif (!inBlock || !isStuck) {\n\t\t\t\t// Not in block or not stuck - show only first background\n\t\t\t\tbackgrounds.forEach((bg, index) => {\n\t\t\t\t\tif (index === 0) {\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t\tbg.style.zIndex = 10;\n\t\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbg.style.opacity = 0;\n\t\t\t\t\t\tbg.style.zIndex = 5;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tticking = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet activeIndex = -1;\n\t\t\tlet transitionIndex = -1;\n\t\t\tlet transitionProgress = 0;\n\n\t\t\t// Find which section we're currently in\n\t\t\tsections.forEach((section, index) => {\n\t\t\t\tconst rect = section.getBoundingClientRect();\n\t\t\t\tconst sectionTop = scrollTop + rect.top;\n\t\t\t\tconst sectionBottom = sectionTop + section.offsetHeight;\n\t\t\t\tconst content = section.querySelector('.reveal-frame-content');\n\t\t\t\tconst contentRect = content.getBoundingClientRect();\n\n\t\t\t\t// Is scroll position within this section?\n\t\t\t\tif (scrollTop >= sectionTop && scrollTop < sectionBottom) {\n\t\t\t\t\t// Check if content is visible (has some part in viewport)\n\t\t\t\t\tconst contentVisible = contentRect.bottom > viewportHeight * 0.15 && contentRect.top < viewportHeight * 0.85;\n\n\t\t\t\t\tif (contentVisible) {\n\t\t\t\t\t\t// Content is visible, this is the active frame\n\t\t\t\t\t\tactiveIndex = index;\n\t\t\t\t\t} else if (index < sections.length - 1) {\n\t\t\t\t\t\t// Content not visible but we're in this section = transition zone\n\t\t\t\t\t\tactiveIndex = index;\n\t\t\t\t\t\ttransitionIndex = index + 1;\n\n\t\t\t\t\t\t// Calculate transition progress\n\t\t\t\t\t\tconst bg = sections[transitionIndex].querySelector('.reveal-frame-background');\n\t\t\t\t\t\tconst speed = bg.getAttribute('data-speed') || 'normal';\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet transitionDistance;\n\t\t\t\t\t\tif (speed === 'slow') {\n\t\t\t\t\t\t\ttransitionDistance = 2.5 * viewportHeight;\n\t\t\t\t\t\t} else if (speed === 'fast') {\n\t\t\t\t\t\t\ttransitionDistance = 1.2 * viewportHeight;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttransitionDistance = 2.0 * viewportHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Transition starts when content is fully gone\n\t\t\t\t\t\tconst contentChildren = content.children;\n\t\t\t\t\t\tlet contentHeight = 0;\n\t\t\t\t\t\tfor (let child of contentChildren) {\n\t\t\t\t\t\t\tcontentHeight += child.offsetHeight;\n\t\t\t\t\t\t\tconst style = window.getComputedStyle(child);\n\t\t\t\t\t\t\tcontentHeight += parseInt(style.marginTop) + parseInt(style.marginBottom);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst transitionStart = sectionTop + (2 * viewportHeight) + contentHeight;\n\t\t\t\t\t\tconst progressIntoTransition = scrollTop - transitionStart;\n\t\t\t\t\t\ttransitionProgress = progressIntoTransition / transitionDistance;\n\t\t\t\t\t\ttransitionProgress = Math.max(0, Math.min(1, transitionProgress));\n\t\t\t\t\t} else if (index === sections.length - 1) {\n\t\t\t\t\t\t// Last section - keep active\n\t\t\t\t\t\tactiveIndex = index;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// If no active frame found, default to first\n\t\t\tif (activeIndex === -1) {\n\t\t\t\tactiveIndex = 0;\n\t\t\t}\n\n\t\t\t// Apply background visibility\n\t\t\tbackgrounds.forEach((bg, index) => {\n\t\t\t\tconst transitionType = bg.getAttribute('data-transition') || 'none';\n\n\t\t\t\tif (index === activeIndex && transitionIndex === -1) {\n\t\t\t\t\t// Active frame, no transition\n\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\tbg.style.zIndex = 10;\n\t\t\t\t} else if (index === activeIndex && transitionIndex !== -1) {\n\t\t\t\t\t// Active frame during transition - backdrop\n\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\tbg.style.zIndex = 9;\n\t\t\t\t} else if (index === transitionIndex) {\n\t\t\t\t\t// Frame transitioning in\n\t\t\t\t\tbg.style.zIndex = 10;\n\n\t\t\t\t\tif (transitionType === 'fade') {\n\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\t} else if (transitionType === 'left') {\n\t\t\t\t\t\tconst x = (1 - transitionProgress) * 100;\n\t\t\t\t\t\tbg.style.transform = `translate3d(${x}%, 0, 0)`;\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t} else if (transitionType === 'right') {\n\t\t\t\t\t\tconst x = -(1 - transitionProgress) * 100;\n\t\t\t\t\t\tbg.style.transform = `translate3d(${x}%, 0, 0)`;\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t} else if (transitionType === 'up') {\n\t\t\t\t\t\tconst y = (1 - transitionProgress) * 100;\n\t\t\t\t\t\tbg.style.transform = `translate3d(0, ${y}%, 0)`;\n\t\t\t\t\t\tbg.style.opacity = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbg.style.opacity = transitionProgress;\n\t\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Hidden\n\t\t\t\t\tbg.style.opacity = 0;\n\t\t\t\t\tbg.style.transform = 'none';\n\t\t\t\t\tbg.style.zIndex = 5;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tticking = false;\n\t\t}\n\n\t\tfunction onScroll() {\n\t\t\tif (!ticking) {\n\t\t\t\twindow.requestAnimationFrame(updateOnScroll);\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t}\n\n\t\tfunction onResize() {\n\t\t\tsetSectionHeights();\n\t\t\tupdateOnScroll();\n\t\t}\n\n\t\t// Initialize\n\t\tsetSectionHeights();\n\n\t\t// Set up listeners\n\t\twindow.addEventListener('scroll', onScroll, { passive: true });\n\t\twindow.addEventListener('resize', onResize, { passive: true });\n\n\t\t// Recalculate after images load\n\t\tblock.querySelectorAll('img').forEach((img) => {\n\t\t\tif (!img.complete) {\n\t\t\t\timg.addEventListener('load', () => {\n\t\t\t\t\tsetSectionHeights();\n\t\t\t\t\tupdateOnScroll();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tupdateOnScroll();\n\n\t\tblock._revealCleanup = function () {\n\t\t\twindow.removeEventListener('scroll', onScroll);\n\t\t\twindow.removeEventListener('resize', onResize);\n\t\t};\n\t}\n\n\tfunction initAllBlocks() {\n\t\tdocument.querySelectorAll('.caes-reveal').forEach(initRevealBlock);\n\t}\n\n\tif (document.readyState === 'loading') {\n\t\tdocument.addEventListener('DOMContentLoaded', initAllBlocks);\n\t} else {\n\t\tinitAllBlocks();\n\t}\n})();"],"names":["initRevealBlock","block","sections","querySelectorAll","backgrounds","contents","length","ticking","setSectionHeights","viewportHeight","window","innerHeight","forEach","section","index","content","querySelector","bg","contentChildren","children","contentHeight","child","offsetHeight","style","getComputedStyle","parseInt","marginTop","marginBottom","Math","max","speed","getAttribute","transitionDistance","height","updateOnScroll","scrollTop","pageYOffset","document","documentElement","blockRect","getBoundingClientRect","blockTop","top","blockBottom","isStuck","bottom","classList","add","remove","inBlock","opacity","zIndex","transform","activeIndex","transitionIndex","transitionProgress","rect","sectionTop","sectionBottom","contentRect","contentVisible","transitionStart","progressIntoTransition","min","transitionType","x","y","onScroll","requestAnimationFrame","onResize","addEventListener","passive","img","complete","_revealCleanup","removeEventListener","initAllBlocks","readyState"],"sourceRoot":""}