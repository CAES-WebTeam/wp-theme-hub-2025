{"version":3,"file":"blocks/lightbox-gallery/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/lightbox-gallery/view.js"],"sourcesContent":["/**\n * Lightbox Gallery Frontend JavaScript\n * Handles accessible lightbox functionality with keyboard navigation and focus management\n */\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    \n    class LightboxGallery {\n        constructor(galleryElement) {\n            this.gallery = galleryElement;\n            this.galleryId = galleryElement.id;\n            \n            // Get images data from data attribute\n            try {\n                const imagesData = this.gallery.dataset.images;\n                this.images = imagesData ? JSON.parse(imagesData) : [];\n            } catch (e) {\n                console.error('Error parsing gallery images data:', e);\n                this.images = [];\n            }\n            \n            this.currentImageIndex = 0;\n            this.lastFocusedElement = null;\n            \n            // Get DOM elements\n            this.modal = this.gallery.querySelector('.lightbox-modal');\n            this.lightboxImage = this.modal.querySelector('.lightbox-image');\n            this.lightboxCaption = this.modal.querySelector('.lightbox-caption');\n            this.closeBtn = this.modal.querySelector('.lightbox-close');\n            this.prevBtn = this.modal.querySelector('.prev-btn');\n            this.nextBtn = this.modal.querySelector('.next-btn');\n            this.backdrop = this.modal.querySelector('.lightbox-backdrop');\n            \n            // Gallery elements (updated selectors for simplified structure)\n            this.viewGalleryBtn = this.gallery.querySelector('.view-gallery-btn');\n            this.galleryTrigger = this.gallery.querySelector('.gallery-trigger');\n            this.triggerImage = this.gallery.querySelector('.gallery-trigger-image');\n            \n            this.init();\n        }\n        \n        init() {\n            this.bindEvents();\n        }\n        \n        bindEvents() {\n            // View Gallery button\n            if (this.viewGalleryBtn) {\n                this.viewGalleryBtn.addEventListener('click', (e) => {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.openLightbox(0);\n                });\n                \n                this.viewGalleryBtn.addEventListener('keydown', (e) => {\n                    if (e.key === 'Enter' || e.key === ' ') {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        this.openLightbox(0);\n                    }\n                });\n            }\n            \n            // Also allow clicking the gallery trigger area to open lightbox\n            if (this.galleryTrigger) {\n                this.galleryTrigger.addEventListener('click', (e) => {\n                    // Only trigger if clicking on the image itself, not the button\n                    if (e.target === this.triggerImage || e.target === this.galleryTrigger) {\n                        e.preventDefault();\n                        this.openLightbox(0);\n                    }\n                });\n            }\n            \n            // Lightbox controls\n            if (this.closeBtn) {\n                this.closeBtn.addEventListener('click', () => this.closeLightbox());\n            }\n            \n            if (this.prevBtn) {\n                this.prevBtn.addEventListener('click', () => this.goToPrevImage());\n            }\n            \n            if (this.nextBtn) {\n                this.nextBtn.addEventListener('click', () => this.goToNextImage());\n            }\n            \n            // Backdrop click to close\n            if (this.backdrop) {\n                this.backdrop.addEventListener('click', () => this.closeLightbox());\n            }\n            \n            // Global keyboard events for lightbox\n            document.addEventListener('keydown', (e) => this.handleGlobalKeydown(e));\n        }\n        \n        openLightbox(index = 0) {\n            if (this.images.length === 0) {\n                return;\n            }\n            \n            this.currentImageIndex = index;\n            this.lastFocusedElement = document.activeElement;\n            \n            // Update lightbox content\n            this.updateLightboxImage();\n            \n            // Show modal\n            this.modal.setAttribute('aria-hidden', 'false');\n            this.modal.style.display = 'flex';\n            \n            // Prevent body scroll\n            document.body.style.overflow = 'hidden';\n            document.body.classList.add('lightbox-open');\n            \n            // Focus management\n            setTimeout(() => {\n                if (this.closeBtn) {\n                    this.closeBtn.focus();\n                }\n            }, 100);\n        }\n        \n        closeLightbox() {\n            // Hide modal\n            this.modal.setAttribute('aria-hidden', 'true');\n            this.modal.style.display = 'none';\n            \n            // Restore body scroll\n            document.body.style.overflow = '';\n            document.body.classList.remove('lightbox-open');\n            \n            // Return focus to last focused element\n            if (this.lastFocusedElement) {\n                this.lastFocusedElement.focus();\n            }\n        }\n        \n        updateLightboxImage() {\n            const image = this.images[this.currentImageIndex];\n            if (!image) {\n                return;\n            }\n            \n            // Update the lightbox image\n            if (this.lightboxImage) {\n                this.lightboxImage.src = image.url;\n                this.lightboxImage.alt = image.alt || '';\n            }\n            \n            // Update caption\n            if (this.lightboxCaption) {\n                this.lightboxCaption.innerHTML = image.caption || '';\n            }\n            \n            // Update navigation button states\n            if (this.prevBtn) {\n                this.prevBtn.disabled = this.images.length <= 1;\n            }\n            if (this.nextBtn) {\n                this.nextBtn.disabled = this.images.length <= 1;\n            }\n        }\n        \n        goToNextImage() {\n            if (this.images.length <= 1) return;\n            \n            this.currentImageIndex = (this.currentImageIndex + 1) % this.images.length;\n            this.updateLightboxImage();\n        }\n        \n        goToPrevImage() {\n            if (this.images.length <= 1) return;\n            \n            this.currentImageIndex = (this.currentImageIndex - 1 + this.images.length) % this.images.length;\n            this.updateLightboxImage();\n        }\n        \n        handleGlobalKeydown(e) {\n            // Only handle when lightbox is open\n            if (this.modal.getAttribute('aria-hidden') === 'true') {\n                return;\n            }\n            \n            switch (e.key) {\n                case 'Escape':\n                    e.preventDefault();\n                    this.closeLightbox();\n                    break;\n                    \n                case 'ArrowLeft':\n                    e.preventDefault();\n                    this.goToPrevImage();\n                    break;\n                    \n                case 'ArrowRight':\n                    e.preventDefault();\n                    this.goToNextImage();\n                    break;\n                    \n                case 'Tab':\n                    this.handleFocusTrap(e);\n                    break;\n            }\n        }\n        \n        handleFocusTrap(e) {\n            const focusableElements = [\n                this.closeBtn,\n                this.prevBtn,\n                this.nextBtn\n            ].filter(el => el && !el.disabled);\n            \n            if (focusableElements.length === 0) return;\n            \n            const firstElement = focusableElements[0];\n            const lastElement = focusableElements[focusableElements.length - 1];\n            \n            if (e.shiftKey) {\n                // Shift + Tab\n                if (document.activeElement === firstElement) {\n                    e.preventDefault();\n                    lastElement.focus();\n                }\n            } else {\n                // Tab\n                if (document.activeElement === lastElement) {\n                    e.preventDefault();\n                    firstElement.focus();\n                }\n            }\n        }\n    }\n    \n    // Initialize all lightbox galleries on the page\n    const galleries = document.querySelectorAll('.lightbox-gallery');\n    galleries.forEach(gallery => {\n        new LightboxGallery(gallery);\n    });\n});"],"names":["document","addEventListener","LightboxGallery","constructor","galleryElement","gallery","galleryId","id","imagesData","dataset","images","JSON","parse","e","console","error","currentImageIndex","lastFocusedElement","modal","querySelector","lightboxImage","lightboxCaption","closeBtn","prevBtn","nextBtn","backdrop","viewGalleryBtn","galleryTrigger","triggerImage","init","bindEvents","preventDefault","stopPropagation","openLightbox","key","target","closeLightbox","goToPrevImage","goToNextImage","handleGlobalKeydown","index","length","activeElement","updateLightboxImage","setAttribute","style","display","body","overflow","classList","add","setTimeout","focus","remove","image","src","url","alt","innerHTML","caption","disabled","getAttribute","handleFocusTrap","focusableElements","filter","el","firstElement","lastElement","shiftKey","galleries","querySelectorAll","forEach"],"sourceRoot":""}