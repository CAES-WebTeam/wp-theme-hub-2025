{"version":3,"file":"blocks/toc-new/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/toc-new/view.js"],"sourcesContent":["window.addEventListener('load', function () {\n    const postContent = document.querySelector('.caes-hub-content-post');\n    if (!postContent) return;\n\n    const tocWrapper = document.querySelector('.wp-block-caes-hub-toc-new');\n    if (!tocWrapper) return;\n\n    const showSubheadings = tocWrapper.dataset.showSubheadings === \"1\";\n    const listStyle = tocWrapper.dataset.listStyle || \"ul\";\n    const title = tocWrapper.dataset.title || \"Table of Contents\";\n    const enablePopout = tocWrapper.dataset.popout === \"true\" || tocWrapper.dataset.popout === \"1\";\n    const enableTopAnchor = tocWrapper.dataset.topOfContentAnchor === \"true\" || tocWrapper.dataset.topOfContentAnchor === \"1\";\n    const anchorLinkText = tocWrapper.dataset.anchorLinkText || \"Top of Content\";\n    const currentPage = parseInt(tocWrapper.dataset.currentPage) || 1;\n    const totalPages = parseInt(tocWrapper.dataset.totalPages) || 1;\n    const headingsData = JSON.parse(tocWrapper.dataset.headings || '[]');\n\n    // Get base URL for building page links\n    const baseUrl = window.location.pathname.replace(/\\/\\d+\\/?$/, '');\n\n    function createList(isSublist = false) {\n        if (isSublist) {\n            return document.createElement(\"ul\");\n        }\n        if (listStyle === \"ol\") {\n            return document.createElement(\"ol\");\n        }\n        const ul = document.createElement(\"ul\");\n        if (listStyle === \"none\") {\n            ul.classList.add(\"is-style-caes-hub-list-none\");\n        }\n        return ul;\n    }\n\n    function buildTOCs(headingsData) {\n        if (headingsData.length === 0) return;\n\n        const tocList = createList();\n        const stickyTocList = createList();\n        const originalHeadingMap = new Map();\n        const stickyHeadingMap = new Map();\n\n        // Add \"Top of Content\" anchor if enabled\n        if (enableTopAnchor && headingsData.length > 0) {\n            const topAnchorId = 'top-of-page';\n\n            const topListItem = document.createElement('li');\n            const topLink = document.createElement('a');\n            topLink.textContent = anchorLinkText;\n            topLink.href = currentPage === 1 ? `#${topAnchorId}` : baseUrl;\n            topListItem.appendChild(topLink);\n            topListItem.classList.add('toc-top-anchor');\n            \n            // Top anchor is only on page 1\n            if (currentPage === 1) {\n                topListItem.classList.add('toc-current-page');\n            } else {\n                topListItem.classList.add('toc-other-page');\n            }\n\n            const stickyTopItem = topListItem.cloneNode(true);\n\n            tocList.appendChild(topListItem);\n            stickyTocList.appendChild(stickyTopItem);\n\n            // Only track for active highlighting if on page 1\n            if (currentPage === 1) {\n                originalHeadingMap.set(topAnchorId, topListItem);\n                stickyHeadingMap.set(topAnchorId, stickyTopItem);\n            }\n        }\n\n        // Group headings by page\n        const headingsByPage = {};\n        headingsData.forEach(heading => {\n            if (!headingsByPage[heading.page]) {\n                headingsByPage[heading.page] = [];\n            }\n            headingsByPage[heading.page].push(heading);\n        });\n\n        // Build TOC for each page\n        Object.keys(headingsByPage).sort((a, b) => parseInt(a) - parseInt(b)).forEach(pageNum => {\n            const pageNumber = parseInt(pageNum);\n            const pageHeadings = headingsByPage[pageNum];\n\n            // Add page header if there are multiple pages and this isn't page 1\n            if (totalPages > 1 && pageNumber > 1) {\n                const pageHeader = document.createElement('li');\n                pageHeader.className = 'toc-page-header';\n                pageHeader.textContent = `Page ${pageNumber}`;\n                \n                const stickyPageHeader = pageHeader.cloneNode(true);\n                \n                tocList.appendChild(pageHeader);\n                stickyTocList.appendChild(stickyPageHeader);\n            }\n\n            let currentList = tocList;\n            let stickyCurrentList = stickyTocList;\n            let lastLevel = 2;\n            let lastH2Item = null;\n            let lastStickyH2Item = null;\n\n            pageHeadings.forEach((heading, idx) => {\n                const { text, level, id, page } = heading;\n                const isOnCurrentPage = page === currentPage;\n\n                const listItem = document.createElement('li');\n                const link = document.createElement('a');\n                link.textContent = text;\n                \n                // Build the correct URL\n                if (isOnCurrentPage) {\n                    link.href = `#${id}`;\n                } else {\n                    const pageUrl = page === 1 ? baseUrl : `${baseUrl}/${page}`;\n                    link.href = `${pageUrl}#${id}`;\n                }\n\n                listItem.appendChild(link);\n\n                // Mark items by page\n                if (isOnCurrentPage) {\n                    listItem.classList.add('toc-current-page');\n                } else {\n                    listItem.classList.add('toc-other-page');\n                }\n\n                const stickyItem = listItem.cloneNode(true);\n\n                // Handle nesting based on heading level\n                if (level === 2) {\n                    // H2 always goes at top level\n                    tocList.appendChild(listItem);\n                    stickyTocList.appendChild(stickyItem);\n                    lastH2Item = listItem;\n                    lastStickyH2Item = stickyItem;\n                } else {\n                    // H3+ goes nested under the last H2\n                    if (lastH2Item) {\n                        let nestedList = lastH2Item.querySelector('ul');\n                        if (!nestedList) {\n                            nestedList = createList(true);\n                            lastH2Item.appendChild(nestedList);\n                        }\n                        nestedList.appendChild(listItem);\n                    }\n                    \n                    if (lastStickyH2Item) {\n                        let stickyNestedList = lastStickyH2Item.querySelector('ul');\n                        if (!stickyNestedList) {\n                            stickyNestedList = createList(true);\n                            lastStickyH2Item.appendChild(stickyNestedList);\n                        }\n                        stickyNestedList.appendChild(stickyItem);\n                    }\n                }\n\n                // Only track headings on current page for active highlighting\n                if (isOnCurrentPage) {\n                    originalHeadingMap.set(id, listItem);\n                    stickyHeadingMap.set(id, stickyItem);\n                }\n\n                lastLevel = level;\n            });\n        });\n\n        // Wrap list in a scrollable container\n        const scrollWrapper = document.createElement('div');\n        scrollWrapper.classList.add('toc-scroll-wrapper');\n        scrollWrapper.appendChild(tocList);\n        tocWrapper.appendChild(scrollWrapper);\n\n        // Add sticky TOC before </main> only if popout is enabled\n        const mainElement = document.querySelector('main');\n        if (mainElement && enablePopout) {\n            const stickyTOC = document.createElement('div');\n            stickyTOC.classList.add('sticky-toc');\n\n            const tocTitle = document.createElement('h2');\n            tocTitle.textContent = title;\n            stickyTOC.appendChild(tocTitle);\n\n            const stickyScrollWrapper = document.createElement('div');\n            stickyScrollWrapper.classList.add('toc-scroll-wrapper');\n            stickyScrollWrapper.appendChild(stickyTocList);\n            stickyTOC.appendChild(stickyScrollWrapper);\n\n            mainElement.appendChild(stickyTOC);\n\n            return { stickyTOC, originalHeadingMap, stickyHeadingMap };\n        }\n\n        return { stickyTOC: null, originalHeadingMap, stickyHeadingMap };\n    }\n\n    const { stickyTOC, originalHeadingMap, stickyHeadingMap } = buildTOCs(headingsData) || {};\n\n    function enableSmoothScroll() {\n        document.addEventListener('click', function (event) {\n            if (event.target.tagName === 'A' && event.target.hash) {\n                const targetID = event.target.hash.substring(1);\n\n                // Only prevent default for same-page anchors\n                const linkUrl = new URL(event.target.href);\n                const currentUrl = new URL(window.location.href);\n                \n                if (linkUrl.pathname === currentUrl.pathname) {\n                    event.preventDefault();\n                    \n                    if (targetID === 'top-of-page') {\n                        window.scrollTo({ top: 0, behavior: 'smooth' });\n                        return;\n                    }\n\n                    const targetElement = document.getElementById(targetID);\n                    if (targetElement) {\n                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                    }\n                }\n            }\n        });\n    }\n    enableSmoothScroll();\n\n    function handleScroll() {\n        if (!stickyTOC) return;\n\n        const tocRect = tocWrapper.getBoundingClientRect();\n        const stickyTocRect = stickyTOC.getBoundingClientRect();\n        const postContentRect = postContent.getBoundingClientRect();\n\n        const tocShouldBeVisible = tocRect.top < 0;\n        const tocBottomHitsPostBottom = stickyTocRect.bottom >= postContentRect.bottom;\n\n        if (tocShouldBeVisible && !tocBottomHitsPostBottom) {\n            stickyTOC.classList.add('visible');\n        } else {\n            stickyTOC.classList.remove('visible');\n        }\n    }\n    window.addEventListener('scroll', handleScroll);\n\n    function assignHeadingIDs() {\n        // Get all headings currently in the DOM (current page only)\n        const headingsInDom = Array.from(postContent.querySelectorAll(showSubheadings ? 'h2, h3, h4, h5, h6' : 'h2'))\n            .filter(heading => {\n                const text = heading.textContent.trim();\n                // Filter out TOC title and any template literals\n                return text !== title && !text.includes('${') && !text.includes('plant.');\n            });\n\n        // Match DOM headings with our headings data and assign IDs\n        let dataIndex = 0;\n        headingsInDom.forEach(domHeading => {\n            // Find matching heading in data for current page\n            while (dataIndex < headingsData.length) {\n                const data = headingsData[dataIndex];\n                if (data.page === currentPage && data.text === domHeading.textContent.trim()) {\n                    domHeading.id = data.id;\n                    dataIndex++;\n                    break;\n                }\n                dataIndex++;\n            }\n        });\n\n        return headingsInDom;\n    }\n\n    const headingsInDom = assignHeadingIDs();\n\n    // Handle initial scroll to hash if present in URL\n    function scrollToHashIfPresent() {\n        const hash = window.location.hash;\n        if (hash) {\n            const targetId = hash.substring(1);\n            const targetElement = document.getElementById(targetId);\n            \n            if (targetElement) {\n                // Small delay to ensure layout is complete\n                setTimeout(() => {\n                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }, 100);\n            }\n        }\n    }\n    scrollToHashIfPresent();\n\n    function observeHeadings() {\n        if (!originalHeadingMap || !stickyHeadingMap || !headingsInDom) return;\n\n        const observer = new IntersectionObserver(entries => {\n            const isAtTop = window.scrollY < 50;\n\n            if (isAtTop && enableTopAnchor && currentPage === 1) {\n                document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                    item.classList.remove('active');\n                });\n                if (enablePopout) {\n                    document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                }\n                if (originalHeadingMap.has('top-of-page')) {\n                    originalHeadingMap.get('top-of-page').classList.add('active');\n                }\n                if (enablePopout && stickyHeadingMap.has('top-of-page')) {\n                    stickyHeadingMap.get('top-of-page').classList.add('active');\n                }\n                return;\n            }\n\n            // Find the topmost visible heading\n            let topmostEntry = null;\n            let topmostY = Infinity;\n\n            entries.forEach(entry => {\n                if (entry.isIntersecting) {\n                    const rect = entry.target.getBoundingClientRect();\n                    if (rect.top < topmostY && rect.top >= 0) {\n                        topmostY = rect.top;\n                        topmostEntry = entry;\n                    }\n                }\n            });\n\n            if (topmostEntry) {\n                const id = topmostEntry.target.id;\n                if (originalHeadingMap.has(id) && stickyHeadingMap.has(id)) {\n                    const originalTocItem = originalHeadingMap.get(id);\n                    const stickyTocItem = stickyHeadingMap.get(id);\n\n                    // Remove active from all items\n                    document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                    if (enablePopout) {\n                        document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                            item.classList.remove('active');\n                        });\n                    }\n\n                    // Add active to the topmost visible heading\n                    originalTocItem.classList.add('active');\n                    if (enablePopout) {\n                        stickyTocItem.classList.add('active');\n                    }\n                }\n            }\n        }, {\n            rootMargin: '-80px 0px -60% 0px',\n            threshold: [0, 0.1, 0.5, 1]\n        });\n\n        headingsInDom.forEach(heading => observer.observe(heading));\n    }\n\n    observeHeadings();\n});"],"names":["window","addEventListener","postContent","document","querySelector","tocWrapper","showSubheadings","dataset","listStyle","title","enablePopout","popout","enableTopAnchor","topOfContentAnchor","anchorLinkText","currentPage","parseInt","totalPages","headingsData","JSON","parse","headings","baseUrl","location","pathname","replace","createList","isSublist","createElement","ul","classList","add","buildTOCs","length","tocList","stickyTocList","originalHeadingMap","Map","stickyHeadingMap","topAnchorId","topListItem","topLink","textContent","href","appendChild","stickyTopItem","cloneNode","set","headingsByPage","forEach","heading","page","push","Object","keys","sort","a","b","pageNum","pageNumber","pageHeadings","pageHeader","className","stickyPageHeader","currentList","stickyCurrentList","lastLevel","lastH2Item","lastStickyH2Item","idx","text","level","id","isOnCurrentPage","listItem","link","pageUrl","stickyItem","nestedList","stickyNestedList","scrollWrapper","mainElement","stickyTOC","tocTitle","stickyScrollWrapper","enableSmoothScroll","event","target","tagName","hash","targetID","substring","linkUrl","URL","currentUrl","preventDefault","scrollTo","top","behavior","targetElement","getElementById","scrollIntoView","block","handleScroll","tocRect","getBoundingClientRect","stickyTocRect","postContentRect","tocShouldBeVisible","tocBottomHitsPostBottom","bottom","remove","assignHeadingIDs","headingsInDom","Array","from","querySelectorAll","filter","trim","includes","dataIndex","domHeading","data","scrollToHashIfPresent","targetId","setTimeout","observeHeadings","observer","IntersectionObserver","entries","isAtTop","scrollY","item","has","get","topmostEntry","topmostY","Infinity","entry","isIntersecting","rect","originalTocItem","stickyTocItem","rootMargin","threshold","observe"],"sourceRoot":""}