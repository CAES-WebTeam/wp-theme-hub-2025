{"version":3,"file":"blocks/toc-new/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/toc-new/view.js"],"sourcesContent":["window.addEventListener('load', function () {\n    const postContent = document.querySelector('.caes-hub-content-post');\n    if (!postContent) return;\n\n    const tocWrapper = document.querySelector('.wp-block-caes-hub-toc-new');\n    if (!tocWrapper) return;\n\n    const showSubheadings = tocWrapper.dataset.showSubheadings === \"1\";\n    const listStyle = tocWrapper.dataset.listStyle || \"ul\";\n    const title = tocWrapper.dataset.title || \"Table of Contents\";\n    const enablePopout = tocWrapper.dataset.popout === \"true\" || tocWrapper.dataset.popout === \"1\";\n    const enableTopAnchor = tocWrapper.dataset.topOfContentAnchor === \"true\" || tocWrapper.dataset.topOfContentAnchor === \"1\";\n    const anchorLinkText = tocWrapper.dataset.anchorLinkText || \"Top of Content\";\n\n\n    // Filter out the h2 element with the same text as the title\n    const headings = Array.from(postContent.querySelectorAll(showSubheadings ? 'h2, h3, h4, h5, h6' : 'h2')).filter(heading => heading.textContent !== title);\n\n    function slugify(text) {\n        return text.toString().trim().toLowerCase()\n            .replace(/\\s+/g, '-')\n            .replace(/[^\\w\\-]+/g, '')\n            .replace(/\\-\\-+/g, '-')\n            .replace(/^-+/, '')\n            .replace(/-+$/, '');\n    }\n\n    function generateUniqueID(baseID, usedIDs) {\n        let uniqueID = baseID;\n        let count = 2;\n        while (usedIDs.has(uniqueID)) {\n            uniqueID = `${baseID}-${count}`;\n            count++;\n        }\n        usedIDs.add(uniqueID);\n        return uniqueID;\n    }\n\n    function createList(isSublist = false) {\n        if (isSublist) {\n            return document.createElement(\"ul\");\n        }\n        if (listStyle === \"ol\") {\n            return document.createElement(\"ol\");\n        }\n        const ul = document.createElement(\"ul\");\n        if (listStyle === \"none\") {\n            ul.classList.add(\"is-style-caes-hub-list-none\");\n        }\n        return ul;\n    }\n\n    function buildTOCs(headings) {\n        if (headings.length === 0) return;\n\n        const usedIDs = new Set();\n        const tocList = createList();\n        const stickyTocList = createList();\n        const originalHeadingMap = new Map();\n        const stickyHeadingMap = new Map();\n\n        // Add top of content anchor if enabled\n        if (enableTopAnchor && headings.length > 0) {\n            const topAnchorId = 'top-of-page';\n            \n            // Create top anchor list items\n            const topListItem = document.createElement('li');\n            const topLink = document.createElement('a');\n            topLink.textContent = anchorLinkText;\n            topLink.href = `#${topAnchorId}`;\n            topListItem.appendChild(topLink);\n            \n            const stickyTopItem = topListItem.cloneNode(true);\n            \n            // Add to both TOCs\n            tocList.appendChild(topListItem);\n            stickyTocList.appendChild(stickyTopItem);\n            \n            // Map the top items for active state tracking\n            originalHeadingMap.set(topAnchorId, topListItem);\n            stickyHeadingMap.set(topAnchorId, stickyTopItem);\n        }\n\n        let currentList = tocList;\n        let stickyCurrentList = stickyTocList;\n        let lastLevel = 2;\n\n        headings.forEach(heading => {\n            const level = parseInt(heading.tagName.substring(1), 10);\n            const baseID = slugify(heading.textContent);\n            const uniqueID = generateUniqueID(baseID, usedIDs);\n            heading.id = uniqueID;\n\n            const listItem = document.createElement('li');\n            const link = document.createElement('a');\n            link.textContent = heading.textContent;\n            link.href = `#${uniqueID}`;\n            listItem.appendChild(link);\n\n            const stickyItem = listItem.cloneNode(true);\n\n            // Reset nesting if it's an H2\n            if (level === 2) {\n                currentList = tocList;\n                stickyCurrentList = stickyTocList;\n            } else if (level > lastLevel) {\n                // Create new sublist only if level increases\n                const newList = createList(true);\n                currentList.lastElementChild?.appendChild(newList);\n                currentList = newList;\n\n                const newStickyList = createList(true);\n                stickyCurrentList.lastElementChild?.appendChild(newStickyList);\n                stickyCurrentList = newStickyList;\n            }\n\n            // Append to the lists\n            currentList.appendChild(listItem);\n            stickyCurrentList.appendChild(stickyItem);\n\n            // Map both original and sticky items to their heading IDs\n            originalHeadingMap.set(uniqueID, listItem);\n            stickyHeadingMap.set(uniqueID, stickyItem);\n\n            lastLevel = level;\n        });\n\n        tocWrapper.appendChild(tocList);\n\n        // Add sticky TOC before </main> only if popout is enabled\n        const mainElement = document.querySelector('main');\n        if (mainElement && enablePopout) {\n            const stickyTOC = document.createElement('div');\n            stickyTOC.classList.add('sticky-toc');\n            const tocTitle = document.createElement('h2');\n            tocTitle.textContent = title;\n            stickyTOC.appendChild(tocTitle);\n            stickyTOC.appendChild(stickyTocList);\n            mainElement.appendChild(stickyTOC);\n\n            return { stickyTOC, originalHeadingMap, stickyHeadingMap };\n        }\n\n        return { stickyTOC: null, originalHeadingMap, stickyHeadingMap };\n    }\n\n    const { stickyTOC, originalHeadingMap, stickyHeadingMap } = buildTOCs(headings) || {};\n\n    function enableSmoothScroll() {\n        document.addEventListener('click', function (event) {\n            if (event.target.tagName === 'A' && event.target.hash) {\n                event.preventDefault();\n                const targetID = event.target.hash.substring(1);\n                \n                // Handle top of page link\n                if (targetID === 'top-of-page') {\n                    window.scrollTo({ top: 0, behavior: 'smooth' });\n                    return;\n                }\n                \n                const targetElement = document.getElementById(targetID);\n                if (targetElement) {\n                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }\n            }\n        });\n    }\n    enableSmoothScroll();\n\n    function handleScroll() {\n        if (!stickyTOC) return;\n    \n        const tocRect = tocWrapper.getBoundingClientRect();\n        const stickyTocRect = stickyTOC.getBoundingClientRect();\n        const postContentRect = postContent.getBoundingClientRect();\n    \n        const tocShouldBeVisible = tocRect.top < 0;\n        const tocBottomHitsPostBottom = stickyTocRect.bottom >= postContentRect.bottom;\n    \n        if (tocShouldBeVisible && !tocBottomHitsPostBottom) {\n            stickyTOC.classList.add('visible');\n        } else {\n            stickyTOC.classList.remove('visible');\n        }\n    }    \n    window.addEventListener('scroll', handleScroll);\n\n    function observeHeadings() {\n        if (!originalHeadingMap || !stickyHeadingMap) return;\n\n        const observer = new IntersectionObserver(entries => {\n            let activeSet = false;\n            \n            // Check if we're at the top of the page\n            const isAtTop = window.scrollY < 100; // Within 100px of top\n            \n            if (isAtTop && enableTopAnchor) {\n                // Clear all active states\n                document.querySelectorAll('.wp-block-caes-hub-toc-new li').forEach(item => {\n                    item.classList.remove('active');\n                });\n                if (enablePopout) {\n                    document.querySelectorAll('.sticky-toc li').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                }\n                \n                // Set top link as active\n                if (originalHeadingMap.has('top-of-page')) {\n                    originalHeadingMap.get('top-of-page').classList.add('active');\n                }\n                if (enablePopout && stickyHeadingMap.has('top-of-page')) {\n                    stickyHeadingMap.get('top-of-page').classList.add('active');\n                }\n                return;\n            }\n            \n            entries.forEach(entry => {\n                const id = entry.target.id;\n                if (originalHeadingMap.has(id) && stickyHeadingMap.has(id)) {\n                    const originalTocItem = originalHeadingMap.get(id);\n                    const stickyTocItem = stickyHeadingMap.get(id);\n                    \n                    if (entry.isIntersecting && !activeSet) {\n                        // Clear active states from both TOCs\n                        document.querySelectorAll('.wp-block-caes-hub-toc-new li').forEach(item => {\n                            item.classList.remove('active');\n                        });\n                        if (enablePopout) {\n                            document.querySelectorAll('.sticky-toc li').forEach(item => {\n                                item.classList.remove('active');\n                            });\n                        }\n                        \n                        // Set active states for both TOCs\n                        originalTocItem.classList.add('active');\n                        if (enablePopout) {\n                            stickyTocItem.classList.add('active');\n                        }\n                        activeSet = true;\n                    }\n                }\n            });\n        }, {\n            rootMargin: '0px 0px -80% 0px',\n            threshold: 0.1\n        });\n\n        headings.forEach(heading => observer.observe(heading));\n        \n        // Also listen for scroll events to handle top-of-page detection\n        if (enableTopAnchor) {\n            window.addEventListener('scroll', () => {\n                const isAtTop = window.scrollY < 100;\n                \n                if (isAtTop) {\n                    // Clear all active states\n                    document.querySelectorAll('.wp-block-caes-hub-toc-new li').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                    if (enablePopout) {\n                        document.querySelectorAll('.sticky-toc li').forEach(item => {\n                            item.classList.remove('active');\n                        });\n                    }\n                    \n                    // Set top link as active\n                    if (originalHeadingMap.has('top-of-page')) {\n                        originalHeadingMap.get('top-of-page').classList.add('active');\n                    }\n                    if (enablePopout && stickyHeadingMap.has('top-of-page')) {\n                        stickyHeadingMap.get('top-of-page').classList.add('active');\n                    }\n                }\n            });\n        }\n    }\n\n    observeHeadings();\n});"],"names":["window","addEventListener","postContent","document","querySelector","tocWrapper","showSubheadings","dataset","listStyle","title","enablePopout","popout","enableTopAnchor","topOfContentAnchor","anchorLinkText","headings","Array","from","querySelectorAll","filter","heading","textContent","slugify","text","toString","trim","toLowerCase","replace","generateUniqueID","baseID","usedIDs","uniqueID","count","has","add","createList","isSublist","createElement","ul","classList","buildTOCs","length","Set","tocList","stickyTocList","originalHeadingMap","Map","stickyHeadingMap","topAnchorId","topListItem","topLink","href","appendChild","stickyTopItem","cloneNode","set","currentList","stickyCurrentList","lastLevel","forEach","level","parseInt","tagName","substring","id","listItem","link","stickyItem","newList","lastElementChild","newStickyList","mainElement","stickyTOC","tocTitle","enableSmoothScroll","event","target","hash","preventDefault","targetID","scrollTo","top","behavior","targetElement","getElementById","scrollIntoView","block","handleScroll","tocRect","getBoundingClientRect","stickyTocRect","postContentRect","tocShouldBeVisible","tocBottomHitsPostBottom","bottom","remove","observeHeadings","observer","IntersectionObserver","entries","activeSet","isAtTop","scrollY","item","get","entry","originalTocItem","stickyTocItem","isIntersecting","rootMargin","threshold","observe"],"sourceRoot":""}