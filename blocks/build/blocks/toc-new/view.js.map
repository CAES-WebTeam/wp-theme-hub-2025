{"version":3,"file":"blocks/toc-new/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/toc-new/view.js"],"sourcesContent":["window.addEventListener('load', function () {\n    const postContent = document.querySelector('.caes-hub-content-post');\n    if (!postContent) return;\n\n    const tocWrapper = document.querySelector('.wp-block-caes-hub-toc-new');\n    if (!tocWrapper) return;\n\n    const showSubheadings = tocWrapper.dataset.showSubheadings === \"1\";\n    const listStyle = tocWrapper.dataset.listStyle || \"ul\";\n    const title = tocWrapper.dataset.title || \"Table of Contents\";\n    const enablePopout = tocWrapper.dataset.popout === \"true\" || tocWrapper.dataset.popout === \"1\";\n    const enableTopAnchor = tocWrapper.dataset.topOfContentAnchor === \"true\" || tocWrapper.dataset.topOfContentAnchor === \"1\";\n    const anchorLinkText = tocWrapper.dataset.anchorLinkText || \"Top of Content\";\n    const currentPage = parseInt(tocWrapper.dataset.currentPage) || 1;\n    const totalPages = parseInt(tocWrapper.dataset.totalPages) || 1;\n    const headingsData = JSON.parse(tocWrapper.dataset.headings || '[]');\n\n    // Get base URL for building page links\n    const baseUrl = window.location.pathname.replace(/\\/\\d+\\/?$/, '');\n\n    function createList(isSublist = false) {\n        if (isSublist) {\n            return document.createElement(\"ul\");\n        }\n        if (listStyle === \"ol\") {\n            return document.createElement(\"ol\");\n        }\n        const ul = document.createElement(\"ul\");\n        if (listStyle === \"none\") {\n            ul.classList.add(\"is-style-caes-hub-list-none\");\n        }\n        return ul;\n    }\n\n    function buildTOCs(headingsData) {\n        if (headingsData.length === 0) return;\n\n        const tocList = createList();\n        const stickyTocList = createList();\n        const originalHeadingMap = new Map();\n        const stickyHeadingMap = new Map();\n\n        // Add \"Top of Content\" anchor if enabled\n        if (enableTopAnchor && headingsData.length > 0) {\n            const topAnchorId = 'top-of-page';\n\n            const topListItem = document.createElement('li');\n            const topLink = document.createElement('a');\n            topLink.textContent = anchorLinkText;\n            topLink.href = currentPage === 1 ? `#${topAnchorId}` : baseUrl;\n            topListItem.appendChild(topLink);\n            topListItem.classList.add('toc-top-anchor');\n            \n            // Top anchor is only on page 1\n            if (currentPage === 1) {\n                topListItem.classList.add('toc-current-page');\n            } else {\n                topListItem.classList.add('toc-other-page');\n            }\n\n            const stickyTopItem = topListItem.cloneNode(true);\n\n            tocList.appendChild(topListItem);\n            stickyTocList.appendChild(stickyTopItem);\n\n            // Only track for active highlighting if on page 1\n            if (currentPage === 1) {\n                originalHeadingMap.set(topAnchorId, topListItem);\n                stickyHeadingMap.set(topAnchorId, stickyTopItem);\n            }\n        }\n\n        // Group headings by page\n        const headingsByPage = {};\n        headingsData.forEach(heading => {\n            if (!headingsByPage[heading.page]) {\n                headingsByPage[heading.page] = [];\n            }\n            headingsByPage[heading.page].push(heading);\n        });\n\n        // Build TOC for each page\n        Object.keys(headingsByPage).sort((a, b) => parseInt(a) - parseInt(b)).forEach(pageNum => {\n            const pageNumber = parseInt(pageNum);\n            const pageHeadings = headingsByPage[pageNum];\n\n            // Add page header if there are multiple pages\n            if (totalPages > 1) {\n                const pageHeader = document.createElement('li');\n                pageHeader.className = 'toc-page-header';\n                \n                const pageLink = document.createElement('a');\n                pageLink.textContent = `Page ${pageNumber}`;\n                pageLink.href = pageNumber === 1 ? baseUrl : `${baseUrl}/${pageNumber}`;\n                pageHeader.appendChild(pageLink);\n                \n                const stickyPageHeader = pageHeader.cloneNode(true);\n                \n                tocList.appendChild(pageHeader);\n                stickyTocList.appendChild(stickyPageHeader);\n            }\n\n            let currentList = tocList;\n            let stickyCurrentList = stickyTocList;\n            let lastLevel = 2;\n            let lastH2Item = null;\n            let lastStickyH2Item = null;\n\n            pageHeadings.forEach((heading, idx) => {\n                const { text, level, id, page } = heading;\n                const isOnCurrentPage = page === currentPage;\n\n                const listItem = document.createElement('li');\n                const link = document.createElement('a');\n                link.textContent = text;\n                \n                // Build the correct URL\n                if (isOnCurrentPage) {\n                    link.href = `#${id}`;\n                } else {\n                    const pageUrl = page === 1 ? baseUrl : `${baseUrl}/${page}`;\n                    link.href = `${pageUrl}#${id}`;\n                }\n\n                listItem.appendChild(link);\n\n                // Mark items by page\n                if (isOnCurrentPage) {\n                    listItem.classList.add('toc-current-page');\n                } else {\n                    listItem.classList.add('toc-other-page');\n                }\n\n                const stickyItem = listItem.cloneNode(true);\n\n                // Handle nesting based on heading level\n                if (level === 2) {\n                    // H2 always goes at top level\n                    tocList.appendChild(listItem);\n                    stickyTocList.appendChild(stickyItem);\n                    lastH2Item = listItem;\n                    lastStickyH2Item = stickyItem;\n                } else {\n                    // H3+ goes nested under the last H2\n                    if (lastH2Item) {\n                        let nestedList = lastH2Item.querySelector('ul');\n                        if (!nestedList) {\n                            nestedList = createList(true);\n                            lastH2Item.appendChild(nestedList);\n                        }\n                        nestedList.appendChild(listItem);\n                    }\n                    \n                    if (lastStickyH2Item) {\n                        let stickyNestedList = lastStickyH2Item.querySelector('ul');\n                        if (!stickyNestedList) {\n                            stickyNestedList = createList(true);\n                            lastStickyH2Item.appendChild(stickyNestedList);\n                        }\n                        stickyNestedList.appendChild(stickyItem);\n                    }\n                }\n\n                // Only track headings on current page for active highlighting\n                if (isOnCurrentPage) {\n                    originalHeadingMap.set(id, listItem);\n                    stickyHeadingMap.set(id, stickyItem);\n                }\n\n                lastLevel = level;\n            });\n        });\n\n        // Wrap list in a scrollable container\n        const scrollWrapper = document.createElement('div');\n        scrollWrapper.classList.add('toc-scroll-wrapper');\n        scrollWrapper.appendChild(tocList);\n        tocWrapper.appendChild(scrollWrapper);\n\n        // Add sticky TOC before </main> only if popout is enabled\n        const mainElement = document.querySelector('main');\n        if (mainElement && enablePopout) {\n            const stickyTOC = document.createElement('div');\n            stickyTOC.classList.add('sticky-toc');\n\n            const tocTitle = document.createElement('h2');\n            tocTitle.textContent = title;\n            stickyTOC.appendChild(tocTitle);\n\n            const stickyScrollWrapper = document.createElement('div');\n            stickyScrollWrapper.classList.add('toc-scroll-wrapper');\n            stickyScrollWrapper.appendChild(stickyTocList);\n            stickyTOC.appendChild(stickyScrollWrapper);\n\n            mainElement.appendChild(stickyTOC);\n\n            return { stickyTOC, originalHeadingMap, stickyHeadingMap };\n        }\n\n        return { stickyTOC: null, originalHeadingMap, stickyHeadingMap };\n    }\n\n    const { stickyTOC, originalHeadingMap, stickyHeadingMap } = buildTOCs(headingsData) || {};\n\n    function enableSmoothScroll() {\n        document.addEventListener('click', function (event) {\n            if (event.target.tagName === 'A' && event.target.hash) {\n                const targetID = event.target.hash.substring(1);\n\n                // Only prevent default for same-page anchors\n                const linkUrl = new URL(event.target.href);\n                const currentUrl = new URL(window.location.href);\n                \n                if (linkUrl.pathname === currentUrl.pathname) {\n                    event.preventDefault();\n                    \n                    if (targetID === 'top-of-page') {\n                        window.scrollTo({ top: 0, behavior: 'smooth' });\n                        return;\n                    }\n\n                    const targetElement = document.getElementById(targetID);\n                    if (targetElement) {\n                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                    }\n                }\n            }\n        });\n    }\n    enableSmoothScroll();\n\n    function handleScroll() {\n        if (!stickyTOC) return;\n\n        const tocRect = tocWrapper.getBoundingClientRect();\n        const stickyTocRect = stickyTOC.getBoundingClientRect();\n        const postContentRect = postContent.getBoundingClientRect();\n\n        const tocShouldBeVisible = tocRect.top < 0;\n        const tocBottomHitsPostBottom = stickyTocRect.bottom >= postContentRect.bottom;\n\n        if (tocShouldBeVisible && !tocBottomHitsPostBottom) {\n            stickyTOC.classList.add('visible');\n        } else {\n            stickyTOC.classList.remove('visible');\n        }\n    }\n    window.addEventListener('scroll', handleScroll);\n\n    function normalizeText(text) {\n        // Normalize quotes and special characters for matching\n        return text\n            .replace(/[\\u2018\\u2019]/g, \"'\")  // ' ' → '\n            .replace(/[\\u201C\\u201D]/g, '\"')  // \" \" → \"\n            .replace(/\\u2013/g, '-')          // – → -\n            .replace(/\\u2014/g, '--')         // — → --\n            .trim();\n    }\n\n    function assignHeadingIDs() {\n        // Get all headings currently in the DOM (current page only)\n        const headingsInDom = Array.from(postContent.querySelectorAll(showSubheadings ? 'h2, h3, h4, h5, h6' : 'h2'))\n            .filter(heading => {\n                const text = heading.textContent.trim();\n                // Filter out TOC title and any template literals\n                return text !== title && !text.includes('${') && !text.includes('plant.');\n            });\n\n        // Get headings data for current page only\n        const currentPageHeadings = headingsData.filter(h => h.page === currentPage);\n\n        // Match DOM headings with our headings data and assign IDs\n        headingsInDom.forEach(domHeading => {\n            const headingText = normalizeText(domHeading.textContent);\n            \n            // Find matching heading in current page data\n            const matchingData = currentPageHeadings.find(data => \n                normalizeText(data.text) === headingText\n            );\n            \n            if (matchingData) {\n                domHeading.id = matchingData.id;\n            }\n        });\n\n        return headingsInDom;\n    }\n\n    const headingsInDom = assignHeadingIDs();\n\n    // Handle initial scroll to hash if present in URL\n    function scrollToHashIfPresent() {\n        const hash = window.location.hash;\n        if (hash) {\n            const targetId = hash.substring(1);\n            const targetElement = document.getElementById(targetId);\n            \n            if (targetElement) {\n                // Small delay to ensure layout is complete\n                setTimeout(() => {\n                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }, 100);\n            }\n        }\n    }\n    scrollToHashIfPresent();\n\n    function observeHeadings() {\n        if (!originalHeadingMap || !stickyHeadingMap || !headingsInDom) return;\n\n        const observer = new IntersectionObserver(entries => {\n            const isAtTop = window.scrollY < 50;\n\n            if (isAtTop && enableTopAnchor && currentPage === 1) {\n                document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                    item.classList.remove('active');\n                });\n                if (enablePopout) {\n                    document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                }\n                if (originalHeadingMap.has('top-of-page')) {\n                    originalHeadingMap.get('top-of-page').classList.add('active');\n                }\n                if (enablePopout && stickyHeadingMap.has('top-of-page')) {\n                    stickyHeadingMap.get('top-of-page').classList.add('active');\n                }\n                return;\n            }\n\n            // Find the topmost visible heading\n            let topmostEntry = null;\n            let topmostY = Infinity;\n\n            entries.forEach(entry => {\n                if (entry.isIntersecting) {\n                    const rect = entry.target.getBoundingClientRect();\n                    if (rect.top < topmostY && rect.top >= 0) {\n                        topmostY = rect.top;\n                        topmostEntry = entry;\n                    }\n                }\n            });\n\n            if (topmostEntry) {\n                const id = topmostEntry.target.id;\n                if (originalHeadingMap.has(id) && stickyHeadingMap.has(id)) {\n                    const originalTocItem = originalHeadingMap.get(id);\n                    const stickyTocItem = stickyHeadingMap.get(id);\n\n                    // Remove active from all items\n                    document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                    if (enablePopout) {\n                        document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                            item.classList.remove('active');\n                        });\n                    }\n\n                    // Add active to the topmost visible heading\n                    originalTocItem.classList.add('active');\n                    if (enablePopout) {\n                        stickyTocItem.classList.add('active');\n                    }\n                }\n            }\n        }, {\n            rootMargin: '-80px 0px -60% 0px',\n            threshold: [0, 0.1, 0.5, 1]\n        });\n\n        headingsInDom.forEach(heading => observer.observe(heading));\n    }\n\n    observeHeadings();\n});"],"names":["window","addEventListener","postContent","document","querySelector","tocWrapper","showSubheadings","dataset","listStyle","title","enablePopout","popout","enableTopAnchor","topOfContentAnchor","anchorLinkText","currentPage","parseInt","totalPages","headingsData","JSON","parse","headings","baseUrl","location","pathname","replace","createList","isSublist","createElement","ul","classList","add","buildTOCs","length","tocList","stickyTocList","originalHeadingMap","Map","stickyHeadingMap","topAnchorId","topListItem","topLink","textContent","href","appendChild","stickyTopItem","cloneNode","set","headingsByPage","forEach","heading","page","push","Object","keys","sort","a","b","pageNum","pageNumber","pageHeadings","pageHeader","className","pageLink","stickyPageHeader","currentList","stickyCurrentList","lastLevel","lastH2Item","lastStickyH2Item","idx","text","level","id","isOnCurrentPage","listItem","link","pageUrl","stickyItem","nestedList","stickyNestedList","scrollWrapper","mainElement","stickyTOC","tocTitle","stickyScrollWrapper","enableSmoothScroll","event","target","tagName","hash","targetID","substring","linkUrl","URL","currentUrl","preventDefault","scrollTo","top","behavior","targetElement","getElementById","scrollIntoView","block","handleScroll","tocRect","getBoundingClientRect","stickyTocRect","postContentRect","tocShouldBeVisible","tocBottomHitsPostBottom","bottom","remove","normalizeText","trim","assignHeadingIDs","headingsInDom","Array","from","querySelectorAll","filter","includes","currentPageHeadings","h","domHeading","headingText","matchingData","find","data","scrollToHashIfPresent","targetId","setTimeout","observeHeadings","observer","IntersectionObserver","entries","isAtTop","scrollY","item","has","get","topmostEntry","topmostY","Infinity","entry","isIntersecting","rect","originalTocItem","stickyTocItem","rootMargin","threshold","observe"],"sourceRoot":""}