{"version":3,"file":"blocks/toc-new/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/toc-new/view.js"],"sourcesContent":["window.addEventListener('load', function () {\n    const postContent = document.querySelector('.caes-hub-content-post');\n    if (!postContent) return;\n\n    const tocWrapper = document.querySelector('.wp-block-caes-hub-toc-new');\n    if (!tocWrapper) return;\n\n    const showSubheadings = tocWrapper.dataset.showSubheadings === \"1\";\n    const listStyle = tocWrapper.dataset.listStyle || \"ul\";\n    const title = tocWrapper.dataset.title || \"Table of Contents\";\n    const enablePopout = tocWrapper.dataset.popout === \"true\" || tocWrapper.dataset.popout === \"1\";\n    const enableTopAnchor = tocWrapper.dataset.topOfContentAnchor === \"true\" || tocWrapper.dataset.topOfContentAnchor === \"1\";\n    const anchorLinkText = tocWrapper.dataset.anchorLinkText || \"Top of Content\";\n    const currentPage = parseInt(tocWrapper.dataset.currentPage) || 1;\n    const totalPages = parseInt(tocWrapper.dataset.totalPages) || 1;\n    const headingsData = JSON.parse(tocWrapper.dataset.headings || '[]');\n\n    // Get base URL for building page links\n    const baseUrl = window.location.pathname.replace(/\\/\\d+\\/?$/, '');\n\n    function createList(isSublist = false) {\n        if (isSublist) {\n            return document.createElement(\"ul\");\n        }\n        if (listStyle === \"ol\") {\n            return document.createElement(\"ol\");\n        }\n        const ul = document.createElement(\"ul\");\n        if (listStyle === \"none\") {\n            ul.classList.add(\"is-style-caes-hub-list-none\");\n        }\n        return ul;\n    }\n\n    function buildTOCs(headingsData) {\n        if (headingsData.length === 0) return;\n\n        const tocList = createList();\n        const stickyTocList = createList();\n        const originalHeadingMap = new Map();\n        const stickyHeadingMap = new Map();\n\n        // Add Page 1 header first if there are multiple pages\n        if (totalPages > 1) {\n            const page1Header = document.createElement('li');\n            page1Header.className = 'toc-page-header';\n            \n            const page1Link = document.createElement('a');\n            page1Link.textContent = 'Page 1';\n            page1Link.href = baseUrl;\n            page1Header.appendChild(page1Link);\n            \n            const stickyPage1Header = page1Header.cloneNode(true);\n            \n            tocList.appendChild(page1Header);\n            stickyTocList.appendChild(stickyPage1Header);\n        }\n\n        // Add \"Top of Content\" anchor if enabled\n        if (enableTopAnchor && headingsData.length > 0) {\n            const topAnchorId = 'top-of-page';\n\n            const topListItem = document.createElement('li');\n            const topLink = document.createElement('a');\n            topLink.textContent = anchorLinkText;\n            topLink.href = currentPage === 1 ? `#${topAnchorId}` : baseUrl;\n            topListItem.appendChild(topLink);\n            topListItem.classList.add('toc-top-anchor');\n            \n            // Top anchor is only on page 1\n            if (currentPage === 1) {\n                topListItem.classList.add('toc-current-page');\n            } else {\n                topListItem.classList.add('toc-other-page');\n            }\n\n            const stickyTopItem = topListItem.cloneNode(true);\n\n            tocList.appendChild(topListItem);\n            stickyTocList.appendChild(stickyTopItem);\n\n            // Only track for active highlighting if on page 1\n            if (currentPage === 1) {\n                originalHeadingMap.set(topAnchorId, topListItem);\n                stickyHeadingMap.set(topAnchorId, stickyTopItem);\n            }\n        }\n\n        // Group headings by page\n        const headingsByPage = {};\n        headingsData.forEach(heading => {\n            if (!headingsByPage[heading.page]) {\n                headingsByPage[heading.page] = [];\n            }\n            headingsByPage[heading.page].push(heading);\n        });\n\n        // Build TOC for each page\n        Object.keys(headingsByPage).sort((a, b) => parseInt(a) - parseInt(b)).forEach(pageNum => {\n            const pageNumber = parseInt(pageNum);\n            const pageHeadings = headingsByPage[pageNum];\n\n            // Add page header for pages 2+ (page 1 was already added)\n            if (totalPages > 1 && pageNumber > 1) {\n                const pageHeader = document.createElement('li');\n                pageHeader.className = 'toc-page-header';\n                \n                const pageLink = document.createElement('a');\n                pageLink.textContent = `Page ${pageNumber}`;\n                pageLink.href = `${baseUrl}/${pageNumber}`;\n                pageHeader.appendChild(pageLink);\n                \n                const stickyPageHeader = pageHeader.cloneNode(true);\n                \n                tocList.appendChild(pageHeader);\n                stickyTocList.appendChild(stickyPageHeader);\n            }\n\n            let currentList = tocList;\n            let stickyCurrentList = stickyTocList;\n            let lastLevel = 2;\n            let lastH2Item = null;\n            let lastStickyH2Item = null;\n\n            pageHeadings.forEach((heading, idx) => {\n                const { text, level, id, page } = heading;\n                const isOnCurrentPage = page === currentPage;\n\n                const listItem = document.createElement('li');\n                const link = document.createElement('a');\n                link.textContent = text;\n                \n                // Build the correct URL\n                if (isOnCurrentPage) {\n                    link.href = `#${id}`;\n                } else {\n                    const pageUrl = page === 1 ? baseUrl : `${baseUrl}/${page}`;\n                    link.href = `${pageUrl}#${id}`;\n                }\n\n                listItem.appendChild(link);\n\n                // Mark items by page\n                if (isOnCurrentPage) {\n                    listItem.classList.add('toc-current-page');\n                } else {\n                    listItem.classList.add('toc-other-page');\n                }\n\n                const stickyItem = listItem.cloneNode(true);\n\n                // Handle nesting based on heading level\n                if (level === 2) {\n                    // H2 always goes at top level\n                    tocList.appendChild(listItem);\n                    stickyTocList.appendChild(stickyItem);\n                    lastH2Item = listItem;\n                    lastStickyH2Item = stickyItem;\n                } else {\n                    // H3+ goes nested under the last H2\n                    if (lastH2Item) {\n                        let nestedList = lastH2Item.querySelector('ul');\n                        if (!nestedList) {\n                            nestedList = createList(true);\n                            lastH2Item.appendChild(nestedList);\n                        }\n                        nestedList.appendChild(listItem);\n                    }\n                    \n                    if (lastStickyH2Item) {\n                        let stickyNestedList = lastStickyH2Item.querySelector('ul');\n                        if (!stickyNestedList) {\n                            stickyNestedList = createList(true);\n                            lastStickyH2Item.appendChild(stickyNestedList);\n                        }\n                        stickyNestedList.appendChild(stickyItem);\n                    }\n                }\n\n                // Only track headings on current page for active highlighting\n                if (isOnCurrentPage) {\n                    originalHeadingMap.set(id, listItem);\n                    stickyHeadingMap.set(id, stickyItem);\n                }\n\n                lastLevel = level;\n            });\n        });\n\n        // Wrap list in a scrollable container\n        const scrollWrapper = document.createElement('div');\n        scrollWrapper.classList.add('toc-scroll-wrapper');\n        scrollWrapper.appendChild(tocList);\n        tocWrapper.appendChild(scrollWrapper);\n\n        // Add sticky TOC before </main> only if popout is enabled\n        const mainElement = document.querySelector('main');\n        if (mainElement && enablePopout) {\n            const stickyTOC = document.createElement('div');\n            stickyTOC.classList.add('sticky-toc');\n\n            const tocTitle = document.createElement('h2');\n            tocTitle.textContent = title;\n            stickyTOC.appendChild(tocTitle);\n\n            const stickyScrollWrapper = document.createElement('div');\n            stickyScrollWrapper.classList.add('toc-scroll-wrapper');\n            stickyScrollWrapper.appendChild(stickyTocList);\n            stickyTOC.appendChild(stickyScrollWrapper);\n\n            mainElement.appendChild(stickyTOC);\n\n            return { stickyTOC, originalHeadingMap, stickyHeadingMap };\n        }\n\n        return { stickyTOC: null, originalHeadingMap, stickyHeadingMap };\n    }\n\n    const { stickyTOC, originalHeadingMap, stickyHeadingMap } = buildTOCs(headingsData) || {};\n\n    function enableSmoothScroll() {\n        document.addEventListener('click', function (event) {\n            if (event.target.tagName === 'A' && event.target.hash) {\n                const targetID = event.target.hash.substring(1);\n\n                // Only prevent default for same-page anchors\n                const linkUrl = new URL(event.target.href);\n                const currentUrl = new URL(window.location.href);\n                \n                if (linkUrl.pathname === currentUrl.pathname) {\n                    event.preventDefault();\n                    \n                    if (targetID === 'top-of-page') {\n                        window.scrollTo({ top: 0, behavior: 'smooth' });\n                        return;\n                    }\n\n                    const targetElement = document.getElementById(targetID);\n                    if (targetElement) {\n                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                    }\n                }\n            }\n        });\n    }\n    enableSmoothScroll();\n\n    function handleScroll() {\n        if (!stickyTOC) return;\n\n        const tocRect = tocWrapper.getBoundingClientRect();\n        const stickyTocRect = stickyTOC.getBoundingClientRect();\n        const postContentRect = postContent.getBoundingClientRect();\n\n        const tocShouldBeVisible = tocRect.top < 0;\n        const tocBottomHitsPostBottom = stickyTocRect.bottom >= postContentRect.bottom;\n\n        if (tocShouldBeVisible && !tocBottomHitsPostBottom) {\n            stickyTOC.classList.add('visible');\n        } else {\n            stickyTOC.classList.remove('visible');\n        }\n    }\n    window.addEventListener('scroll', handleScroll);\n\n    function normalizeText(text) {\n        // Normalize quotes and special characters for matching\n        return text\n            .replace(/[\\u2018\\u2019]/g, \"'\")  // ' ' → '\n            .replace(/[\\u201C\\u201D]/g, '\"')  // \" \" → \"\n            .replace(/\\u2013/g, '-')          // – → -\n            .replace(/\\u2014/g, '--')         // — → --\n            .trim();\n    }\n\n    function assignHeadingIDs() {\n        // Get all headings currently in the DOM (current page only)\n        const headingsInDom = Array.from(postContent.querySelectorAll(showSubheadings ? 'h2, h3, h4, h5, h6' : 'h2'))\n            .filter(heading => {\n                const text = heading.textContent.trim();\n                // Filter out TOC title and any template literals\n                return text !== title && !text.includes('${') && !text.includes('plant.');\n            });\n\n        // Get headings data for current page only\n        const currentPageHeadings = headingsData.filter(h => h.page === currentPage);\n\n        // Match DOM headings with our headings data and assign IDs\n        headingsInDom.forEach(domHeading => {\n            const headingText = normalizeText(domHeading.textContent);\n            \n            // Find matching heading in current page data\n            const matchingData = currentPageHeadings.find(data => \n                normalizeText(data.text) === headingText\n            );\n            \n            if (matchingData) {\n                domHeading.id = matchingData.id;\n            }\n        });\n\n        return headingsInDom;\n    }\n\n    const headingsInDom = assignHeadingIDs();\n\n    // Handle initial scroll to hash if present in URL\n    function scrollToHashIfPresent() {\n        const hash = window.location.hash;\n        if (hash) {\n            const targetId = hash.substring(1);\n            const targetElement = document.getElementById(targetId);\n            \n            if (targetElement) {\n                // Small delay to ensure layout is complete\n                setTimeout(() => {\n                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }, 100);\n            }\n        }\n    }\n    scrollToHashIfPresent();\n\n    function observeHeadings() {\n        if (!originalHeadingMap || !stickyHeadingMap || !headingsInDom) return;\n\n        const observer = new IntersectionObserver(entries => {\n            const isAtTop = window.scrollY < 50;\n\n            if (isAtTop && enableTopAnchor && currentPage === 1) {\n                document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                    item.classList.remove('active');\n                });\n                if (enablePopout) {\n                    document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                }\n                if (originalHeadingMap.has('top-of-page')) {\n                    originalHeadingMap.get('top-of-page').classList.add('active');\n                }\n                if (enablePopout && stickyHeadingMap.has('top-of-page')) {\n                    stickyHeadingMap.get('top-of-page').classList.add('active');\n                }\n                return;\n            }\n\n            // Find the topmost visible heading\n            let topmostEntry = null;\n            let topmostY = Infinity;\n\n            entries.forEach(entry => {\n                if (entry.isIntersecting) {\n                    const rect = entry.target.getBoundingClientRect();\n                    if (rect.top < topmostY && rect.top >= 0) {\n                        topmostY = rect.top;\n                        topmostEntry = entry;\n                    }\n                }\n            });\n\n            if (topmostEntry) {\n                const id = topmostEntry.target.id;\n                if (originalHeadingMap.has(id) && stickyHeadingMap.has(id)) {\n                    const originalTocItem = originalHeadingMap.get(id);\n                    const stickyTocItem = stickyHeadingMap.get(id);\n\n                    // Remove active from all items\n                    document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                    if (enablePopout) {\n                        document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                            item.classList.remove('active');\n                        });\n                    }\n\n                    // Add active to the topmost visible heading\n                    originalTocItem.classList.add('active');\n                    if (enablePopout) {\n                        stickyTocItem.classList.add('active');\n                    }\n                }\n            }\n        }, {\n            rootMargin: '-80px 0px -60% 0px',\n            threshold: [0, 0.1, 0.5, 1]\n        });\n\n        headingsInDom.forEach(heading => observer.observe(heading));\n    }\n\n    observeHeadings();\n});"],"names":["window","addEventListener","postContent","document","querySelector","tocWrapper","showSubheadings","dataset","listStyle","title","enablePopout","popout","enableTopAnchor","topOfContentAnchor","anchorLinkText","currentPage","parseInt","totalPages","headingsData","JSON","parse","headings","baseUrl","location","pathname","replace","createList","isSublist","createElement","ul","classList","add","buildTOCs","length","tocList","stickyTocList","originalHeadingMap","Map","stickyHeadingMap","page1Header","className","page1Link","textContent","href","appendChild","stickyPage1Header","cloneNode","topAnchorId","topListItem","topLink","stickyTopItem","set","headingsByPage","forEach","heading","page","push","Object","keys","sort","a","b","pageNum","pageNumber","pageHeadings","pageHeader","pageLink","stickyPageHeader","currentList","stickyCurrentList","lastLevel","lastH2Item","lastStickyH2Item","idx","text","level","id","isOnCurrentPage","listItem","link","pageUrl","stickyItem","nestedList","stickyNestedList","scrollWrapper","mainElement","stickyTOC","tocTitle","stickyScrollWrapper","enableSmoothScroll","event","target","tagName","hash","targetID","substring","linkUrl","URL","currentUrl","preventDefault","scrollTo","top","behavior","targetElement","getElementById","scrollIntoView","block","handleScroll","tocRect","getBoundingClientRect","stickyTocRect","postContentRect","tocShouldBeVisible","tocBottomHitsPostBottom","bottom","remove","normalizeText","trim","assignHeadingIDs","headingsInDom","Array","from","querySelectorAll","filter","includes","currentPageHeadings","h","domHeading","headingText","matchingData","find","data","scrollToHashIfPresent","targetId","setTimeout","observeHeadings","observer","IntersectionObserver","entries","isAtTop","scrollY","item","has","get","topmostEntry","topmostY","Infinity","entry","isIntersecting","rect","originalTocItem","stickyTocItem","rootMargin","threshold","observe"],"sourceRoot":""}