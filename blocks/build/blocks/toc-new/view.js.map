{"version":3,"file":"blocks/toc-new/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/toc-new/view.js"],"sourcesContent":["window.addEventListener('load', function () {\n    const postContent = document.querySelector('.caes-hub-content-post');\n    if (!postContent) return;\n\n    const tocWrapper = document.querySelector('.wp-block-caes-hub-toc-new');\n    if (!tocWrapper) return;\n\n    const showSubheadings = tocWrapper.dataset.showSubheadings === \"1\";\n    const listStyle = tocWrapper.dataset.listStyle || \"ul\";\n    const title = tocWrapper.dataset.title || \"Table of Contents\";\n    const enablePopout = tocWrapper.dataset.popout === \"true\" || tocWrapper.dataset.popout === \"1\";\n    const enableTopAnchor = tocWrapper.dataset.topOfContentAnchor === \"true\" || tocWrapper.dataset.topOfContentAnchor === \"1\";\n    const anchorLinkText = tocWrapper.dataset.anchorLinkText || \"Top of Content\";\n    const currentPage = parseInt(tocWrapper.dataset.currentPage) || 1;\n    const totalPages = parseInt(tocWrapper.dataset.totalPages) || 1;\n    const headingsData = JSON.parse(tocWrapper.dataset.headings || '[]');\n\n    // Get base URL for building page links\n    const baseUrl = window.location.pathname.replace(/\\/\\d+\\/?$/, '');\n\n    function createList(isSublist = false) {\n        if (isSublist) {\n            return document.createElement(\"ul\");\n        }\n        if (listStyle === \"ol\") {\n            return document.createElement(\"ol\");\n        }\n        const ul = document.createElement(\"ul\");\n        if (listStyle === \"none\") {\n            ul.classList.add(\"is-style-caes-hub-list-none\");\n        }\n        return ul;\n    }\n\n    function buildTOCs(headingsData) {\n        if (headingsData.length === 0) return;\n\n        const tocList = createList();\n        const stickyTocList = createList();\n        const originalHeadingMap = new Map();\n        const stickyHeadingMap = new Map();\n\n        // Add \"Top of Content\" anchor if enabled\n        if (enableTopAnchor && headingsData.length > 0) {\n            const topAnchorId = 'top-of-page';\n\n            const topListItem = document.createElement('li');\n            const topLink = document.createElement('a');\n            topLink.textContent = anchorLinkText;\n            topLink.href = currentPage === 1 ? `#${topAnchorId}` : baseUrl;\n            topListItem.appendChild(topLink);\n\n            if (currentPage !== 1) {\n                const pageIndicator = document.createElement('span');\n                pageIndicator.className = 'toc-page-indicator';\n                pageIndicator.textContent = 'Page 1';\n                topListItem.appendChild(pageIndicator);\n            }\n\n            const stickyTopItem = topListItem.cloneNode(true);\n\n            tocList.appendChild(topListItem);\n            stickyTocList.appendChild(stickyTopItem);\n\n            originalHeadingMap.set(topAnchorId, topListItem);\n            stickyHeadingMap.set(topAnchorId, stickyTopItem);\n        }\n\n        let currentList = tocList;\n        let stickyCurrentList = stickyTocList;\n        let lastLevel = 2;\n\n        headingsData.forEach(heading => {\n            const { text, level, id, page } = heading;\n            const isOnCurrentPage = page === currentPage;\n\n            const listItem = document.createElement('li');\n            const link = document.createElement('a');\n            link.textContent = text;\n            \n            // Build the correct URL\n            if (isOnCurrentPage) {\n                link.href = `#${id}`;\n            } else {\n                const pageUrl = page === 1 ? baseUrl : `${baseUrl}/${page}`;\n                link.href = `${pageUrl}#${id}`;\n            }\n\n            listItem.appendChild(link);\n\n            // Add page indicator for headings on other pages\n            if (!isOnCurrentPage && totalPages > 1) {\n                const pageIndicator = document.createElement('span');\n                pageIndicator.className = 'toc-page-indicator';\n                pageIndicator.textContent = `Page ${page}`;\n                listItem.appendChild(pageIndicator);\n                listItem.classList.add('toc-other-page');\n            } else if (isOnCurrentPage) {\n                listItem.classList.add('toc-current-page');\n            }\n\n            const stickyItem = listItem.cloneNode(true);\n\n            // Handle nesting for subheadings\n            if (level === 2) {\n                currentList = tocList;\n                stickyCurrentList = stickyTocList;\n            } else if (level > lastLevel) {\n                const newList = createList(true);\n                currentList.lastElementChild?.appendChild(newList);\n                currentList = newList;\n\n                const newStickyList = createList(true);\n                stickyCurrentList.lastElementChild?.appendChild(newStickyList);\n                stickyCurrentList = newStickyList;\n            }\n\n            currentList.appendChild(listItem);\n            stickyCurrentList.appendChild(stickyItem);\n\n            // Only track headings on current page for active highlighting\n            if (isOnCurrentPage) {\n                originalHeadingMap.set(id, listItem);\n                stickyHeadingMap.set(id, stickyItem);\n            }\n\n            lastLevel = level;\n        });\n\n        // Wrap list in a scrollable container\n        const scrollWrapper = document.createElement('div');\n        scrollWrapper.classList.add('toc-scroll-wrapper');\n        scrollWrapper.appendChild(tocList);\n        tocWrapper.appendChild(scrollWrapper);\n\n        // Add sticky TOC before </main> only if popout is enabled\n        const mainElement = document.querySelector('main');\n        if (mainElement && enablePopout) {\n            const stickyTOC = document.createElement('div');\n            stickyTOC.classList.add('sticky-toc');\n\n            const tocTitle = document.createElement('h2');\n            tocTitle.textContent = title;\n            stickyTOC.appendChild(tocTitle);\n\n            const stickyScrollWrapper = document.createElement('div');\n            stickyScrollWrapper.classList.add('toc-scroll-wrapper');\n            stickyScrollWrapper.appendChild(stickyTocList);\n            stickyTOC.appendChild(stickyScrollWrapper);\n\n            mainElement.appendChild(stickyTOC);\n\n            return { stickyTOC, originalHeadingMap, stickyHeadingMap };\n        }\n\n        return { stickyTOC: null, originalHeadingMap, stickyHeadingMap };\n    }\n\n    const { stickyTOC, originalHeadingMap, stickyHeadingMap } = buildTOCs(headingsData) || {};\n\n    function enableSmoothScroll() {\n        document.addEventListener('click', function (event) {\n            if (event.target.tagName === 'A' && event.target.hash) {\n                const targetID = event.target.hash.substring(1);\n\n                // Only prevent default for same-page anchors\n                const linkUrl = new URL(event.target.href);\n                const currentUrl = new URL(window.location.href);\n                \n                if (linkUrl.pathname === currentUrl.pathname) {\n                    event.preventDefault();\n                    \n                    if (targetID === 'top-of-page') {\n                        window.scrollTo({ top: 0, behavior: 'smooth' });\n                        return;\n                    }\n\n                    const targetElement = document.getElementById(targetID);\n                    if (targetElement) {\n                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                    }\n                }\n            }\n        });\n    }\n    enableSmoothScroll();\n\n    function handleScroll() {\n        if (!stickyTOC) return;\n\n        const tocRect = tocWrapper.getBoundingClientRect();\n        const stickyTocRect = stickyTOC.getBoundingClientRect();\n        const postContentRect = postContent.getBoundingClientRect();\n\n        const tocShouldBeVisible = tocRect.top < 0;\n        const tocBottomHitsPostBottom = stickyTocRect.bottom >= postContentRect.bottom;\n\n        if (tocShouldBeVisible && !tocBottomHitsPostBottom) {\n            stickyTOC.classList.add('visible');\n        } else {\n            stickyTOC.classList.remove('visible');\n        }\n    }\n    window.addEventListener('scroll', handleScroll);\n\n    function assignHeadingIDs() {\n        // Get all headings currently in the DOM (current page only)\n        const headingsInDom = Array.from(postContent.querySelectorAll(showSubheadings ? 'h2, h3, h4, h5, h6' : 'h2'))\n            .filter(heading => heading.textContent !== title);\n\n        // Match DOM headings with our headings data and assign IDs\n        let dataIndex = 0;\n        headingsInDom.forEach(domHeading => {\n            // Find matching heading in data for current page\n            while (dataIndex < headingsData.length) {\n                const data = headingsData[dataIndex];\n                if (data.page === currentPage && data.text === domHeading.textContent.trim()) {\n                    domHeading.id = data.id;\n                    dataIndex++;\n                    break;\n                }\n                dataIndex++;\n            }\n        });\n\n        return headingsInDom;\n    }\n\n    const headingsInDom = assignHeadingIDs();\n\n    function observeHeadings() {\n        if (!originalHeadingMap || !stickyHeadingMap || !headingsInDom) return;\n\n        const observer = new IntersectionObserver(entries => {\n            let activeSet = false;\n            const isAtTop = window.scrollY < 100;\n\n            if (isAtTop && enableTopAnchor && currentPage === 1) {\n                document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                    item.classList.remove('active');\n                });\n                if (enablePopout) {\n                    document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                        item.classList.remove('active');\n                    });\n                }\n                if (originalHeadingMap.has('top-of-page')) {\n                    originalHeadingMap.get('top-of-page').classList.add('active');\n                }\n                if (enablePopout && stickyHeadingMap.has('top-of-page')) {\n                    stickyHeadingMap.get('top-of-page').classList.add('active');\n                }\n                return;\n            }\n\n            entries.forEach(entry => {\n                const id = entry.target.id;\n                if (originalHeadingMap.has(id) && stickyHeadingMap.has(id)) {\n                    const originalTocItem = originalHeadingMap.get(id);\n                    const stickyTocItem = stickyHeadingMap.get(id);\n\n                    if (entry.isIntersecting && !activeSet) {\n                        document.querySelectorAll('.wp-block-caes-hub-toc-new li.toc-current-page').forEach(item => {\n                            item.classList.remove('active');\n                        });\n                        if (enablePopout) {\n                            document.querySelectorAll('.sticky-toc li.toc-current-page').forEach(item => {\n                                item.classList.remove('active');\n                            });\n                        }\n\n                        originalTocItem.classList.add('active');\n                        if (enablePopout) {\n                            stickyTocItem.classList.add('active');\n                        }\n                        activeSet = true;\n                    }\n                }\n            });\n        }, {\n            rootMargin: '0px 0px -80% 0px',\n            threshold: 0.1\n        });\n\n        headingsInDom.forEach(heading => observer.observe(heading));\n    }\n\n    observeHeadings();\n});"],"names":["window","addEventListener","postContent","document","querySelector","tocWrapper","showSubheadings","dataset","listStyle","title","enablePopout","popout","enableTopAnchor","topOfContentAnchor","anchorLinkText","currentPage","parseInt","totalPages","headingsData","JSON","parse","headings","baseUrl","location","pathname","replace","createList","isSublist","createElement","ul","classList","add","buildTOCs","length","tocList","stickyTocList","originalHeadingMap","Map","stickyHeadingMap","topAnchorId","topListItem","topLink","textContent","href","appendChild","pageIndicator","className","stickyTopItem","cloneNode","set","currentList","stickyCurrentList","lastLevel","forEach","heading","text","level","id","page","isOnCurrentPage","listItem","link","pageUrl","stickyItem","newList","lastElementChild","newStickyList","scrollWrapper","mainElement","stickyTOC","tocTitle","stickyScrollWrapper","enableSmoothScroll","event","target","tagName","hash","targetID","substring","linkUrl","URL","currentUrl","preventDefault","scrollTo","top","behavior","targetElement","getElementById","scrollIntoView","block","handleScroll","tocRect","getBoundingClientRect","stickyTocRect","postContentRect","tocShouldBeVisible","tocBottomHitsPostBottom","bottom","remove","assignHeadingIDs","headingsInDom","Array","from","querySelectorAll","filter","dataIndex","domHeading","data","trim","observeHeadings","observer","IntersectionObserver","entries","activeSet","isAtTop","scrollY","item","has","get","entry","originalTocItem","stickyTocItem","isIntersecting","rootMargin","threshold","observe"],"sourceRoot":""}