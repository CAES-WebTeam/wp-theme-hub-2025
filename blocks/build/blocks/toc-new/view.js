window.addEventListener("load",(function(){const e=document.querySelector(".caes-hub-content-post");if(!e)return;const t=document.querySelector(".wp-block-caes-hub-toc-new");if(!t)return;const n="1"===t.dataset.showSubheadings,o=t.dataset.listStyle||"ul",a=t.dataset.title||"Table of Contents",c="true"===t.dataset.popout||"1"===t.dataset.popout,s="true"===t.dataset.topOfContentAnchor||"1"===t.dataset.topOfContentAnchor,i=t.dataset.anchorLinkText||"Top of Content",l=Array.from(e.querySelectorAll(n?"h2, h3, h4, h5, h6":"h2")).filter((e=>e.textContent!==a));function r(e=!1){if(e)return document.createElement("ul");if("ol"===o)return document.createElement("ol");const t=document.createElement("ul");return"none"===o&&t.classList.add("is-style-caes-hub-list-none"),t}const{stickyTOC:d,originalHeadingMap:p,stickyHeadingMap:u}=function(e){if(0===e.length)return;const n=new Set,o=r(),l=r(),d=new Map,p=new Map;if(s&&e.length>0){const e="top-of-page",t=document.createElement("li"),n=document.createElement("a");n.textContent=i,n.href=`#${e}`,t.appendChild(n);const a=t.cloneNode(!0);o.appendChild(t),l.appendChild(a),d.set(e,t),p.set(e,a)}let u=o,h=l,m=2;e.forEach((e=>{const t=parseInt(e.tagName.substring(1),10),a=function(e,t){let n=e,o=2;for(;t.has(n);)n=`${e}-${o}`,o++;return t.add(n),n}(e.textContent.toString().trim().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""),n);e.id=a;const c=document.createElement("li"),s=document.createElement("a");s.textContent=e.textContent,s.href=`#${a}`,c.appendChild(s);const i=c.cloneNode(!0);if(2===t)u=o,h=l;else if(t>m){const e=r(!0);u.lastElementChild?.appendChild(e),u=e;const t=r(!0);h.lastElementChild?.appendChild(t),h=t}u.appendChild(c),h.appendChild(i),d.set(a,c),p.set(a,i),m=t}));const f=document.createElement("div");f.classList.add("toc-scroll-wrapper"),f.appendChild(o),t.appendChild(f);const g=document.querySelector("main");if(g&&c){const e=document.createElement("div");e.classList.add("sticky-toc");const t=document.createElement("h2");t.textContent=a,e.appendChild(t);const n=document.createElement("div");return n.classList.add("toc-scroll-wrapper"),n.appendChild(l),e.appendChild(n),g.appendChild(e),{stickyTOC:e,originalHeadingMap:d,stickyHeadingMap:p}}return{stickyTOC:null,originalHeadingMap:d,stickyHeadingMap:p}}(l)||{};document.addEventListener("click",(function(e){if("A"===e.target.tagName&&e.target.hash){e.preventDefault();const t=e.target.hash.substring(1);if("top-of-page"===t)return void window.scrollTo({top:0,behavior:"smooth"});const n=document.getElementById(t);n&&n.scrollIntoView({behavior:"smooth",block:"start"})}})),window.addEventListener("scroll",(function(){if(!d)return;const n=t.getBoundingClientRect(),o=d.getBoundingClientRect(),a=e.getBoundingClientRect(),c=n.top<0,s=o.bottom>=a.bottom;c&&!s?d.classList.add("visible"):d.classList.remove("visible")})),function(){if(!p||!u)return;const e=new IntersectionObserver((e=>{let t=!1;if(window.scrollY<100&&s)return document.querySelectorAll(".wp-block-caes-hub-toc-new li").forEach((e=>{e.classList.remove("active")})),c&&document.querySelectorAll(".sticky-toc li").forEach((e=>{e.classList.remove("active")})),p.has("top-of-page")&&p.get("top-of-page").classList.add("active"),void(c&&u.has("top-of-page")&&u.get("top-of-page").classList.add("active"));e.forEach((e=>{const n=e.target.id;if(p.has(n)&&u.has(n)){const o=p.get(n),a=u.get(n);e.isIntersecting&&!t&&(document.querySelectorAll(".wp-block-caes-hub-toc-new li").forEach((e=>{e.classList.remove("active")})),c&&document.querySelectorAll(".sticky-toc li").forEach((e=>{e.classList.remove("active")})),o.classList.add("active"),c&&a.classList.add("active"),t=!0)}}))}),{rootMargin:"0px 0px -80% 0px",threshold:.1});l.forEach((t=>e.observe(t)))}()}));