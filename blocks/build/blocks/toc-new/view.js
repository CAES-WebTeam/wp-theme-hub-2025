window.addEventListener("load",(function(){const e=document.querySelector(".caes-hub-content-post");if(!e)return;const t=document.querySelector(".wp-block-caes-hub-toc-new");if(!t)return;const n="1"===t.dataset.showSubheadings,o=t.dataset.listStyle||"ul",a=t.dataset.title||"Table of Contents",c="true"===t.dataset.popout||"1"===t.dataset.popout,s="true"===t.dataset.topOfContentAnchor||"1"===t.dataset.topOfContentAnchor,i=t.dataset.anchorLinkText||"Top of Content",l=parseInt(t.dataset.currentPage)||1,r=parseInt(t.dataset.totalPages)||1,d=JSON.parse(t.dataset.headings||"[]"),p=window.location.pathname.replace(/\/\d+\/?$/,"");function u(e=!1){if(e)return document.createElement("ul");if("ol"===o)return document.createElement("ol");const t=document.createElement("ul");return"none"===o&&t.classList.add("is-style-caes-hub-list-none"),t}const{stickyTOC:h,originalHeadingMap:g,stickyHeadingMap:f}=function(e){if(0===e.length)return;const n=u(),o=u(),d=new Map,h=new Map;if(r>1){const e=document.createElement("li");e.className="toc-page-header";const t=document.createElement("a");t.textContent="Page 1",t.href=p,e.appendChild(t);const a=e.cloneNode(!0);n.appendChild(e),o.appendChild(a)}if(s&&e.length>0){const e="top-of-page",t=document.createElement("li"),a=document.createElement("a");a.textContent=i,a.href=1===l?`#${e}`:p,t.appendChild(a),t.classList.add("toc-top-anchor"),1===l?t.classList.add("toc-current-page"):t.classList.add("toc-other-page");const c=t.cloneNode(!0);n.appendChild(t),o.appendChild(c),1===l&&(d.set(e,t),h.set(e,c))}const g={};e.forEach((e=>{g[e.page]||(g[e.page]=[]),g[e.page].push(e)})),Object.keys(g).sort(((e,t)=>parseInt(e)-parseInt(t))).forEach((e=>{const t=parseInt(e),a=g[e];if(r>1&&t>1){const e=document.createElement("li");e.className="toc-page-header";const a=document.createElement("a");a.textContent=`Page ${t}`,a.href=`${p}/${t}`,e.appendChild(a);const c=e.cloneNode(!0);n.appendChild(e),o.appendChild(c)}let c=2,s=null,i=null;a.forEach(((e,t)=>{const{text:a,level:r,id:g,page:f}=e,m=f===l,C=document.createElement("li"),v=document.createElement("a");if(v.textContent=a,m)v.href=`#${g}`;else{const e=1===f?p:`${p}/${f}`;v.href=`${e}#${g}`}C.appendChild(v),m?C.classList.add("toc-current-page"):C.classList.add("toc-other-page");const w=C.cloneNode(!0);if(2===r)n.appendChild(C),o.appendChild(w),s=C,i=w;else{if(s){let e=s.querySelector("ul");e||(e=u(!0),s.appendChild(e)),e.appendChild(C)}if(i){let e=i.querySelector("ul");e||(e=u(!0),i.appendChild(e)),e.appendChild(w)}}m&&(d.set(g,C),h.set(g,w)),c=r}))}));const f=document.createElement("div");f.classList.add("toc-scroll-wrapper"),f.appendChild(n),t.appendChild(f);const m=document.querySelector("main");if(m&&c){const e=document.createElement("div");e.classList.add("sticky-toc");const t=document.createElement("h2");t.textContent=a,e.appendChild(t);const n=document.createElement("div");return n.classList.add("toc-scroll-wrapper"),n.appendChild(o),e.appendChild(n),m.appendChild(e),{stickyTOC:e,originalHeadingMap:d,stickyHeadingMap:h}}return{stickyTOC:null,originalHeadingMap:d,stickyHeadingMap:h}}(d)||{};function m(e){return e.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/\u2013/g,"-").replace(/\u2014/g,"--").trim()}document.addEventListener("click",(function(e){if("A"===e.target.tagName&&e.target.hash){const t=e.target.hash.substring(1),n=new URL(e.target.href),o=new URL(window.location.href);if(n.pathname===o.pathname){if(e.preventDefault(),"top-of-page"===t)return void window.scrollTo({top:0,behavior:"smooth"});const n=document.getElementById(t);n&&n.scrollIntoView({behavior:"smooth",block:"start"})}}})),window.addEventListener("scroll",(function(){if(!h)return;const n=t.getBoundingClientRect(),o=h.getBoundingClientRect(),a=e.getBoundingClientRect(),c=n.top<0,s=o.bottom>=a.bottom;c&&!s?h.classList.add("visible"):h.classList.remove("visible")}));const C=function(){const t=Array.from(e.querySelectorAll(n?"h2, h3, h4, h5, h6":"h2")).filter((e=>{const t=e.textContent.trim();return t!==a&&!t.includes("${")&&!t.includes("plant.")})),o=d.filter((e=>e.page===l));return t.forEach((e=>{const t=m(e.textContent),n=o.find((e=>m(e.text)===t));n&&(e.id=n.id)})),t}();!function(){const e=window.location.hash;if(e){const t=e.substring(1),n=document.getElementById(t);n&&setTimeout((()=>{n.scrollIntoView({behavior:"smooth",block:"start"})}),100)}}(),function(){if(!g||!f||!C)return;const e=new IntersectionObserver((e=>{if(window.scrollY<50&&s&&1===l)return document.querySelectorAll(".wp-block-caes-hub-toc-new li.toc-current-page").forEach((e=>{e.classList.remove("active")})),c&&document.querySelectorAll(".sticky-toc li.toc-current-page").forEach((e=>{e.classList.remove("active")})),g.has("top-of-page")&&g.get("top-of-page").classList.add("active"),void(c&&f.has("top-of-page")&&f.get("top-of-page").classList.add("active"));let t=null,n=1/0;if(e.forEach((e=>{if(e.isIntersecting){const o=e.target.getBoundingClientRect();o.top<n&&o.top>=0&&(n=o.top,t=e)}})),t){const e=t.target.id;if(g.has(e)&&f.has(e)){const t=g.get(e),n=f.get(e);document.querySelectorAll(".wp-block-caes-hub-toc-new li.toc-current-page").forEach((e=>{e.classList.remove("active")})),c&&document.querySelectorAll(".sticky-toc li.toc-current-page").forEach((e=>{e.classList.remove("active")})),t.classList.add("active"),c&&n.classList.add("active")}}}),{rootMargin:"-80px 0px -60% 0px",threshold:[0,.1,.5,1]});C.forEach((t=>e.observe(t)))}()}));