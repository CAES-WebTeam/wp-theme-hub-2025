{"version":3,"file":"blocks/relevanssi-search/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/relevanssi-search/view.js"],"sourcesContent":["/**\n * This script handles the frontend interactivity for the Relevanssi Search Filters block.\n * It uses AJAX to fetch search results dynamically without page reloads.\n */\ndocument.addEventListener('DOMContentLoaded', () => {\n    const searchFilterBlocks = document.querySelectorAll('.wp-block-caes-hub-relevanssi-search');\n\n    searchFilterBlocks.forEach(block => {\n        const form = block.querySelector('.relevanssi-search-form');\n        if (!form) return;\n\n        const searchInput = form.querySelector('#relevanssi-search-input');\n        const sortByDateSelect = form.querySelector('#relevanssi-sort-by-date');\n        const postTypeSelect = form.querySelector('#relevanssi-post-type-filter');\n        const resultsContainer = block.querySelector('.relevanssi-ajax-search-results-container');\n        const blockTaxonomySlug = block.dataset.taxonomySlug || 'category';\n        const blockAllowedPostTypes = block.dataset.allowedPostTypes ? JSON.parse(block.dataset.allowedPostTypes) : [];\n\n        // Modal elements\n        const openTopicsModalButton = block.querySelector('.open-topics-modal');\n        const topicsModal = block.querySelector('#topics-modal');\n        const topicsModalCloseButton = topicsModal ? topicsModal.querySelector('.topics-modal-close') : null;\n        const applyTopicsFilterButton = topicsModal ? topicsModal.querySelector('.apply-topics-filter') : null;\n\n        // Ensure all checkbox labels have a consistent class for searching\n        if (topicsModal) {\n            topicsModal.querySelectorAll('.topics-modal-checkboxes label').forEach(label => {\n                label.classList.add('topic-checkbox-item');\n            });\n        }\n\n        // Function to update or create the search title\n        const updateSearchTitle = (searchTerm) => {\n            let titleElement = block.querySelector('.search-results-title');\n            \n            if (!titleElement) {\n                // Create title if it doesn't exist\n                titleElement = document.createElement('h1');\n                titleElement.className = 'search-results-title';\n                // Insert before the form\n                form.parentNode.insertBefore(titleElement, form);\n            }\n            \n            if (searchTerm && searchTerm.trim()) {\n                titleElement.textContent = `Search results for: \"${searchTerm.trim()}\"`;\n            } else {\n                titleElement.textContent = 'Search';\n            }\n            titleElement.style.display = 'block';\n        };\n\n        // Function to update or create the results count\n        const updateResultsCount = (count) => {\n            let countElement = block.querySelector('.search-results-count');\n            \n            if (!countElement) {\n                countElement = document.createElement('div');\n                countElement.className = 'search-results-count';\n                \n                // Insert after the selected filters container\n                const selectedContainer = block.querySelector('.selected-topic-filters');\n                if (selectedContainer) {\n                    selectedContainer.parentNode.insertBefore(countElement, selectedContainer.nextSibling);\n                } else {\n                    // Fallback: insert after the form if no filters container\n                    form.parentNode.insertBefore(countElement, form.nextSibling);\n                }\n            }\n            \n            if (count !== undefined && count !== null && count > 0) {\n                if (count === 1) {\n                    countElement.textContent = '1 result found';\n                } else {\n                    countElement.textContent = `${count} results found`;\n                }\n                countElement.style.display = 'block';\n            } else {\n                // Hide the count element when there are 0 results or count is null\n                // Let the PHP handle the \"No results found\" message\n                countElement.style.display = 'none';\n            }\n        };\n\n        // Function to fetch and display search results\n        const fetchAndDisplaySearchResults = (page = 1) => {\n            if (!resultsContainer) return;\n        \n            // Use the EXACT same beautiful plant animation structure we made together!\n            resultsContainer.innerHTML = `\n                <div class=\"plant-loading-container\">\n                    <div class=\"plant-garden\">\n                        <div class=\"plant\">\n                            <div class=\"leaf leaf-left dark\"></div>\n                            <div class=\"leaf leaf-right\"></div>\n                            <div class=\"leaf leaf-left-2\"></div>\n                            <div class=\"leaf leaf-right-2 darker\"></div>\n                            <div class=\"leaf leaf-left-3 dark\"></div>\n                            <div class=\"leaf leaf-right-3\"></div>\n                        </div>\n        \n                        <div class=\"plant-2\">\n                            <div class=\"leaf p2-leaf-left dark\"></div>\n                            <div class=\"leaf p2-leaf-right\"></div>\n                            <div class=\"leaf p2-leaf-left-2 darker\"></div>\n                            <div class=\"leaf p2-leaf-right-2\"></div>\n                        </div>\n        \n                        <div class=\"plant-3\">\n                            <div class=\"leaf p3-leaf-left\"></div>\n                            <div class=\"leaf p3-leaf-right dark\"></div>\n                            <div class=\"leaf p3-leaf-left-2 darker\"></div>\n                            <div class=\"leaf p3-leaf-right-2\"></div>\n                        </div>\n                    </div>\n                    <p class=\"loading-text\">Loading results...</p>\n                </div>\n            `;\n        \n            const formData = new FormData();\n        \n            // Security: Add nonce and action for the WordPress AJAX handler.\n            formData.append('action', 'caes_hub_search_results');\n            if (window.caesHubAjax && window.caesHubAjax.nonce) {\n                formData.append('security', caesHubAjax.nonce);\n            }\n        \n            // Collect data from form elements\n            const searchTerm = searchInput ? searchInput.value : '';\n            formData.append('s', searchTerm);\n            formData.append('paged', page);\n            formData.append('taxonomySlug', blockTaxonomySlug);\n            formData.append('allowedPostTypes', JSON.stringify(blockAllowedPostTypes));\n        \n            if (sortByDateSelect) {\n                const selectedOrder = sortByDateSelect.value;\n                if (selectedOrder === 'post_date_desc') {\n                    formData.append('orderby', 'post_date');\n                    formData.append('order', 'desc');\n                } else if (selectedOrder === 'post_date_asc') {\n                    formData.append('orderby', 'post_date');\n                    formData.append('order', 'asc');\n                } else {\n                    formData.append('orderby', 'relevance');\n                }\n            }\n        \n            if (postTypeSelect && postTypeSelect.value) {\n                formData.append('post_type', postTypeSelect.value);\n            }\n        \n            // Initialize checkedTopicSlugs outside the if block\n            let checkedTopicSlugs = [];\n        \n            if (topicsModal) {\n                checkedTopicSlugs = Array.from(topicsModal.querySelectorAll('input[type=\"checkbox\"]:checked'))\n                    .map(cb => cb.value)\n                    .filter(slug => slug !== '');\n        \n                if (checkedTopicSlugs.length > 0) {\n                    checkedTopicSlugs.forEach(slug => {\n                        formData.append(`${blockTaxonomySlug}[]`, slug);\n                    });\n                }\n            }\n        \n            // Update the search title\n            updateSearchTitle(searchTerm);\n        \n            fetch(caesHubAjax.ajaxurl, {\n                method: 'POST',\n                body: formData,\n            })\n                .then(response => {\n                    if (!response.ok) {\n                        throw new Error(`HTTP error! status: ${response.status}`);\n                    }\n                    return response.text();\n                })\n                .then(html => {\n                    resultsContainer.innerHTML = html;\n                    \n                    // Extract results count from the response\n                    let resultsCount = null;\n                    \n                    // Method 1: Look for a data attribute on the results container\n                    const resultsWrapper = resultsContainer.querySelector('[data-results-count]');\n                    if (resultsWrapper) {\n                        resultsCount = parseInt(resultsWrapper.getAttribute('data-results-count'), 10);\n                    }\n                    \n                    // Method 2: Look for a hidden input with the count\n                    const countInput = resultsContainer.querySelector('input[name=\"results_count\"]');\n                    if (countInput && resultsCount === null) {\n                        resultsCount = parseInt(countInput.value, 10);\n                    }\n                    \n                    // Method 3: Look for a specific element with the count\n                    const countElement = resultsContainer.querySelector('.wp-query-results-count');\n                    if (countElement && resultsCount === null) {\n                        resultsCount = parseInt(countElement.textContent, 10);\n                    }\n                    \n                    // Method 4: Try to parse from existing pagination or results info\n                    if (resultsCount === null) {\n                        // Look for WordPress pagination info\n                        const paginationInfo = resultsContainer.querySelector('.pagination-info, .wp-pagenavi');\n                        if (paginationInfo) {\n                            const match = paginationInfo.textContent.match(/(\\d+)\\s+(?:results?|posts?|items?)/i);\n                            if (match) {\n                                resultsCount = parseInt(match[1], 10);\n                            }\n                        }\n                    }\n                    \n                    // Method 5: Count actual result items as fallback\n                    if (resultsCount === null) {\n                        const resultItems = resultsContainer.querySelectorAll('.search-result-item, article, .post, .result-item');\n                        if (resultItems.length > 0) {\n                            // This is just the current page count, not total - but better than nothing\n                            resultsCount = resultItems.length;\n                        }\n                    }\n                    \n                    updateResultsCount(resultsCount);\n                    attachPaginationListeners();\n                })\n                .catch(error => {\n                    console.error('Error fetching search results:', error);\n                    resultsContainer.innerHTML = '<p class=\"error-message\">Error loading results. Please try again.</p>';\n                    updateResultsCount(null); // Hide count on error\n                });\n        \n            updateURL(formData);\n            renderSelectedTopicFilters(checkedTopicSlugs);\n        };\n        \n        \n\n        // Function to update the browser URL\n        const updateURL = (formData) => {\n            const params = new URLSearchParams();\n            // Create a clean set of params for the URL\n            for (const [key, value] of formData.entries()) {\n                // IMPORTANT: Removed 'paged' from the exclusion list so it's included in the URL\n                if (!['action', 'security', 'allowedPostTypes'].includes(key)) {\n                    // Handle array parameters like taxonomy slugs\n                    if (key.endsWith('[]')) {\n                        const paramName = key.slice(0, -2);\n                        // Append multiple values for the same parameter name\n                        params.append(paramName, value);\n                    } else {\n                        params.set(key, value);\n                    }\n                }\n            }\n            const newUrl = `${window.location.pathname}?${params.toString()}`;\n            window.history.pushState({ path: newUrl }, '', newUrl);\n        };\n\n        const renderSelectedTopicFilters = (slugs) => {\n            const selectedContainer = block.querySelector('.selected-topic-filters');\n            if (!selectedContainer) return;\n        \n            selectedContainer.innerHTML = ''; // Clear old pills\n        \n            if (!slugs.length) return;\n        \n            // Add \"Filters applied:\" text\n            const filtersLabel = document.createElement('span');\n            filtersLabel.textContent = 'Filters applied:';\n            filtersLabel.className = 'filters-applied-label';\n            selectedContainer.appendChild(filtersLabel);\n        \n            // Create container for the filter pills and clear button\n            const filtersWrapper = document.createElement('div');\n            filtersWrapper.className = 'filters-wrapper';\n        \n            slugs.forEach(slug => {\n                const checkbox = topicsModal.querySelector(`input[value=\"${slug}\"]`);\n                const label = checkbox?.parentElement?.textContent.trim() || slug;\n        \n                const pill = document.createElement('div');\n                pill.className = 'topic-pill';\n        \n                const textSpan = document.createElement('span');\n                textSpan.textContent = label;\n        \n                const removeBtn = document.createElement('button');\n                removeBtn.setAttribute('type', 'button');\n                removeBtn.setAttribute('aria-label', `Remove filter ${label}`);\n                removeBtn.innerHTML = '&times;';\n                removeBtn.addEventListener('click', () => {\n                    if (checkbox) checkbox.checked = false;\n                    fetchAndDisplaySearchResults();\n                });\n        \n                pill.appendChild(textSpan);\n                pill.appendChild(removeBtn);\n                filtersWrapper.appendChild(pill);\n            });\n        \n            const clearAllBtn = document.createElement('button');\n            clearAllBtn.textContent = 'Clear all';\n            clearAllBtn.className = 'clear-all';\n            clearAllBtn.setAttribute('type', 'button');\n            clearAllBtn.setAttribute('aria-label', 'Clear all selected filters');\n            clearAllBtn.addEventListener('click', () => {\n                topicsModal.querySelectorAll('input[type=\"checkbox\"]:checked').forEach(cb => cb.checked = false);\n                fetchAndDisplaySearchResults();\n            });\n        \n            filtersWrapper.appendChild(clearAllBtn);\n            selectedContainer.appendChild(filtersWrapper);\n        };\n\n        // Function to handle pagination clicks\n        const attachPaginationListeners = () => {\n            resultsContainer.querySelectorAll('.page-numbers').forEach(link => {\n                link.addEventListener('click', e => {\n                    e.preventDefault();\n                    const url = new URL(link.href);\n                    let page = 1; // Default to page 1\n\n                    // Attempt to get 'paged' from query parameters first (if any)\n                    if (url.searchParams.has('paged')) {\n                        page = parseInt(url.searchParams.get('paged'), 10) || 1;\n                    } else {\n                        // If 'paged' not in query params, try to extract from path (e.g., /page/2/)\n                        const pathSegments = url.pathname.split('/');\n                        const pageIndex = pathSegments.indexOf('page');\n                        if (pageIndex > -1 && pageIndex + 1 < pathSegments.length) {\n                            const pageNum = parseInt(pathSegments[pageIndex + 1], 10);\n                            if (!isNaN(pageNum) && pageNum > 0) {\n                                page = pageNum;\n                            }\n                        }\n                    }\n\n                    fetchAndDisplaySearchResults(page); // Pass the extracted page number\n                });\n            });\n        };\n\n        // Check for initial results count on page load\n        const extractInitialResultsCount = () => {\n            let resultsCount = null;\n            \n            // Try the same methods as in fetchAndDisplaySearchResults\n            const resultsWrapper = resultsContainer.querySelector('[data-results-count]');\n            if (resultsWrapper) {\n                resultsCount = parseInt(resultsWrapper.getAttribute('data-results-count'), 10);\n            }\n            \n            if (resultsCount === null) {\n                const countInput = resultsContainer.querySelector('input[name=\"results_count\"]');\n                if (countInput) {\n                    resultsCount = parseInt(countInput.value, 10);\n                }\n            }\n            \n            if (resultsCount === null) {\n                const countElement = resultsContainer.querySelector('.wp-query-results-count');\n                if (countElement) {\n                    resultsCount = parseInt(countElement.textContent, 10);\n                }\n            }\n            \n            if (resultsCount !== null) {\n                updateResultsCount(resultsCount);\n            }\n        };\n\n        // Initialize on page load\n        const urlParams = new URLSearchParams(window.location.search);\n        if (\n            urlParams.has('s') ||\n            urlParams.has('orderby') ||\n            urlParams.has('post_type') ||\n            urlParams.getAll(blockTaxonomySlug).length\n        ) {\n            fetchAndDisplaySearchResults();\n        }\n\n        // Update search title on initial page load (always show an H1)\n        const initialSearchTerm = searchInput ? searchInput.value : '';\n        updateSearchTitle(initialSearchTerm);\n\n        // Call this on initial page load if there are existing results\n        if (resultsContainer && resultsContainer.children.length > 0) {\n            extractInitialResultsCount();\n        }\n\n        form.addEventListener('submit', (e) => {\n            e.preventDefault();\n            fetchAndDisplaySearchResults();\n        });\n\n        if (sortByDateSelect) sortByDateSelect.addEventListener('change', () => fetchAndDisplaySearchResults());\n        if (postTypeSelect) postTypeSelect.addEventListener('change', () => fetchAndDisplaySearchResults());\n\n        // --- Modal Logic ---\n        if (openTopicsModalButton && topicsModal) {\n            let previouslyFocusedElement;\n\n            // Helper to get all tabbable elements within the modal\n            const getTabbableElements = () => {\n                return Array.from(topicsModal.querySelectorAll(\n                    'a[href]:not([disabled]), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"]):not([disabled])'\n                )).filter(el => el.offsetWidth > 0 || el.offsetHeight > 0); // Filter out hidden elements\n            };\n\n            const trapFocus = (e) => {\n                const tabbableElements = getTabbableElements();\n                if (tabbableElements.length === 0) return; // No tabbable elements, nothing to trap\n\n                const firstTabbableElement = tabbableElements[0];\n                const lastTabbableElement = tabbableElements[tabbableElements.length - 1];\n\n                if (e.key === 'Tab') {\n                    if (e.shiftKey) { // Shift + Tab\n                        if (document.activeElement === firstTabbableElement) {\n                            lastTabbableElement.focus();\n                            e.preventDefault();\n                        }\n                    } else { // Tab\n                        if (document.activeElement === lastTabbableElement) {\n                            firstTabbableElement.focus();\n                            e.preventDefault();\n                        }\n                    }\n                } else if (e.key === 'Escape') {\n                    closeModal();\n                }\n            };\n\n            const openModal = () => {\n                previouslyFocusedElement = document.activeElement;\n                topicsModal.style.display = 'flex';\n                openTopicsModalButton.setAttribute('aria-expanded', 'true');\n                topicsModal.removeAttribute('aria-hidden');\n\n                // Set focus to the first tabbable element inside the modal\n                const tabbableElements = getTabbableElements();\n                if (tabbableElements.length > 0) {\n                    tabbableElements[0].focus();\n                }\n\n                document.addEventListener('keydown', trapFocus);\n            };\n\n            const closeModal = () => {\n                topicsModal.style.display = 'none';\n                openTopicsModalButton.setAttribute('aria-expanded', 'false');\n                topicsModal.setAttribute('aria-hidden', 'true');\n\n                document.removeEventListener('keydown', trapFocus);\n                if (previouslyFocusedElement) {\n                    previouslyFocusedElement.focus();\n                }\n            };\n\n            openTopicsModalButton.addEventListener('click', openModal);\n\n            if (topicsModalCloseButton) {\n                topicsModalCloseButton.addEventListener('click', closeModal);\n            }\n\n            if (applyTopicsFilterButton) {\n                applyTopicsFilterButton.addEventListener('click', () => {\n                    fetchAndDisplaySearchResults();\n                    closeModal();\n                });\n            } else {\n                // Fallback if no specific 'Apply Filter' button (though recommended to have one)\n                topicsModal.querySelectorAll('input[type=\"checkbox\"]').forEach(checkbox => {\n                    checkbox.addEventListener('change', () => {\n                        fetchAndDisplaySearchResults();\n                        // Consider if you want to close the modal here or only with an explicit apply button\n                        // If you uncomment closeModal(), users might find it jarring if modal closes on every click.\n                        // closeModal();\n                    });\n                });\n            }\n\n            // Close modal if clicking outside of it\n            window.addEventListener('click', (event) => {\n                if (event.target === topicsModal) {\n                    closeModal();\n                }\n            });\n\n            // Topic search inside the modal\n            const topicSearchInput = topicsModal.querySelector('.topics-modal-search-input');\n            if (topicSearchInput) {\n                topicSearchInput.addEventListener('input', (e) => {\n                    const searchTerm = e.target.value.toLowerCase();\n                    topicsModal.querySelectorAll('.topic-checkbox-item').forEach(item => {\n                        const label = item.textContent.toLowerCase();\n                        item.style.display = label.includes(searchTerm) ? '' : 'none';\n                    });\n                });\n            }\n        }\n        \n        attachPaginationListeners();\n    });\n});"],"names":["document","addEventListener","searchFilterBlocks","querySelectorAll","forEach","block","form","querySelector","searchInput","sortByDateSelect","postTypeSelect","resultsContainer","blockTaxonomySlug","dataset","taxonomySlug","blockAllowedPostTypes","allowedPostTypes","JSON","parse","openTopicsModalButton","topicsModal","topicsModalCloseButton","applyTopicsFilterButton","label","classList","add","updateSearchTitle","searchTerm","titleElement","createElement","className","parentNode","insertBefore","trim","textContent","style","display","updateResultsCount","count","countElement","selectedContainer","nextSibling","undefined","fetchAndDisplaySearchResults","page","innerHTML","formData","FormData","append","window","caesHubAjax","nonce","value","stringify","selectedOrder","checkedTopicSlugs","Array","from","map","cb","filter","slug","length","fetch","ajaxurl","method","body","then","response","ok","Error","status","text","html","resultsCount","resultsWrapper","parseInt","getAttribute","countInput","paginationInfo","match","resultItems","attachPaginationListeners","catch","error","console","updateURL","renderSelectedTopicFilters","params","URLSearchParams","key","entries","includes","endsWith","paramName","slice","set","newUrl","location","pathname","toString","history","pushState","path","slugs","filtersLabel","appendChild","filtersWrapper","checkbox","parentElement","pill","textSpan","removeBtn","setAttribute","checked","clearAllBtn","link","e","preventDefault","url","URL","href","searchParams","has","get","pathSegments","split","pageIndex","indexOf","pageNum","isNaN","extractInitialResultsCount","urlParams","search","getAll","initialSearchTerm","children","previouslyFocusedElement","getTabbableElements","el","offsetWidth","offsetHeight","trapFocus","tabbableElements","firstTabbableElement","lastTabbableElement","shiftKey","activeElement","focus","closeModal","openModal","removeAttribute","removeEventListener","event","target","topicSearchInput","toLowerCase","item"],"sourceRoot":""}