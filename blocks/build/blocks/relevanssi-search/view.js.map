{"version":3,"file":"blocks/relevanssi-search/view.js","mappings":"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","sources":["webpack://theme-blocks/./src/blocks/relevanssi-search/view.js"],"sourcesContent":["/**\n * This script handles the frontend interactivity for the Relevanssi Search Filters block.\n * It uses AJAX to fetch search results dynamically without page reloads for full results blocks,\n * and allows normal form submission for search-only blocks that redirect to a results page.\n */\ndocument.addEventListener('DOMContentLoaded', () => {\n    const searchFilterBlocks = document.querySelectorAll('.wp-block-caes-hub-relevanssi-search');\n\n    searchFilterBlocks.forEach(block => {\n        const form = block.querySelector('.relevanssi-search-form');\n        if (!form) return;\n\n        // Get block configuration from data attributes\n        const resultsPageUrl = block.dataset.resultsPageUrl || '';\n        const isSearchOnlyBlock = resultsPageUrl !== '';\n        const showHeading = block.dataset.showHeading === 'true';\n\n        const searchInput = form.querySelector('#relevanssi-search-input');\n        const sortByDateSelect = form.querySelector('#relevanssi-sort-by-date');\n        const postTypeSelect = form.querySelector('#relevanssi-post-type-filter');\n        const languageSelect = form.querySelector('#relevanssi-language-filter');\n        const resultsContainer = block.querySelector('.relevanssi-ajax-search-results-container');\n        const blockTaxonomySlug = block.dataset.taxonomySlug || 'category';\n        const blockAllowedPostTypes = block.dataset.allowedPostTypes ? JSON.parse(block.dataset.allowedPostTypes) : [];\n        const showLanguageFilter = block.dataset.showLanguageFilter === 'true';\n\n        // Modal elements - Topics (only exist for full results blocks)\n        const openTopicsModalButton = block.querySelector('.open-topics-modal');\n        const topicsModal = block.querySelector('#topics-modal');\n        const topicsModalCloseButton = topicsModal ? topicsModal.querySelector('.topics-modal-close') : null;\n        const applyTopicsFilterButton = topicsModal ? topicsModal.querySelector('.apply-topics-filter') : null;\n\n        // Modal elements - Authors (only exist for full results blocks)\n        const openAuthorsModalButton = block.querySelector('.open-authors-modal');\n        const authorsModal = block.querySelector('#authors-modal');\n        const authorsModalCloseButton = authorsModal ? authorsModal.querySelector('.authors-modal-close') : null;\n        const applyAuthorsFilterButton = authorsModal ? authorsModal.querySelector('.apply-authors-filter') : null;\n\n        // If this is a search-only block, set up simple form submission and exit\n        if (isSearchOnlyBlock) {\n            // For search-only blocks, allow normal form submission (no preventDefault)\n            // The form action is already set to the results page URL in render.php\n            form.addEventListener('submit', (e) => {\n                // Let the form submit normally - no AJAX needed\n                // The browser will navigate to the results page with the search query\n            });\n            \n            // Update search title on initial page load for consistency (only if heading is enabled)\n            if (showHeading) {\n                const initialSearchTerm = searchInput ? searchInput.value : '';\n                updateSearchTitle(initialSearchTerm);\n            }\n            \n            return; // Exit early - no need to set up AJAX or advanced features\n        }\n\n        // The rest of this code only runs for full results blocks (no resultsPageUrl)\n        \n        // Ensure all checkbox labels have a consistent class for searching\n        if (topicsModal) {\n            topicsModal.querySelectorAll('.topics-modal-checkboxes label').forEach(label => {\n                label.classList.add('topic-checkbox-item');\n            });\n        }\n\n        if (authorsModal) {\n            authorsModal.querySelectorAll('.authors-modal-checkboxes label').forEach(label => {\n                label.classList.add('author-checkbox-item');\n            });\n        }\n\n        // Function to update the search title (H1 only) - only if heading is enabled\n        const updateSearchTitle = (searchTerm) => {\n            if (!showHeading) return; // Don't create or update heading if it's disabled\n\n            let titleElement = block.querySelector('.search-results-title');\n\n            if (!titleElement) {\n                // Create title if it doesn't exist and heading is enabled\n                titleElement = document.createElement('h1');\n                titleElement.className = 'search-results-title';\n                // Insert before the form\n                form.parentNode.insertBefore(titleElement, form);\n            }\n\n            // H1 is always just the base heading\n            const customHeading = block.getAttribute('data-custom-heading');\n            const baseHeading = customHeading || 'Search';\n            titleElement.textContent = baseHeading;\n            titleElement.style.display = 'block';\n        };\n\n        // Function to update the H2 results heading (called after AJAX response)\n        const updateResultsHeading = (searchTerm) => {\n            let existingHeading = block.querySelector('.search-results-heading');\n            if (existingHeading) {\n                existingHeading.remove();\n            }\n\n            if (searchTerm && searchTerm.trim()) {\n                const resultsHeading = document.createElement('h2');\n                resultsHeading.className = 'search-results-heading';\n                resultsHeading.textContent = `Results for: \"${searchTerm.trim()}\"`;\n                resultsHeading.style.display = 'block';\n\n                // Find the selected filters container\n                const selectedContainer = block.querySelector('.selected-topic-filters');\n\n                // Insert AFTER the selected filters container if it exists and has content,\n                // otherwise, insert after the form.\n                if (selectedContainer && selectedContainer.children.length > 0) {\n                    selectedContainer.parentNode.insertBefore(resultsHeading, selectedContainer.nextSibling);\n                } else if (form) {\n                    form.parentNode.insertBefore(resultsHeading, form.nextSibling);\n                } else {\n                    // Fallback if neither exists\n                    block.prepend(resultsHeading);\n                }\n            }\n        };\n\n        // Function to update or create the results count\n        const updateResultsCount = (count) => {\n            let countElement = block.querySelector('.search-results-count');\n            const resultsHeading = block.querySelector('.search-results-heading'); // Get the H2 element\n\n            if (!countElement) {\n                countElement = document.createElement('div');\n                countElement.className = 'search-results-count';\n\n                // Insert AFTER the results heading (H2) if it exists\n                if (resultsHeading) {\n                    resultsHeading.parentNode.insertBefore(countElement, resultsHeading.nextSibling);\n                } else {\n                    // Fallback: if no H2 (e.g., no search term), insert after selected filters or form\n                    const selectedContainer = block.querySelector('.selected-topic-filters');\n                    if (selectedContainer) {\n                        selectedContainer.parentNode.insertBefore(countElement, selectedContainer.nextSibling);\n                    } else {\n                        form.parentNode.insertBefore(countElement, form.nextSibling);\n                    }\n                }\n            }\n\n            if (count !== undefined && count !== null && count > 0) {\n                if (count === 1) {\n                    countElement.textContent = '1 result found';\n                } else {\n                    countElement.textContent = `${count} results found`;\n                }\n                countElement.style.display = 'block';\n            } else {\n                countElement.style.display = 'none';\n            }\n        };\n\n        // Function to fetch and display search results\n        const fetchAndDisplaySearchResults = (page = 1) => {\n            if (!resultsContainer) return;\n\n            // Use the EXACT same beautiful plant animation structure from the original!\n            resultsContainer.innerHTML = `\n                <div class=\"plant-loading-container\">\n                    <div class=\"plant-garden\">\n                        <div class=\"plant\">\n                            <div class=\"leaf leaf-left dark\"></div>\n                            <div class=\"leaf leaf-right\"></div>\n                            <div class=\"leaf leaf-left-2\"></div>\n                            <div class=\"leaf leaf-right-2 darker\"></div>\n                            <div class=\"leaf leaf-left-3 dark\"></div>\n                            <div class=\"leaf leaf-right-3\"></div>\n                            <div class=\"leaf leaf-left-4\"></div>\n                            <div class=\"leaf leaf-right-4 dark\"></div>\n                            <div class=\"leaf leaf-left-5 darker\"></div>\n                            <div class=\"leaf leaf-right-5\"></div>\n                        </div>\n        \n                        <div class=\"plant-2\">\n                            <div class=\"leaf p2-leaf-left dark\"></div>\n                            <div class=\"leaf p2-leaf-right\"></div>\n                            <div class=\"leaf p2-leaf-left-2 darker\"></div>\n                            <div class=\"leaf p2-leaf-right-2\"></div>\n                            <div class=\"leaf p2-leaf-left-3 dark\"></div>\n                            <div class=\"leaf p2-leaf-right-3\"></div>\n                        </div>\n        \n                        <div class=\"plant-3\">\n                            <div class=\"leaf p3-leaf-left\"></div>\n                            <div class=\"leaf p3-leaf-right dark\"></div>\n                            <div class=\"leaf p3-leaf-left-2 darker\"></div>\n                            <div class=\"leaf p3-leaf-right-2\"></div>\n                            <div class=\"leaf p3-leaf-left-3 dark\"></div>\n                            <div class=\"leaf p3-leaf-right-3\"></div>\n                            <div class=\"leaf p3-leaf-left-4\"></div>\n                            <div class=\"leaf p3-leaf-right-4 darker\"></div>\n                        </div>\n                    </div>\n                    <p class=\"loading-text\">Loading results...</p>\n                </div>\n            `;\n\n            const formData = new FormData();\n\n            // Security: Add nonce and action for the WordPress AJAX handler.\n            formData.append('action', 'caes_hub_search_results');\n            if (window.caesHubAjax && window.caesHubAjax.nonce) {\n                formData.append('security', caesHubAjax.nonce);\n            }\n\n            // Collect data from form elements\n            const searchTerm = searchInput ? searchInput.value : '';\n            formData.append('s', searchTerm);\n            formData.append('paged', page);\n            formData.append('taxonomySlug', blockTaxonomySlug);\n            formData.append('allowedPostTypes', JSON.stringify(blockAllowedPostTypes));\n\n            // Pass filter toggle states\n            formData.append('showDateSort', sortByDateSelect ? 'true' : 'false');\n            formData.append('showPostTypeFilter', postTypeSelect ? 'true' : 'false');\n            formData.append('showTopicFilter', topicsModal ? 'true' : 'false');\n            formData.append('showAuthorFilter', authorsModal ? 'true' : 'false');\n            formData.append('showLanguageFilter', showLanguageFilter ? 'true' : 'false');\n\n            if (sortByDateSelect) {\n                const selectedOrder = sortByDateSelect.value;\n                if (selectedOrder === 'post_date_desc') {\n                    formData.append('orderby', 'post_date');\n                    formData.append('order', 'desc');\n                } else if (selectedOrder === 'post_date_asc') {\n                    formData.append('orderby', 'post_date');\n                    formData.append('order', 'asc');\n                } else {\n                    formData.append('orderby', 'relevance');\n                }\n            }\n\n            if (postTypeSelect && postTypeSelect.value) {\n                formData.append('post_type', postTypeSelect.value);\n            }\n\n            // Handle language selection\n            if (languageSelect && languageSelect.value) {\n                formData.append('language', languageSelect.value);\n            }\n\n            // Initialize checkedTopicSlugs outside the if block\n            let checkedTopicSlugs = [];\n\n            if (topicsModal) {\n                checkedTopicSlugs = Array.from(topicsModal.querySelectorAll('input[type=\"checkbox\"]:checked'))\n                    .map(cb => cb.value)\n                    .filter(slug => slug !== '');\n\n                if (checkedTopicSlugs.length > 0) {\n                    checkedTopicSlugs.forEach(slug => {\n                        formData.append(`${blockTaxonomySlug}[]`, slug);\n                    });\n                }\n            }\n\n            // Initialize checkedAuthorSlugs for authors filter - using SLUGS instead of IDs\n            let checkedAuthorSlugs = [];\n\n            if (authorsModal) {\n                checkedAuthorSlugs = Array.from(authorsModal.querySelectorAll('input[type=\"checkbox\"]:checked'))\n                    .map(cb => cb.value)\n                    .filter(slug => slug !== '');\n\n                if (checkedAuthorSlugs.length > 0) {\n                    checkedAuthorSlugs.forEach(slug => {\n                        formData.append('author_slug[]', slug); // Use author_slug[] instead of author[]\n                    });\n                }\n            }\n\n            // Update the search title (H1 only) - only if heading is enabled\n            if (showHeading) {\n                updateSearchTitle(searchTerm);\n            }\n\n            // Track when the fetch starts and ensure minimum display time for animation\n            const fetchStartTime = Date.now();\n            const minimumDisplayTime = 0;\n\n            fetch(caesHubAjax.ajaxurl, {\n                method: 'POST',\n                body: formData,\n            })\n                .then(response => {\n                    if (!response.ok) {\n                        throw new Error(`HTTP error! status: ${response.status}`);\n                    }\n                    return response.text();\n                })\n                .then(html => {\n                    const fetchEndTime = Date.now();\n                    const elapsedTime = fetchEndTime - fetchStartTime;\n                    const remainingTime = Math.max(0, minimumDisplayTime - elapsedTime);\n\n                    // Wait for the remaining time before showing results\n                    setTimeout(() => {\n\n                        // Scroll the user back to the top of the search block.\n                        block.scrollIntoView();\n\n                        resultsContainer.innerHTML = html;\n\n                        // Update the H2 results heading AFTER DOM is updated\n                        updateResultsHeading(searchTerm);\n\n                        // Extract results count from the response\n                        let resultsCount = null;\n\n                        // Method 1: Look for a data attribute on the results container\n                        const resultsWrapper = resultsContainer.querySelector('[data-results-count]');\n                        if (resultsWrapper) {\n                            resultsCount = parseInt(resultsWrapper.getAttribute('data-results-count'), 10);\n                        }\n\n                        // Method 2: Look for a hidden input with the count\n                        const countInput = resultsContainer.querySelector('input[name=\"results_count\"]');\n                        if (countInput && resultsCount === null) {\n                            resultsCount = parseInt(countInput.value, 10);\n                        }\n\n                        // Method 3: Look for a specific element with the count\n                        const countElement = resultsContainer.querySelector('.wp-query-results-count');\n                        if (countElement && resultsCount === null) {\n                            resultsCount = parseInt(countElement.textContent, 10);\n                        }\n\n                        // Method 4: Try to parse from existing pagination or results info\n                        if (resultsCount === null) {\n                            // Look for WordPress pagination info\n                            const paginationInfo = resultsContainer.querySelector('.pagination-info, .wp-pagenavi');\n                            if (paginationInfo) {\n                                const match = paginationInfo.textContent.match(/(\\d+)\\s+(?:results?|posts?|items?)/i);\n                                if (match) {\n                                    resultsCount = parseInt(match[1], 10);\n                                }\n                            }\n                        }\n\n                        // Method 5: Count actual result items as fallback\n                        if (resultsCount === null) {\n                            const resultItems = resultsContainer.querySelectorAll('.search-result-item, article, .post, .result-item');\n                            if (resultItems.length > 0) {\n                                // This is just the current page count, not total - but better than nothing\n                                resultsCount = resultItems.length;\n                            }\n                        }\n\n                        updateResultsCount(resultsCount);\n                        attachPaginationListeners();\n                    }, remainingTime);\n                })\n                .catch(error => {\n                    console.error('Error fetching search results:', error);\n                    // Still respect minimum time even on error\n                    const fetchEndTime = Date.now();\n                    const elapsedTime = fetchEndTime - fetchStartTime;\n                    const remainingTime = Math.max(0, minimumDisplayTime - elapsedTime);\n\n                    setTimeout(() => {\n                        resultsContainer.innerHTML = '<p class=\"error-message\">Error loading results. Please try again.</p>';\n                        updateResultsCount(null); // Hide count on error\n                    }, remainingTime);\n                });\n\n            updateURL(formData);\n            renderSelectedFilters(checkedTopicSlugs, checkedAuthorSlugs);\n        };\n\n        // Function to update the browser URL\n        const updateURL = (formData) => {\n            const params = new URLSearchParams();\n            // Create a clean set of params for the URL\n            for (const [key, value] of formData.entries()) {\n                // IMPORTANT: Removed 'paged' from the exclusion list so it's included in the URL\n                if (!['action', 'security', 'allowedPostTypes', 'showDateSort', 'showPostTypeFilter', 'showTopicFilter', 'showAuthorFilter', 'showLanguageFilter'].includes(key)) {\n                    // Handle array parameters like taxonomy slugs and author slugs\n                    if (key.endsWith('[]')) {\n                        const paramName = key.slice(0, -2);\n                        // Append multiple values for the same parameter name\n                        params.append(paramName, value);\n                    } else {\n                        params.set(key, value);\n                    }\n                }\n            }\n            const newUrl = `${window.location.pathname}?${params.toString()}`;\n            window.history.pushState({ path: newUrl }, '', newUrl);\n        };\n\n        const renderSelectedFilters = (topicSlugs, authorSlugs) => {\n            const selectedContainer = block.querySelector('.selected-topic-filters');\n            if (!selectedContainer) return;\n\n            selectedContainer.innerHTML = ''; // Clear old pills\n\n            const hasTopicFilters = topicSlugs && topicSlugs.length > 0;\n            const hasAuthorFilters = authorSlugs && authorSlugs.length > 0;\n\n            if (!hasTopicFilters && !hasAuthorFilters) return;\n\n            // Add \"Filters applied:\" text\n            const filtersLabel = document.createElement('span');\n            filtersLabel.textContent = 'Filters applied:';\n            filtersLabel.className = 'filters-applied-label';\n            selectedContainer.appendChild(filtersLabel);\n\n            // Create container for the filter pills and clear button\n            const filtersWrapper = document.createElement('div');\n            filtersWrapper.className = 'filters-wrapper';\n\n            // Render topic filter pills\n            if (hasTopicFilters) {\n                topicSlugs.forEach(slug => {\n                    const checkbox = topicsModal.querySelector(`input[value=\"${slug}\"]`);\n                    const label = checkbox?.parentElement?.textContent.trim() || slug;\n\n                    const pill = document.createElement('div');\n                    pill.className = 'topic-pill';\n\n                    const textSpan = document.createElement('span');\n                    textSpan.textContent = label;\n\n                    const removeBtn = document.createElement('button');\n                    removeBtn.setAttribute('type', 'button');\n                    removeBtn.setAttribute('aria-label', `Remove filter ${label}`);\n                    removeBtn.innerHTML = '&times;';\n                    removeBtn.addEventListener('click', () => {\n                        if (checkbox) checkbox.checked = false;\n                        fetchAndDisplaySearchResults();\n                    });\n\n                    pill.appendChild(textSpan);\n                    pill.appendChild(removeBtn);\n                    filtersWrapper.appendChild(pill);\n                });\n            }\n\n            // Render author filter pills - now using author slugs\n            if (hasAuthorFilters) {\n                authorSlugs.forEach(slug => {\n                    const checkbox = authorsModal.querySelector(`input[value=\"${slug}\"]`);\n                    const label = checkbox?.parentElement?.textContent.trim() || slug;\n\n                    const pill = document.createElement('div');\n                    pill.className = 'author-pill';\n\n                    const textSpan = document.createElement('span');\n                    textSpan.textContent = label;\n\n                    const removeBtn = document.createElement('button');\n                    removeBtn.setAttribute('type', 'button');\n                    removeBtn.setAttribute('aria-label', `Remove filter ${label}`);\n                    removeBtn.innerHTML = '&times;';\n                    removeBtn.addEventListener('click', () => {\n                        if (checkbox) checkbox.checked = false;\n                        fetchAndDisplaySearchResults();\n                    });\n\n                    pill.appendChild(textSpan);\n                    pill.appendChild(removeBtn);\n                    filtersWrapper.appendChild(pill);\n                });\n            }\n\n            const clearAllBtn = document.createElement('button');\n            clearAllBtn.textContent = 'Clear all';\n            clearAllBtn.className = 'clear-all';\n            clearAllBtn.setAttribute('type', 'button');\n            clearAllBtn.setAttribute('aria-label', 'Clear all selected filters');\n            clearAllBtn.addEventListener('click', () => {\n                if (topicsModal) {\n                    topicsModal.querySelectorAll('input[type=\"checkbox\"]:checked').forEach(cb => cb.checked = false);\n                }\n                if (authorsModal) {\n                    authorsModal.querySelectorAll('input[type=\"checkbox\"]:checked').forEach(cb => cb.checked = false);\n                }\n                fetchAndDisplaySearchResults();\n            });\n\n            filtersWrapper.appendChild(clearAllBtn);\n            selectedContainer.appendChild(filtersWrapper);\n        };\n\n        // Function to handle pagination clicks\n        const attachPaginationListeners = () => {\n            if (!resultsContainer) return;\n            \n            resultsContainer.querySelectorAll('.page-numbers').forEach(link => {\n                link.addEventListener('click', e => {\n                    e.preventDefault();\n                    const url = new URL(link.href);\n                    let page = 1; // Default to page 1\n\n                    // Attempt to get 'paged' from query parameters first (if any)\n                    if (url.searchParams.has('paged')) {\n                        page = parseInt(url.searchParams.get('paged'), 10) || 1;\n                    } else {\n                        // If 'paged' not in query params, try to extract from path (e.g., /page/2/)\n                        const pathSegments = url.pathname.split('/');\n                        const pageIndex = pathSegments.indexOf('page');\n                        if (pageIndex > -1 && pageIndex + 1 < pathSegments.length) {\n                            const pageNum = parseInt(pathSegments[pageIndex + 1], 10);\n                            if (!isNaN(pageNum) && pageNum > 0) {\n                                page = pageNum;\n                            }\n                        }\n                    }\n\n                    fetchAndDisplaySearchResults(page); // Pass the extracted page number\n                });\n            });\n        };\n\n        // Check for initial results count on page load\n        const extractInitialResultsCount = () => {\n            if (!resultsContainer) return;\n            \n            let resultsCount = null;\n\n            // Try the same methods as in fetchAndDisplaySearchResults\n            const resultsWrapper = resultsContainer.querySelector('[data-results-count]');\n            if (resultsWrapper) {\n                resultsCount = parseInt(resultsWrapper.getAttribute('data-results-count'), 10);\n            }\n\n            if (resultsCount === null) {\n                const countInput = resultsContainer.querySelector('input[name=\"results_count\"]');\n                if (countInput) {\n                    resultsCount = parseInt(countInput.value, 10);\n                }\n            }\n\n            if (resultsCount === null) {\n                const countElement = resultsContainer.querySelector('.wp-query-results-count');\n                if (countElement) {\n                    resultsCount = parseInt(countElement.textContent, 10);\n                }\n            }\n\n            if (resultsCount !== null) {\n                updateResultsCount(resultsCount);\n            }\n        };\n\n        // Initialize on page load\n        const urlParams = new URLSearchParams(window.location.search);\n        const hasActiveFilters = urlParams.has('s') ||\n            urlParams.has('orderby') ||\n            urlParams.has('post_type') ||\n            urlParams.has('language') ||\n            urlParams.getAll(blockTaxonomySlug).length ||\n            (authorsModal && urlParams.getAll('author_slug').length);\n\n        if (hasActiveFilters) {\n            fetchAndDisplaySearchResults();\n        }\n\n        // Update search title on initial page load (only if heading is enabled)\n        if (showHeading) {\n            const initialSearchTerm = searchInput ? searchInput.value : '';\n            updateSearchTitle(initialSearchTerm);\n        }\n\n        // Call this on initial page load if there are existing results\n        if (resultsContainer && resultsContainer.children.length > 0) {\n            extractInitialResultsCount();\n        }\n\n        // Form submission handler - only prevent default for full results blocks\n        form.addEventListener('submit', (e) => {\n            e.preventDefault();\n            fetchAndDisplaySearchResults();\n        });\n\n        // Event listeners for filter changes\n        if (sortByDateSelect) sortByDateSelect.addEventListener('change', () => fetchAndDisplaySearchResults());\n        if (postTypeSelect) postTypeSelect.addEventListener('change', () => fetchAndDisplaySearchResults());\n        if (languageSelect) languageSelect.addEventListener('change', () => fetchAndDisplaySearchResults());\n\n        // --- Topics Modal Logic ---\n        if (openTopicsModalButton && topicsModal) {\n            let previouslyFocusedElement;\n\n            // Helper to get all tabbable elements within the modal\n            const getTopicsTabbableElements = () => {\n                return Array.from(topicsModal.querySelectorAll(\n                    'a[href]:not([disabled]), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"]):not([disabled])'\n                )).filter(el => el.offsetWidth > 0 || el.offsetHeight > 0);\n            };\n\n            const trapTopicsFocus = (e) => {\n                const tabbableElements = getTopicsTabbableElements();\n                if (tabbableElements.length === 0) return;\n\n                const firstTabbableElement = tabbableElements[0];\n                const lastTabbableElement = tabbableElements[tabbableElements.length - 1];\n\n                if (e.key === 'Tab') {\n                    if (e.shiftKey) {\n                        if (document.activeElement === firstTabbableElement) {\n                            lastTabbableElement.focus();\n                            e.preventDefault();\n                        }\n                    } else {\n                        if (document.activeElement === lastTabbableElement) {\n                            firstTabbableElement.focus();\n                            e.preventDefault();\n                        }\n                    }\n                } else if (e.key === 'Escape') {\n                    closeTopicsModal();\n                }\n            };\n\n            const openTopicsModal = () => {\n                previouslyFocusedElement = document.activeElement;\n                topicsModal.style.display = 'flex';\n                openTopicsModalButton.setAttribute('aria-expanded', 'true');\n                topicsModal.removeAttribute('aria-hidden');\n\n                const tabbableElements = getTopicsTabbableElements();\n                if (tabbableElements.length > 0) {\n                    tabbableElements[0].focus();\n                }\n\n                document.addEventListener('keydown', trapTopicsFocus);\n            };\n\n            const closeTopicsModal = () => {\n                topicsModal.style.display = 'none';\n                openTopicsModalButton.setAttribute('aria-expanded', 'false');\n                topicsModal.setAttribute('aria-hidden', 'true');\n\n                document.removeEventListener('keydown', trapTopicsFocus);\n                if (previouslyFocusedElement) {\n                    previouslyFocusedElement.focus();\n                }\n            };\n\n            openTopicsModalButton.addEventListener('click', openTopicsModal);\n\n            if (topicsModalCloseButton) {\n                topicsModalCloseButton.addEventListener('click', closeTopicsModal);\n            }\n\n            if (applyTopicsFilterButton) {\n                applyTopicsFilterButton.addEventListener('click', () => {\n                    fetchAndDisplaySearchResults();\n                    closeTopicsModal();\n                });\n            } else {\n                topicsModal.querySelectorAll('input[type=\"checkbox\"]').forEach(checkbox => {\n                    checkbox.addEventListener('change', () => {\n                        fetchAndDisplaySearchResults();\n                    });\n                });\n            }\n\n            window.addEventListener('click', (event) => {\n                if (event.target === topicsModal) {\n                    closeTopicsModal();\n                }\n            });\n\n            const topicSearchInput = topicsModal.querySelector('.topics-modal-search-input');\n            if (topicSearchInput) {\n                topicSearchInput.addEventListener('input', (e) => {\n                    const searchTerm = e.target.value.toLowerCase();\n                    topicsModal.querySelectorAll('.topic-checkbox-item').forEach(item => {\n                        const label = item.textContent.toLowerCase();\n                        item.style.display = label.includes(searchTerm) ? '' : 'none';\n                    });\n                });\n            }\n        }\n\n        // --- Authors Modal Logic ---\n        if (openAuthorsModalButton && authorsModal) {\n            let previouslyFocusedElementAuthors;\n\n            const getAuthorsTabbableElements = () => {\n                return Array.from(authorsModal.querySelectorAll(\n                    'a[href]:not([disabled]), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex=\"-1\"]):not([disabled])'\n                )).filter(el => el.offsetWidth > 0 || el.offsetHeight > 0);\n            };\n\n            const trapAuthorsFocus = (e) => {\n                const tabbableElements = getAuthorsTabbableElements();\n                if (tabbableElements.length === 0) return;\n\n                const firstTabbableElement = tabbableElements[0];\n                const lastTabbableElement = tabbableElements[tabbableElements.length - 1];\n\n                if (e.key === 'Tab') {\n                    if (e.shiftKey) {\n                        if (document.activeElement === firstTabbableElement) {\n                            lastTabbableElement.focus();\n                            e.preventDefault();\n                        }\n                    } else {\n                        if (document.activeElement === lastTabbableElement) {\n                            firstTabbableElement.focus();\n                            e.preventDefault();\n                        }\n                    }\n                } else if (e.key === 'Escape') {\n                    closeAuthorsModal();\n                }\n            };\n\n            const openAuthorsModal = () => {\n                previouslyFocusedElementAuthors = document.activeElement;\n                authorsModal.style.display = 'flex';\n                openAuthorsModalButton.setAttribute('aria-expanded', 'true');\n                authorsModal.removeAttribute('aria-hidden');\n\n                const tabbableElements = getAuthorsTabbableElements();\n                if (tabbableElements.length > 0) {\n                    tabbableElements[0].focus();\n                }\n\n                document.addEventListener('keydown', trapAuthorsFocus);\n            };\n\n            const closeAuthorsModal = () => {\n                authorsModal.style.display = 'none';\n                openAuthorsModalButton.setAttribute('aria-expanded', 'false');\n                authorsModal.setAttribute('aria-hidden', 'true');\n\n                document.removeEventListener('keydown', trapAuthorsFocus);\n                if (previouslyFocusedElementAuthors) {\n                    previouslyFocusedElementAuthors.focus();\n                }\n            };\n\n            openAuthorsModalButton.addEventListener('click', openAuthorsModal);\n\n            if (authorsModalCloseButton) {\n                authorsModalCloseButton.addEventListener('click', closeAuthorsModal);\n            }\n\n            if (applyAuthorsFilterButton) {\n                applyAuthorsFilterButton.addEventListener('click', () => {\n                    fetchAndDisplaySearchResults();\n                    closeAuthorsModal();\n                });\n            } else {\n                authorsModal.querySelectorAll('input[type=\"checkbox\"]').forEach(checkbox => {\n                    checkbox.addEventListener('change', () => {\n                        fetchAndDisplaySearchResults();\n                    });\n                });\n            }\n\n            window.addEventListener('click', (event) => {\n                if (event.target === authorsModal) {\n                    closeAuthorsModal();\n                }\n            });\n\n            const authorSearchInput = authorsModal.querySelector('.authors-modal-search-input');\n            if (authorSearchInput) {\n                authorSearchInput.addEventListener('input', (e) => {\n                    const searchTerm = e.target.value.toLowerCase();\n                    authorsModal.querySelectorAll('.author-checkbox-item').forEach(item => {\n                        const label = item.textContent.toLowerCase();\n                        item.style.display = label.includes(searchTerm) ? '' : 'none';\n                    });\n                });\n            }\n        }\n\n        attachPaginationListeners();\n    });\n});"],"names":["document","addEventListener","searchFilterBlocks","querySelectorAll","forEach","block","form","querySelector","resultsPageUrl","dataset","isSearchOnlyBlock","showHeading","searchInput","sortByDateSelect","postTypeSelect","languageSelect","resultsContainer","blockTaxonomySlug","taxonomySlug","blockAllowedPostTypes","allowedPostTypes","JSON","parse","showLanguageFilter","openTopicsModalButton","topicsModal","topicsModalCloseButton","applyTopicsFilterButton","openAuthorsModalButton","authorsModal","authorsModalCloseButton","applyAuthorsFilterButton","e","initialSearchTerm","value","updateSearchTitle","label","classList","add","searchTerm","titleElement","createElement","className","parentNode","insertBefore","customHeading","getAttribute","baseHeading","textContent","style","display","updateResultsHeading","existingHeading","remove","trim","resultsHeading","selectedContainer","children","length","nextSibling","prepend","updateResultsCount","count","countElement","undefined","fetchAndDisplaySearchResults","page","innerHTML","formData","FormData","append","window","caesHubAjax","nonce","stringify","selectedOrder","checkedTopicSlugs","Array","from","map","cb","filter","slug","checkedAuthorSlugs","fetchStartTime","Date","now","minimumDisplayTime","fetch","ajaxurl","method","body","then","response","ok","Error","status","text","html","fetchEndTime","elapsedTime","remainingTime","Math","max","setTimeout","scrollIntoView","resultsCount","resultsWrapper","parseInt","countInput","paginationInfo","match","resultItems","attachPaginationListeners","catch","error","console","updateURL","renderSelectedFilters","params","URLSearchParams","key","entries","includes","endsWith","paramName","slice","set","newUrl","location","pathname","toString","history","pushState","path","topicSlugs","authorSlugs","hasTopicFilters","hasAuthorFilters","filtersLabel","appendChild","filtersWrapper","checkbox","parentElement","pill","textSpan","removeBtn","setAttribute","checked","clearAllBtn","link","preventDefault","url","URL","href","searchParams","has","get","pathSegments","split","pageIndex","indexOf","pageNum","isNaN","extractInitialResultsCount","urlParams","search","hasActiveFilters","getAll","previouslyFocusedElement","getTopicsTabbableElements","el","offsetWidth","offsetHeight","trapTopicsFocus","tabbableElements","firstTabbableElement","lastTabbableElement","shiftKey","activeElement","focus","closeTopicsModal","openTopicsModal","removeAttribute","removeEventListener","event","target","topicSearchInput","toLowerCase","item","previouslyFocusedElementAuthors","getAuthorsTabbableElements","trapAuthorsFocus","closeAuthorsModal","openAuthorsModal","authorSearchInput"],"sourceRoot":""}