{"version":3,"file":"blocks/toc/view.js","mappings":"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","sources":["webpack://caes-hub-blocks/./src/blocks/toc/view.js"],"sourcesContent":["window.addEventListener('load', function () {\n\t\n\t/** ADDING IDs TO HEADINGS */\n\t// Function to generate a slug from a string\n\tfunction slugify(text) {\n\t\treturn text\n\t\t\t.toString()\n\t\t\t.trim()\n\t\t\t.toLowerCase()\n\t\t\t.replace(/\\s+/g, '-')       // Replace spaces with dashes\n\t\t\t.replace(/[^\\w\\-]+/g, '')   // Remove all non-word characters\n\t\t\t.replace(/\\-\\-+/g, '-')     // Replace multiple dashes with a single dash\n\t\t\t.replace(/^-+/, '')         // Trim dashes from the start\n\t\t\t.replace(/-+$/, '');        // Trim dashes from the end\n\t}\n\n\t// Function to ensure unique IDs\n\tfunction ensureUniqueId(id, existingIds) {\n\t\tlet uniqueId = id;\n\t\tlet counter = 0;\n\n\t\twhile (existingIds.has(uniqueId)) {\n\t\t\tcounter++;\n\t\t\tuniqueId = `${id}-${counter}`;\n\t\t}\n\n\t\texistingIds.add(uniqueId);\n\t\treturn uniqueId;\n\t}\n\n\t// Grab the headings and add IDs\n\tconst allHeadings = document.querySelectorAll('.caes-hub-content-post h2, .caes-hub-content-post h3, .caes-hub-content-post h4, .caes-hub-content-post h5, .caes-hub-content-post h6');\n\tconst headings = Array.from(allHeadings).filter(heading => {\n\t\treturn !(heading.tagName === 'H2' && heading.closest('.wp-block-caes-hub-toc'));\n\t});\n\n\tconst existingIds = new Set();\n\n\theadings.forEach(heading => {\n\t\tlet id = heading.id;\n\n\t\tif (!id) {\n\t\t\tconst text = heading.textContent || 'heading';\n\t\t\tid = slugify(text);\n\t\t\theading.id = id;\n\t\t}\n\n\t\theading.id = ensureUniqueId(id, existingIds);\n\t});\n\t/** END ADDING IDs TO HEADINGS */\n\n\t/** ADDING A STICKY TOC WHEN USER SCROLLS PASSED THE ORIGINAL TOC  */\n\tconst originalToc = document.querySelector('.wp-block-caes-hub-toc');\n\tif (!originalToc) return;\n\n\tconst stickyToc = originalToc.cloneNode(true);\n\tstickyToc.classList.add('sticky-toc');\n\n\t// Insert sticky TOC right after the original TOC\n\toriginalToc.insertAdjacentElement('afterend', stickyToc);\n\n\t// Only apply on desktop\n\tfunction isDesktop() {\n\t\treturn window.innerWidth > 768; // Adjust breakpoint as needed\n\t}\n\n\tlet isStickyVisible = false;\n\n\tlet isStickyHidden = false; // New flag to track if TOC is hidden at the bottom of the content\n\n\tfunction handleScroll() {\n\t\tconst tocRect = originalToc.getBoundingClientRect();\n\t\tconst mainElement = document.querySelector('main');\n\t\tconst mainRect = mainElement.getBoundingClientRect();\n\t\tconst contentElement = document.querySelector('.caes-hub-content');\n\t\tconst contentRect = contentElement.getBoundingClientRect();\n\t\tconst stickyTocRect = stickyToc.getBoundingClientRect();\n\n\t\t// Show sticky TOC when original TOC scrolls out of view and not hidden by content bottom\n\t\tif (isDesktop() && tocRect.bottom < 0 && !isStickyVisible && !isStickyHidden) {\n\t\t\tstickyToc.style.position = 'fixed';\n\t\t\tstickyToc.style.left = `${mainRect.left}px`;\n\t\t\tstickyToc.style.top = 'var(--wp--style--block-gap)'; // Adjust top offset as needed\n\t\t\tstickyToc.style.transform = 'translateX(0)';\n\t\t\tstickyToc.style.transition = 'transform 0.3s ease-in-out';\n\t\t\tisStickyVisible = true;\n\t\t}\n\t\t// Hide sticky TOC when the original TOC is visible\n\t\telse if (isStickyVisible && tocRect.bottom >= 0) {\n\t\t\tstickyToc.style.transform = 'translateX(-200%)'; // Move fully out of view\n\t\t\tisStickyVisible = false;\n\t\t\tisStickyHidden = false; // Reset hidden state when original TOC is back\n\t\t}\n\t\t// Hide sticky TOC when it reaches the bottom of the content\n\t\telse if (isStickyVisible && stickyTocRect.bottom >= contentRect.bottom) {\n\t\t\tstickyToc.style.transform = 'translateX(-200%)'; // Slide out\n\t\t\tisStickyVisible = false;\n\t\t\tisStickyHidden = true; // Mark as hidden due to reaching content bottom\n\t\t}\n\t\t// Handle scrolling back up: Show sticky TOC if original TOC is out of view and not hidden\n\t\telse if (isStickyHidden && tocRect.bottom < 0 && stickyTocRect.bottom < contentRect.bottom) {\n\t\t\tstickyToc.style.transform = 'translateX(0)'; // Bring back into view\n\t\t\tisStickyVisible = true;\n\t\t\tisStickyHidden = false; // Reset hidden state\n\t\t}\n\t}\n\n\n\tfunction handleResize() {\n\t\tif (!isDesktop()) {\n\t\t\tstickyToc.style.display = 'none';\n\t\t} else {\n\t\t\tstickyToc.style.display = 'block';\n\t\t}\n\t}\n\n\twindow.addEventListener('scroll', handleScroll);\n\twindow.addEventListener('resize', handleResize);\n\n\t// Initialize visibility on load\n\thandleResize();\n\thandleScroll();\n\t/** END ADDING A STICKY TOC WHEN USER SCROLLS PASSED THE ORIGINAL TOC  */\n\n\t/** ADDING SMOOTH SCROLL */\n\tconst tocLinks = document.querySelectorAll('a[data-smooth-scroll=\"true\"]');\n\ttocLinks.forEach(link => {\n\t\tlink.addEventListener('click', function (event) {\n\t\t\tevent.preventDefault();\n\t\t\tconst targetId = this.getAttribute('href').substring(1);\n\t\t\tconst targetElement = document.getElementById(targetId);\n\n\t\t\tif (targetElement) {\n\t\t\t\ttargetElement.scrollIntoView({ behavior: 'smooth' });\n\n\t\t\t\tconst observer = new IntersectionObserver((entries, observer) => {\n\t\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\t\tif (entry.isIntersecting) {\n\t\t\t\t\t\t\ttargetElement.setAttribute('tabindex', '-1');\n\t\t\t\t\t\t\ttargetElement.focus();\n\t\t\t\t\t\t\ttargetElement.addEventListener('blur', () => {\n\t\t\t\t\t\t\t\ttargetElement.removeAttribute('tabindex');\n\t\t\t\t\t\t\t}, { once: true });\n\t\t\t\t\t\t\tobserver.disconnect();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}, { threshold: 1.0 });\n\n\t\t\t\tobserver.observe(targetElement);\n\t\t\t}\n\t\t});\n\t});\n\t/** END ADDING SMOOTH SCROLL */\n\n});"],"names":["window","addEventListener","slugify","text","toString","trim","toLowerCase","replace","ensureUniqueId","id","existingIds","uniqueId","counter","has","add","allHeadings","document","querySelectorAll","headings","Array","from","filter","heading","tagName","closest","Set","forEach","textContent","originalToc","querySelector","stickyToc","cloneNode","classList","insertAdjacentElement","isDesktop","innerWidth","isStickyVisible","isStickyHidden","handleScroll","tocRect","getBoundingClientRect","mainElement","mainRect","contentElement","contentRect","stickyTocRect","bottom","style","position","left","top","transform","transition","handleResize","display","tocLinks","link","event","preventDefault","targetId","getAttribute","substring","targetElement","getElementById","scrollIntoView","behavior","observer","IntersectionObserver","entries","entry","isIntersecting","setAttribute","focus","removeAttribute","once","disconnect","threshold","observe"],"sourceRoot":""}