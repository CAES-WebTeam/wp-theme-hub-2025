{"version":3,"file":"blocks/toc/view.js","mappings":";;;;AAAAA,MAAM,CAACC,gBAAgB,CAAC,MAAM,EAAE,YAAY;EAE3C;EACA;EACA,SAASC,OAAOA,CAACC,IAAI,EAAE;IACtB,OAAOA,IAAI,CACTC,QAAQ,CAAC,CAAC,CACVC,IAAI,CAAC,CAAC,CACNC,WAAW,CAAC,CAAC,CACbC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAO;IAAA,CAC3BA,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC,CAAG;IAAA,CAC3BA,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAK;IAAA,CAC3BA,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAS;IAAA,CAC3BA,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAQ;EAC9B;;EAEA;EACA,SAASC,cAAcA,CAACC,EAAE,EAAEC,WAAW,EAAE;IACxC,IAAIC,QAAQ,GAAGF,EAAE;IACjB,IAAIG,OAAO,GAAG,CAAC;IAEf,OAAOF,WAAW,CAACG,GAAG,CAACF,QAAQ,CAAC,EAAE;MACjCC,OAAO,EAAE;MACTD,QAAQ,GAAG,GAAGF,EAAE,IAAIG,OAAO,EAAE;IAC9B;IAEAF,WAAW,CAACI,GAAG,CAACH,QAAQ,CAAC;IACzB,OAAOA,QAAQ;EAChB;;EAEA;EACA,MAAMI,WAAW,GAAGC,QAAQ,CAACC,gBAAgB,CAAC,uIAAuI,CAAC;EACtL,MAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAI,CAACL,WAAW,CAAC,CAACM,MAAM,CAACC,OAAO,IAAI;IAC1D,OAAO,EAAEA,OAAO,CAACC,OAAO,KAAK,IAAI,IAAID,OAAO,CAACE,OAAO,CAAC,wBAAwB,CAAC,CAAC;EAChF,CAAC,CAAC;EAEF,MAAMd,WAAW,GAAG,IAAIe,GAAG,CAAC,CAAC;EAE7BP,QAAQ,CAACQ,OAAO,CAACJ,OAAO,IAAI;IAC3B,IAAIb,EAAE,GAAGa,OAAO,CAACb,EAAE;IAEnB,IAAI,CAACA,EAAE,EAAE;MACR,MAAMN,IAAI,GAAGmB,OAAO,CAACK,WAAW,IAAI,SAAS;MAC7ClB,EAAE,GAAGP,OAAO,CAACC,IAAI,CAAC;MAClBmB,OAAO,CAACb,EAAE,GAAGA,EAAE;IAChB;IAEAa,OAAO,CAACb,EAAE,GAAGD,cAAc,CAACC,EAAE,EAAEC,WAAW,CAAC;EAC7C,CAAC,CAAC;EACF;;EAEA;EACA,MAAMkB,WAAW,GAAGZ,QAAQ,CAACa,aAAa,CAAC,wBAAwB,CAAC;EACpE,IAAI,CAACD,WAAW,EAAE;;EAElB;EACA,MAAME,SAAS,GAAGF,WAAW,CAACG,SAAS,CAAC,IAAI,CAAC;EAC7CD,SAAS,CAACE,SAAS,CAAClB,GAAG,CAAC,YAAY,CAAC;EACrC;EACAgB,SAAS,CAACG,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC;EAC7C;EACAH,SAAS,CAACG,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;EACxC;EACA,MAAMC,WAAW,GAAGlB,QAAQ,CAACa,aAAa,CAAC,MAAM,CAAC;EAClDK,WAAW,CAACC,WAAW,CAACL,SAAS,CAAC;;EAElC;EACA,SAASM,SAASA,CAAA,EAAG;IACpB,OAAOpC,MAAM,CAACqC,UAAU,GAAG,GAAG,CAAC,CAAC;EACjC;;EAEA;EACA,IAAIC,aAAa,GAAG,KAAK;EACzB,IAAIC,sBAAsB,GAAG,KAAK;;EAElC;EACA,MAAMC,WAAW,GAAGxB,QAAQ,CAACa,aAAa,CAAC,wBAAwB,CAAC;EAEpE,IAAIW,WAAW,EAAE;IAChB,MAAMC,YAAY,GAAG,IAAIC,oBAAoB,CAC3CC,OAAO,IAAK;MACZA,OAAO,CAACjB,OAAO,CAAEkB,KAAK,IAAK;QAC1BN,aAAa,GAAGM,KAAK,CAACC,cAAc;QACpCC,yBAAyB,CAAC,CAAC;MAC5B,CAAC,CAAC;IACH,CAAC,EACD;MAAEC,SAAS,EAAE;IAAE,CAAC,CAAC;IAClB,CAAC;IAEDN,YAAY,CAACO,OAAO,CAACR,WAAW,CAAC;EAClC;;EAEA;EACA,MAAMS,WAAW,GAAG,IAAIP,oBAAoB,CAC1CC,OAAO,IAAK;IACZA,OAAO,CAACjB,OAAO,CAAEkB,KAAK,IAAK;MAC1BL,sBAAsB,GAAG,CAACK,KAAK,CAACC,cAAc;MAC9CC,yBAAyB,CAAC,CAAC;IAC5B,CAAC,CAAC;EACH,CAAC,EACD;IAAEC,SAAS,EAAE;EAAE,CAAC,CAAC;EAClB,CAAC;EAEDE,WAAW,CAACD,OAAO,CAACpB,WAAW,CAAC;;EAEhC;EACA,SAASkB,yBAAyBA,CAAA,EAAG;IACpC,IAAI,CAACV,SAAS,CAAC,CAAC,EAAE;MACjBN,SAAS,CAACoB,KAAK,CAACC,OAAO,GAAG,MAAM;MAChC;IACD;IAEA,IAAIb,aAAa,IAAIC,sBAAsB,EAAE;MAC5C;MACA,MAAMa,QAAQ,GAAGlB,WAAW,CAACmB,qBAAqB,CAAC,CAAC;MACpDvB,SAAS,CAACoB,KAAK,CAACC,OAAO,GAAG,OAAO;MACjCrB,SAAS,CAACoB,KAAK,CAACI,QAAQ,GAAG,OAAO;MAClCxB,SAAS,CAACoB,KAAK,CAACK,IAAI,GAAG,GAAGH,QAAQ,CAACG,IAAI,IAAI;MAC3CzB,SAAS,CAACoB,KAAK,CAACM,GAAG,GAAG,6BAA6B,CAAC,CAAC;MACrD1B,SAAS,CAACoB,KAAK,CAACO,SAAS,GAAG,eAAe;MAC3C3B,SAAS,CAACoB,KAAK,CAACQ,UAAU,GAAG,4BAA4B;IAC1D,CAAC,MAAM;MACN;MACA5B,SAAS,CAACoB,KAAK,CAACO,SAAS,GAAG,mBAAmB;IAChD;EACD;;EAEA;EACA,SAASE,YAAYA,CAAA,EAAG;IACvB,MAAMzB,WAAW,GAAGlB,QAAQ,CAACa,aAAa,CAAC,MAAM,CAAC;IAClD,IAAI,CAACK,WAAW,EAAE;IAElB,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE;MACjBN,SAAS,CAACoB,KAAK,CAACC,OAAO,GAAG,MAAM;IACjC,CAAC,MAAM;MACN,MAAMC,QAAQ,GAAGlB,WAAW,CAACmB,qBAAqB,CAAC,CAAC;MACpDvB,SAAS,CAACoB,KAAK,CAACK,IAAI,GAAG,GAAGH,QAAQ,CAACG,IAAI,IAAI;MAC3CT,yBAAyB,CAAC,CAAC;IAC5B;EACD;EACA9C,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAE0D,YAAY,CAAC;;EAE/C;EACAA,YAAY,CAAC,CAAC;EACd;;EAGA;EACA,MAAMC,QAAQ,GAAG5C,QAAQ,CAACC,gBAAgB,CAAC,8BAA8B,CAAC;EAC1E2C,QAAQ,CAAClC,OAAO,CAACmC,IAAI,IAAI;IACxBA,IAAI,CAAC5D,gBAAgB,CAAC,OAAO,EAAE,UAAU6D,KAAK,EAAE;MAC/CA,KAAK,CAACC,cAAc,CAAC,CAAC;MACtB,MAAMC,QAAQ,GAAG,IAAI,CAACC,YAAY,CAAC,MAAM,CAAC,CAACC,SAAS,CAAC,CAAC,CAAC;MACvD,MAAMC,aAAa,GAAGnD,QAAQ,CAACoD,cAAc,CAACJ,QAAQ,CAAC;MAEvD,IAAIG,aAAa,EAAE;QAClBA,aAAa,CAACE,cAAc,CAAC;UAAEC,QAAQ,EAAE;QAAS,CAAC,CAAC;QAEpD,MAAMC,QAAQ,GAAG,IAAI7B,oBAAoB,CAAC,CAACC,OAAO,EAAE4B,QAAQ,KAAK;UAChE5B,OAAO,CAACjB,OAAO,CAACkB,KAAK,IAAI;YACxB,IAAIA,KAAK,CAACC,cAAc,EAAE;cACzBsB,aAAa,CAAClC,YAAY,CAAC,UAAU,EAAE,IAAI,CAAC;cAC5CkC,aAAa,CAACK,KAAK,CAAC,CAAC;cACrBL,aAAa,CAAClE,gBAAgB,CAAC,MAAM,EAAE,MAAM;gBAC5CkE,aAAa,CAACM,eAAe,CAAC,UAAU,CAAC;cAC1C,CAAC,EAAE;gBAAEC,IAAI,EAAE;cAAK,CAAC,CAAC;cAClBH,QAAQ,CAACI,UAAU,CAAC,CAAC;YACtB;UACD,CAAC,CAAC;QACH,CAAC,EAAE;UAAE5B,SAAS,EAAE;QAAI,CAAC,CAAC;QAEtBwB,QAAQ,CAACvB,OAAO,CAACmB,aAAa,CAAC;MAChC;IACD,CAAC,CAAC;EACH,CAAC,CAAC;EACF;AAED,CAAC,CAAC,C","sources":["webpack://caes-hub-blocks/./src/blocks/toc/view.js"],"sourcesContent":["window.addEventListener('load', function () {\n\n\t/** ADDING IDs TO HEADINGS */\n\t// Function to generate a slug from a string\n\tfunction slugify(text) {\n\t\treturn text\n\t\t\t.toString()\n\t\t\t.trim()\n\t\t\t.toLowerCase()\n\t\t\t.replace(/\\s+/g, '-')       // Replace spaces with dashes\n\t\t\t.replace(/[^\\w\\-]+/g, '')   // Remove all non-word characters\n\t\t\t.replace(/\\-\\-+/g, '-')     // Replace multiple dashes with a single dash\n\t\t\t.replace(/^-+/, '')         // Trim dashes from the start\n\t\t\t.replace(/-+$/, '');        // Trim dashes from the end\n\t}\n\n\t// Function to ensure unique IDs\n\tfunction ensureUniqueId(id, existingIds) {\n\t\tlet uniqueId = id;\n\t\tlet counter = 0;\n\n\t\twhile (existingIds.has(uniqueId)) {\n\t\t\tcounter++;\n\t\t\tuniqueId = `${id}-${counter}`;\n\t\t}\n\n\t\texistingIds.add(uniqueId);\n\t\treturn uniqueId;\n\t}\n\n\t// Grab the headings and add IDs\n\tconst allHeadings = document.querySelectorAll('.caes-hub-content-post h2, .caes-hub-content-post h3, .caes-hub-content-post h4, .caes-hub-content-post h5, .caes-hub-content-post h6');\n\tconst headings = Array.from(allHeadings).filter(heading => {\n\t\treturn !(heading.tagName === 'H2' && heading.closest('.wp-block-caes-hub-toc'));\n\t});\n\n\tconst existingIds = new Set();\n\n\theadings.forEach(heading => {\n\t\tlet id = heading.id;\n\n\t\tif (!id) {\n\t\t\tconst text = heading.textContent || 'heading';\n\t\t\tid = slugify(text);\n\t\t\theading.id = id;\n\t\t}\n\n\t\theading.id = ensureUniqueId(id, existingIds);\n\t});\n\t/** END ADDING IDs TO HEADINGS */\n\n\t/** ADDING A STICKY TOC WHEN USER SCROLLS PASSED THE ORIGINAL TOC  */\n\tconst originalToc = document.querySelector('.wp-block-caes-hub-toc');\n\tif (!originalToc) return;\n\n\t// Clone the original TOC to create a sticky version\n\tconst stickyToc = originalToc.cloneNode(true);\n\tstickyToc.classList.add('sticky-toc');\n\t// Add aria-hidden attribute to the sticky TOC\n\tstickyToc.setAttribute('aria-hidden', 'true');\n\t// Set tabindex to -1 to prevent focus\n\tstickyToc.setAttribute('tabindex', '-1');\n\t// Add sticky TOC to the main element\n\tconst mainElement = document.querySelector('main');\n\tmainElement.appendChild(stickyToc);\n\n\t// Only apply on desktop\n\tfunction isDesktop() {\n\t\treturn window.innerWidth > 768; // Adjust breakpoint as needed\n\t}\n\n\t// Flags to track intersection states\n\tlet isPostVisible = false;\n\tlet isOriginalTocOutOfView = false;\n\n\t// Observer for detecting when .caes-hub-content-post enters or exits the viewport\n\tconst postElement = document.querySelector('.caes-hub-content-post');\n\n\tif (postElement) {\n\t\tconst postObserver = new IntersectionObserver(\n\t\t\t(entries) => {\n\t\t\t\tentries.forEach((entry) => {\n\t\t\t\t\tisPostVisible = entry.isIntersecting;\n\t\t\t\t\tupdateStickyTocVisibility();\n\t\t\t\t});\n\t\t\t},\n\t\t\t{ threshold: 0 } // Trigger when any part of the post enters/exits the viewport\n\t\t);\n\n\t\tpostObserver.observe(postElement);\n\t}\n\n\t// Observer for detecting when the original TOC leaves the viewport\n\tconst tocObserver = new IntersectionObserver(\n\t\t(entries) => {\n\t\t\tentries.forEach((entry) => {\n\t\t\t\tisOriginalTocOutOfView = !entry.isIntersecting;\n\t\t\t\tupdateStickyTocVisibility();\n\t\t\t});\n\t\t},\n\t\t{ threshold: 0 } // Trigger when any part of the TOC enters/exits the viewport\n\t);\n\n\ttocObserver.observe(originalToc);\n\n\t// Function to update sticky TOC visibility\n\tfunction updateStickyTocVisibility() {\n\t\tif (!isDesktop()) {\n\t\t\tstickyToc.style.display = 'none';\n\t\t\treturn;\n\t\t}\n\n\t\tif (isPostVisible && isOriginalTocOutOfView) {\n\t\t\t// Show sticky TOC\n\t\t\tconst mainRect = mainElement.getBoundingClientRect();\n\t\t\tstickyToc.style.display = 'block';\n\t\t\tstickyToc.style.position = 'fixed';\n\t\t\tstickyToc.style.left = `${mainRect.left}px`;\n\t\t\tstickyToc.style.top = 'var(--wp--style--block-gap)'; // Adjust top offset\n\t\t\tstickyToc.style.transform = 'translateX(0)';\n\t\t\tstickyToc.style.transition = 'transform 0.3s ease-in-out';\n\t\t} else {\n\t\t\t// Hide sticky TOC\n\t\t\tstickyToc.style.transform = 'translateX(-200%)';\n\t\t}\n\t}\n\n\t// Handle resize to toggle sticky TOC visibility and update position dynamically\n\tfunction handleResize() {\n\t\tconst mainElement = document.querySelector('main');\n\t\tif (!mainElement) return;\n\n\t\tif (!isDesktop()) {\n\t\t\tstickyToc.style.display = 'none';\n\t\t} else {\n\t\t\tconst mainRect = mainElement.getBoundingClientRect();\n\t\t\tstickyToc.style.left = `${mainRect.left}px`;\n\t\t\tupdateStickyTocVisibility();\n\t\t}\n\t}\n\twindow.addEventListener('resize', handleResize);\n\n\t// Initialize visibility on load\n\thandleResize();\n\t/** END ADDING A STICKY TOC WHEN USER SCROLLS PASSED THE ORIGINAL TOC  */\n\n\n\t/** ADDING SMOOTH SCROLL */\n\tconst tocLinks = document.querySelectorAll('a[data-smooth-scroll=\"true\"]');\n\ttocLinks.forEach(link => {\n\t\tlink.addEventListener('click', function (event) {\n\t\t\tevent.preventDefault();\n\t\t\tconst targetId = this.getAttribute('href').substring(1);\n\t\t\tconst targetElement = document.getElementById(targetId);\n\n\t\t\tif (targetElement) {\n\t\t\t\ttargetElement.scrollIntoView({ behavior: 'smooth' });\n\n\t\t\t\tconst observer = new IntersectionObserver((entries, observer) => {\n\t\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\t\tif (entry.isIntersecting) {\n\t\t\t\t\t\t\ttargetElement.setAttribute('tabindex', '-1');\n\t\t\t\t\t\t\ttargetElement.focus();\n\t\t\t\t\t\t\ttargetElement.addEventListener('blur', () => {\n\t\t\t\t\t\t\t\ttargetElement.removeAttribute('tabindex');\n\t\t\t\t\t\t\t}, { once: true });\n\t\t\t\t\t\t\tobserver.disconnect();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}, { threshold: 1.0 });\n\n\t\t\t\tobserver.observe(targetElement);\n\t\t\t}\n\t\t});\n\t});\n\t/** END ADDING SMOOTH SCROLL */\n\n});"],"names":["window","addEventListener","slugify","text","toString","trim","toLowerCase","replace","ensureUniqueId","id","existingIds","uniqueId","counter","has","add","allHeadings","document","querySelectorAll","headings","Array","from","filter","heading","tagName","closest","Set","forEach","textContent","originalToc","querySelector","stickyToc","cloneNode","classList","setAttribute","mainElement","appendChild","isDesktop","innerWidth","isPostVisible","isOriginalTocOutOfView","postElement","postObserver","IntersectionObserver","entries","entry","isIntersecting","updateStickyTocVisibility","threshold","observe","tocObserver","style","display","mainRect","getBoundingClientRect","position","left","top","transform","transition","handleResize","tocLinks","link","event","preventDefault","targetId","getAttribute","substring","targetElement","getElementById","scrollIntoView","behavior","observer","focus","removeAttribute","once","disconnect"],"sourceRoot":""}