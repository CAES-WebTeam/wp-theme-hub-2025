/**
 * Frontend styles for Reveal Block - Sticky Approach v4
 *
 * Fixed:
 * - Content doesn't peek early (full 100vh padding-top)
 * - Section height adapts to content height
 */

.caes-reveal {
	position: relative;
	// min-height will be set by JS
	
	&.is-fixed {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		width: 100%;
		height: 100vh;
		z-index: 100;
	}
}

// Each frame section - just containers, height not important
.reveal-frame-section {
	position: absolute;
	top: 0;
	width: 100%;
	pointer-events: none;
}

// The background wrapper - fixed so all frames can occupy the same space
.reveal-frame-background {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 100vh;
    width: 100%;
    overflow: hidden;
    // z-index will be managed dynamically by JavaScript
    
    /* Hardware acceleration for smoother animations */
    will-change: transform, opacity;
    
    /* Start hidden - JS will control visibility */
    opacity: 0;
}

// Individual frame (image container)
.reveal-frame {
	position: absolute;
	inset: 0;
	margin: 0;

	img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		object-position: var(--desktop-focal-x, 50%) var(--desktop-focal-y, 50%);
	}

	.reveal-frame-desktop {
		display: block;
		object-position: var(--desktop-focal-x, 50%) var(--desktop-focal-y, 50%);
	}

	.reveal-frame-mobile {
		display: none;
		object-position: var(--mobile-focal-x, 50%) var(--mobile-focal-y, 50%);
	}

	.reveal-overlay {
		position: absolute;
		inset: 0;
		pointer-events: none;
		z-index: 2;
	}

	.reveal-frame-caption {
		position: absolute;
		bottom: 0;
		left: 0;
		right: 0;
		padding: 1rem 1.5rem;
		background: rgba(0, 0, 0, 0.5);
		color: var(--wp--preset--color--base, #fff);
		line-height: 1.4;
		z-index: 3;

		.reveal-caption-wrap {
			max-width: var(--wp--style--global--wide-size, 1200px);
			margin: 0 auto;
		}

		.reveal-caption-desktop {
			display: block;
		}

		.reveal-caption-mobile {
			display: none;
		}
	}

	@media screen and (max-width: 768px) {
		img {
			object-position: var(--mobile-focal-x, 50%) var(--mobile-focal-y, 50%);
		}

		.reveal-frame-desktop {
			display: none;
		}

		.reveal-frame-mobile {
			display: block;
		}

		.reveal-frame-caption {
			.reveal-caption-desktop {
				display: none;
			}

			.reveal-caption-mobile {
				display: block;
			}
		}
	}
}

// Content that gets transformed to scroll through viewport
.reveal-frame-content {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	min-height: 100vh;
	z-index: 150; // Above backgrounds
	
	// Padding on sides
	padding-left: 2rem;
	padding-right: 2rem;
	padding-top: 0;
	padding-bottom: 2rem;
	
	pointer-events: auto;
	
	// Will be transformed by JS
	transform: translateY(100vh);
	opacity: 0;
	
	> * {
		position: relative;
		z-index: 1;
	}
}

// Accessibility
.caes-reveal {
	a:focus,
	button:focus {
		outline: 2px solid currentColor;
		outline-offset: 2px;
	}
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {
	.reveal-frame-content {
		opacity: 1 !important;
	}
}

// Print styles
@media print {
	.caes-reveal {
		position: relative !important;
		min-height: auto !important;
		
		.reveal-frame-section {
			position: relative !important;
			min-height: auto !important;
			page-break-inside: avoid;
		}
		
		.reveal-frame-background {
			position: relative !important;
			height: auto !important;
			min-height: 300px;
			opacity: 1 !important;
		}

		.reveal-frame-content {
			position: relative !important;
			transform: none !important;
			opacity: 1 !important;
			margin-top: 0;
			padding-top: 2rem;
		}

		.reveal-overlay {
			display: none;
		}
	}
}