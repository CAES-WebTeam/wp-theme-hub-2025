/**
 * Frontend styles for Reveal Block
 *
 * Uses clip-path to create a "window" effect where the fixed background
 * is only visible within the block's bounds, creating smooth scroll behavior.
 */

.caes-reveal {
	position: relative;
	min-height: var(--reveal-min-height, 100vh);
	
	// clip-path creates a clipping context that clips fixed children to parent bounds
	clip-path: inset(0);

	// Background container - always fixed, clipped by parent
	.reveal-background {
		position: fixed;
		top: 0;
		left: 0;
		right: 0;
		height: 100vh;
		z-index: 0;
		overflow: hidden;
	}

	// Individual frames
	.reveal-frame {
		position: absolute;
		inset: 0;
		opacity: 0;
		transition-property: opacity, transform;
		transition-timing-function: ease-out;
		transition-duration: var(--transition-speed, 500ms);
		will-change: opacity, transform;

		&.is-active {
			opacity: 1;
		}

		picture {
			display: block;
			width: 100%;
			height: 100%;
		}

		img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			object-position: var(--desktop-focal-x, 50%) var(--desktop-focal-y, 50%);
		}

		// Mobile focal point
		@media screen and (max-width: 768px) {
			img {
				object-position: var(--mobile-focal-x, 50%) var(--mobile-focal-y, 50%);
			}
		}
	}

	// Overlay
	.reveal-overlay {
		position: absolute;
		inset: 0;
		pointer-events: none;
		z-index: 1;
	}

	// Content container
	.reveal-content {
		position: relative;
		z-index: 2;
		min-height: inherit;

		// Ensure content has some padding by default
		> *:first-child {
			margin-top: 0;
		}

		> *:last-child {
			margin-bottom: 0;
		}
	}

	// Reduced motion: instant transitions
	@media (prefers-reduced-motion: reduce) {
		.reveal-frame {
			transition-duration: 0ms !important;
		}
	}

	// Full-width alignment adjustments
	&.alignfull {
		width: 100vw;
		max-width: 100vw;
		margin-left: calc(-50vw + 50%);
		margin-right: calc(-50vw + 50%);

		.reveal-background {
			left: 0;
			right: 0;
			width: 100vw;
		}
	}

	// Wide alignment
	&.alignwide {
		.reveal-background {
			left: 0;
			right: 0;
			width: 100vw;
		}
	}
}

// Transition type variations (applied via JS)
.reveal-frame {
	// Fade (default) - just opacity, handled above

	// Directional transitions - initial states set by JS
	&[data-transition-type="up"],
	&[data-transition-type="down"],
	&[data-transition-type="left"],
	&[data-transition-type="right"] {
		transition-property: opacity, transform;
	}
}

// Accessibility: ensure focus states are visible
.caes-reveal {
	a:focus,
	button:focus {
		outline: 2px solid currentColor;
		outline-offset: 2px;
	}
}

// Print styles - show first frame only, no fixed positioning
@media print {
	.caes-reveal {
		clip-path: none;
		
		.reveal-background {
			position: absolute !important;
			height: 100%;
		}

		.reveal-frame {
			display: none;

			&:first-child {
				display: block;
				opacity: 1 !important;
			}
		}

		.reveal-overlay {
			display: none;
		}
	}
}