/**
 * Frontend styles for Reveal Block - Sticky Approach
 *
 * Each frame is a container with:
 * - A sticky background that pins while content scrolls through
 * - Content that flows naturally and scrolls through the pinned background
 */

.caes-reveal {
	position: relative;

	// The main container doesn't need clip-path anymore
	// Each frame handles its own clipping
}

// Each frame section - contains both background and content
.reveal-frame-section {
	position: relative;
	// Height is set by content naturally, plus extra scroll room
	// This will be calculated: content height + 100vh for scroll-through
}

// The sticky background wrapper
.reveal-frame-background {
	position: sticky;
	top: 0;
	height: 100vh;
	width: 100%;
	overflow: hidden;
	z-index: 0;

	// Clip to viewport bounds
	clip-path: inset(0);
}

// Individual frame images
.reveal-frame {
	position: absolute;
	inset: 0;
	margin: 0;

	img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		object-position: var(--desktop-focal-x, 50%) var(--desktop-focal-y, 50%);
	}

	// Desktop/Mobile image handling
	.reveal-frame-desktop {
		display: block;
		object-position: var(--desktop-focal-x, 50%) var(--desktop-focal-y, 50%);
	}

	.reveal-frame-mobile {
		display: none;
		object-position: var(--mobile-focal-x, 50%) var(--mobile-focal-y, 50%);
	}

	// Overlay
	.reveal-overlay {
		position: absolute;
		inset: 0;
		pointer-events: none;
		z-index: 2;
	}

	// Caption
	.reveal-frame-caption {
		position: absolute;
		bottom: 0;
		left: 0;
		right: 0;
		padding: 1rem 1.5rem;
		background: rgba(0, 0, 0, 0.5);
		color: var(--wp--preset--color--base, #fff);
		line-height: 1.4;
		z-index: 3;

		.reveal-caption-wrap {
			max-width: var(--wp--style--global--wide-size, 1200px);
			margin: 0 auto;
		}

		.reveal-caption-desktop {
			display: block;
		}

		.reveal-caption-mobile {
			display: none;
		}
	}

	// Mobile styles
	@media screen and (max-width: 768px) {
		img {
			object-position: var(--mobile-focal-x, 50%) var(--mobile-focal-y, 50%);
		}

		.reveal-frame-desktop {
			display: none;
		}

		.reveal-frame-mobile {
			display: block;
		}

		.reveal-frame-caption {
			.reveal-caption-desktop {
				display: none;
			}

			.reveal-caption-mobile {
				display: block;
			}
		}
	}
}

// Content that scrolls over the sticky background
.reveal-frame-content {
	position: relative;
	z-index: 1;
	
	// Offset to start below the sticky background
	margin-top: -100vh;
	
	// Padding so content starts at bottom of viewport and has room to scroll
	padding-top: 100vh;  // Push content down so it enters from bottom
	padding-bottom: 20vh; // Some breathing room at bottom
	padding-left: 2rem;
	padding-right: 2rem;
	
	// Content should be visible above background
	pointer-events: auto;
	
	// Inner content wrapper
	> * {
		// Add background/styling to content blocks if needed for readability
	}
}

// Last frame - content scrolls away with background
.reveal-frame-section:last-child {
	.reveal-frame-content {
		padding-bottom: 2rem; // Less padding, scrolls away naturally
	}
}

// Accessibility
.caes-reveal {
	a:focus,
	button:focus {
		outline: 2px solid currentColor;
		outline-offset: 2px;
	}
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {
	.reveal-frame {
		transition: none !important;
	}
}

// Print styles
@media print {
	.caes-reveal {
		.reveal-frame-background {
			position: relative;
			height: auto;
		}

		.reveal-frame-content {
			margin-top: 0;
			padding-top: 2rem;
		}

		.reveal-overlay {
			display: none;
		}
	}
}