/**
 * Frontend styles for Reveal Block - Sticky Approach v3
 *
 * Key insight: The section needs to be tall enough for content to scroll THROUGH
 * the viewport while the background stays pinned.
 * 
 * Section height = 100vh (background) + 100vh (scroll distance for content to travel)
 * Content starts at bottom of viewport, scrolls up and out the top
 */

.caes-reveal {
	position: relative;
}

// Each frame section - must be tall enough for content to scroll through
.reveal-frame-section {
	position: relative;
	// Minimum height: viewport + space for content to scroll through
	// The content will add to this naturally
	min-height: 200vh;
}

// Last section doesn't need extra scroll room - content just scrolls away
.reveal-frame-section:last-child {
	min-height: 100vh;
}

// The sticky background wrapper
.reveal-frame-background {
	position: sticky;
	top: 0;
	height: 100vh;
	width: 100%;
	overflow: hidden;
	z-index: 0;
}

// Individual frame (image container)
.reveal-frame {
	position: absolute;
	inset: 0;
	margin: 0;

	img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		object-position: var(--desktop-focal-x, 50%) var(--desktop-focal-y, 50%);
	}

	.reveal-frame-desktop {
		display: block;
		object-position: var(--desktop-focal-x, 50%) var(--desktop-focal-y, 50%);
	}

	.reveal-frame-mobile {
		display: none;
		object-position: var(--mobile-focal-x, 50%) var(--mobile-focal-y, 50%);
	}

	.reveal-overlay {
		position: absolute;
		inset: 0;
		pointer-events: none;
		z-index: 2;
	}

	.reveal-frame-caption {
		position: absolute;
		bottom: 0;
		left: 0;
		right: 0;
		padding: 1rem 1.5rem;
		background: rgba(0, 0, 0, 0.5);
		color: var(--wp--preset--color--base, #fff);
		line-height: 1.4;
		z-index: 3;

		.reveal-caption-wrap {
			max-width: var(--wp--style--global--wide-size, 1200px);
			margin: 0 auto;
		}

		.reveal-caption-desktop {
			display: block;
		}

		.reveal-caption-mobile {
			display: none;
		}
	}

	@media screen and (max-width: 768px) {
		img {
			object-position: var(--mobile-focal-x, 50%) var(--mobile-focal-y, 50%);
		}

		.reveal-frame-desktop {
			display: none;
		}

		.reveal-frame-mobile {
			display: block;
		}

		.reveal-frame-caption {
			.reveal-caption-desktop {
				display: none;
			}

			.reveal-caption-mobile {
				display: block;
			}
		}
	}
}

// Content that scrolls over the sticky background
.reveal-frame-content {
	position: relative;
	z-index: 1;
	
	// Pull up to overlap the sticky background
	margin-top: -100vh;
	
	// This is the key: padding-top pushes content down so it STARTS at the bottom
	// of the viewport when the section first comes into view
	padding-top: calc(100vh - 100px); // Start near bottom, with a little peek
	
	// Padding on sides for content
	padding-left: 2rem;
	padding-right: 2rem;
	padding-bottom: 2rem;
	
	// Min-height ensures there's enough scroll distance
	min-height: 100vh;
	
	// Content needs to be interactive
	pointer-events: auto;
	
	// Make content readable over background
	> * {
		position: relative;
		z-index: 1;
	}
}

// Accessibility
.caes-reveal {
	a:focus,
	button:focus {
		outline: 2px solid currentColor;
		outline-offset: 2px;
	}
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {
	.reveal-frame-content {
		// Could disable opacity animations here
	}
}

// Print styles
@media print {
	.caes-reveal {
		.reveal-frame-section {
			min-height: auto;
			page-break-inside: avoid;
		}
		
		.reveal-frame-background {
			position: relative;
			height: auto;
			min-height: 300px;
		}

		.reveal-frame-content {
			margin-top: 0;
			padding-top: 2rem;
			min-height: auto;
		}

		.reveal-overlay {
			display: none;
		}
	}
}