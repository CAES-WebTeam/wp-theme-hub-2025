/**
 * Motion Scroll Block Styles (Frontend)
 */

.caes-motion-scroll {
	position: relative;
	display: grid;
	grid-template-columns: 1fr 1fr;
	min-height: 100vh;
	gap: 0;

	// Only break out to full viewport when alignfull
	&.alignfull {
		// Let theme handle the full-width breakout
		// Just ensure grid uses full width properly
		width: calc(100% + var(--wp--preset--spacing--50)*2);
		max-width: none;
	}

	// Content on left, images on right (default)
	&.content-left {
		.motion-scroll-images {
			order: 2;
		}
		.motion-scroll-content {
			order: 1;
		}
	}

	// Content on right, images on left
	&.content-right {
		.motion-scroll-images {
			order: 1;
		}
		.motion-scroll-content {
			order: 2;
		}
	}

	// Images container (sticky)
	.motion-scroll-images {
		position: sticky;
		top: 0;
		height: 100vh;
		overflow: hidden;
		background-color: #000;
	}

	// Individual slide
	.motion-scroll-slide {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		opacity: 0;
		transition: opacity 0.6s ease-in-out;
		will-change: opacity;

		&.is-active {
			opacity: 1;
		}
	}

	// Figure element
	.motion-scroll-figure {
		width: 100%;
		height: 100%;
		margin: 0;
		position: relative;

		img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			object-position: var(--focal-x, 50%) var(--focal-y, 50%);
		}
	}

	// Caption styles
	.motion-scroll-caption {
		margin: 0;
		line-height: 1.4;

		a {
			color: inherit;
			text-decoration: underline;
			text-decoration-color: rgba(255, 255, 255, 0.6);
			transition: text-decoration-color 0.2s ease;

			&:hover,
			&:focus {
				text-decoration-color: currentColor;
			}
		}
	}

	// Image display mode: cover (default - background fill)
	&.image-mode-cover {
		.motion-scroll-slide {
			display: block;
		}

		.motion-scroll-figure {
			width: 100%;
			height: 100%;

			img {
				width: 100%;
				height: 100%;
				object-fit: cover;
				object-position: var(--focal-x, 50%) var(--focal-y, 50%);
			}
		}

		// Caption overlay style (like Reveal block)
		.motion-scroll-caption {
			position: absolute;
			bottom: 0;
			left: 0;
			right: 0;
			padding: 1rem 1.5rem;
			background: rgba(0, 0, 0, 0.6);
			z-index: 2;
		}
	}

	// Image display mode: contain (maintain aspect ratio, centered)
	&.image-mode-contain {
		.motion-scroll-slide {
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 2rem; // Add padding to ensure caption has room
			box-sizing: border-box;
		}

		.motion-scroll-figure {
			width: 100%;
			height: auto;
			max-width: 100%;
			max-height: calc(100vh - 4rem); // Leave room for padding
			display: flex;
			flex-direction: column;
			justify-content: center;
			box-sizing: border-box;
			overflow: hidden; // Prevent caption overflow

			img {
				width: 100%;
				height: auto;
				max-height: calc(100vh - 6rem); // Leave room for caption
				max-width: 100%;
				object-fit: contain;
				object-position: center;
				flex-shrink: 0;
			}
		}

		// Caption below image style
		.motion-scroll-caption {
			display: block;
			padding: 1rem 0 0;
			text-align: center;
			font-size: 0.9em;
			flex-shrink: 0; // Prevent caption from being squeezed
			width: 100%;
			max-width: 100%;
			word-wrap: break-word;
			overflow-wrap: break-word;
			hyphens: auto;
		}
	}

	// Content container (scrollable)
	.motion-scroll-content {
		min-height: 100vh;
		overflow-x: hidden; // Prevent horizontal overflow only

		// Ensure images don't break out
		img {
			max-width: 100%;
			height: auto;
		}

		// Add extra space at bottom to allow last content to trigger last image
		&::after {
			content: '';
			display: block;
			height: 50vh;
		}
	}

	// Mobile layout
	@media (max-width: 768px) {
		grid-template-columns: 1fr;

		.motion-scroll-images {
			display: none;
		}

		&.content-left,
		&.content-right {
			.motion-scroll-content {
				order: 1;
			}
		}

		// Padding is now controlled via block attributes
	}
}
